/**
 * almond 0.0.3 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 *//*jslint strict: false, plusplus: false *//*global setTimeout: false */var requirejs,require,define;(function(a){function g(a,b){if(a&&a.charAt(0)==="."&&b){b=b.split("/"),b=b.slice(0,b.length-1),a=b.concat(a.split("/"));var c,d;for(c=0;d=a[c];c++)if(d===".")a.splice(c,1),c-=1;else if(d===".."){if(c===1&&(a[2]===".."||a[0]===".."))break;c>0&&(a.splice(c-1,2),c-=2)}a=a.join("/")}return a}function h(b,c){return function(){return f.apply(a,d.call(arguments,0).concat([b,c]))}}function i(a){return function(b){return g(b,a)}}function j(a){return function(c){b[a]=c}}function k(d){if(c.hasOwnProperty(d)){var f=c[d];delete c[d],e.apply(a,f)}return b[d]}function l(a,b){var c,d,e=a.indexOf("!");return e!==-1?(c=g(a.slice(0,e),b),a=a.slice(e+1),d=k(c),d&&d.normalize?a=d.normalize(a,i(b)):a=g(a,b)):a=g(a,b),{f:c?c+"!"+a:a,n:a,p:d}}var b={},c={},d=[].slice,e,f;if(typeof define=="function")return;e=function(d,e,f,g){var i=[],m,n,o,p,q,r;g||(g=d);if(typeof f=="function"){!e.length&&f.length&&(e=["require","exports","module"]);for(p=0;p<e.length;p++){r=l(e[p],g),o=r.f;if(o==="require")i[p]=h(d);else if(o==="exports")i[p]=b[d]={},m=!0;else if(o==="module")n=i[p]={id:d,uri:"",exports:b[d]};else if(b.hasOwnProperty(o)||c.hasOwnProperty(o))i[p]=k(o);else{if(!r.p)throw d+" missing "+o;r.p.load(r.n,h(g,!0),j(o),{}),i[p]=b[o]}}q=f.apply(b[d],i),d&&(n&&n.exports!==a?b[d]=n.exports:m||(b[d]=q))}else d&&(b[d]=f)},requirejs=f=function(b,c,d,g){return typeof b=="string"?k(l(b,c).f):(b.splice||(c.splice?(b=c,c=arguments[2]):b=[]),g?e(a,b,c,d):setTimeout(function(){e(a,b,c,d)},15),f)},f.config=function(){return f},require||(require=f),define=function(a,b,d){b.splice||(d=b,b=[]),define.unordered?c[a]=[a,b,d]:e(a,b,d)},define.amd={jQuery:!0}})();/*!
 * Joshfire Framework 0.9.1
 * http://framework.joshfire.com/
 *
 * Copyright 2011, Joshfire
 * Dual licensed under the GPL Version 2 and a Commercial license.
 * http://framework.joshfire.com/license
 *
 * Date: Wed Jul 20 20:23:43 2011
 */
/*!
 * Joshfire Framework 0.9.1
 * http://framework.joshfire.com/
 *
 * Copyright 2011, Joshfire
 * Dual licensed under the GPL Version 2 and a Commercial license.
 * http://framework.joshfire.com/license
 *
 * Date: Wed Jul 20 20:23:43 2011
 */
/*!
   * iScroll v4.1.9 ~ Copyright (c) 2011 Matteo Spinelli, http://cubiq.org
   * Released under MIT license, http://cubiq.org/license
   */
!function(a,b){function c(a,b){function c(){}c[i]=this[i];var e=this,f=new c,g=j(a),h=g?a:this,k=g?{}:a,l=function(){this.initialize?this.initialize.apply(this,arguments):(b||g&&e.apply(this,arguments),h.apply(this,arguments))};return l.methods=function(a){return d(f,a,e),l[i]=f,this},l.methods.call(l,k).prototype.constructor=l,l.extend=arguments.callee,l[i].implement=l.statics=function(a,b){return a=typeof a=="string"?function(){var c={};return c[a]=b,c}():a,d(this,a,e),this},l}function d(a,b,c){for(var d in b)b.hasOwnProperty(d)&&(a[d]=j(b[d])&&j(c[i][d])&&g.test(b[d])?e(d,b[d],c):b[d])}function e(a,b,c){return function(){var d=this.supr;this.supr=c[i][a];var e=b.apply(this,arguments);return this.supr=d,e}}function f(a){return c.call(j(a)?a:h,a,1)}var g=/xyz/.test(function(){xyz})?/\bsupr\b/:/.*/,h=function(){},i="prototype",j=function(a){return typeof a===b};if(typeof module!="undefined"&&module.exports)module.exports=f;else{var k=a.klass;f.noConflict=function(){return a.klass=k,this},a.klass=f}}(this,"function"),define("vendor/klass",function(){}),function(a){Function.prototype.bind||(Function.prototype.bind=function(a){var b=[].slice,c=b.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||{},c.concat(b.call(arguments)))};return e.prototype=d.prototype,f.prototype=new e,f}),typeof a.Code=="undefined"&&(a.Code={}),a.Code.Util={registerNamespace:function(){var b=arguments,c=null,d,f,g,h,i;d=0;for(h=b.length;d<h;d++){g=b[d],g=g.split("."),c=g[0],typeof a[c]=="undefined"&&(a[c]={}),c=a[c],f=1;for(i=g.length;f<i;++f)c[g[f]]=c[g[f]]||{},c=c[g[f]]}},coalesce:function(){var a,b;a=0;for(b=arguments.length;a<b;a++)if(!this.isNothing(arguments[a]))return arguments[a];return null},extend:function(a,b,c){var d;this.isNothing(c)&&(c=!0);if(a&&b&&this.isObject(b))for(d in b)this.objectHasProperty(b,d)&&(c?a[d]=b[d]:typeof a[d]=="undefined"&&(a[d]=b[d]))},clone:function(a){var b={};return this.extend(b,a),b},isObject:function(a){return a instanceof Object},isFunction:function(a){return{}.toString.call(a)==="[object Function]"},isArray:function(a){return a instanceof Array},isLikeArray:function(a){return typeof a.length=="number"},isNumber:function(a){return typeof a=="number"},isString:function(a){return typeof a=="string"},isNothing:function(a){return typeof a=="undefined"||a===null?!0:!1},swapArrayElements:function(a,b,c){var d=a[b];a[b]=a[c],a[c]=d},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},toCamelCase:function(a){return a.replace(/(\-[a-z])/g,function(a){return a.toUpperCase().replace("-","")})},toDashedCase:function(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})},arrayIndexOf:function(a,b,c){var d,e,f,g;f=-1,d=0;for(e=b.length;d<e;d++)if(g=b[d],this.isNothing(c)){if(g===a){f=d;break}}else if(this.objectHasProperty(g,c)&&g[c]===a){f=d;break}return f},objectHasProperty:function(a,b){return a.hasOwnProperty?a.hasOwnProperty(b):"undefined"!=typeof a[b]}}}(window),function(a,b){b.Browser={ua:null,version:null,safari:null,webkit:null,opera:null,msie:null,chrome:null,mozilla:null,android:null,blackberry:null,iPad:null,iPhone:null,iPod:null,iOS:null,is3dSupported:null,isCSSTransformSupported:null,isTouchSupported:null,isGestureSupported:null,_detect:function(){this.ua=a.navigator.userAgent,this.version=this.ua.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[],this.safari=/Safari/gi.test(a.navigator.appVersion),this.webkit=/webkit/i.test(this.ua),this.opera=/opera/i.test(this.ua),this.msie=/msie/i.test(this.ua)&&!this.opera,this.chrome=/Chrome/i.test(this.ua),this.firefox=/Firefox/i.test(this.ua),this.fennec=/Fennec/i.test(this.ua),this.mozilla=/mozilla/i.test(this.ua)&&!/(compatible|webkit)/.test(this.ua),this.android=/android/i.test(this.ua),this.blackberry=/blackberry/i.test(this.ua),this.iOS=/iphone|ipod|ipad/gi.test(a.navigator.platform),this.iPad=/ipad/gi.test(a.navigator.platform),this.iPhone=/iphone/gi.test(a.navigator.platform),this.iPod=/ipod/gi.test(a.navigator.platform);var d=document.createElement("div");this.is3dSupported=!b.isNothing(d.style.WebkitPerspective),this.isCSSTransformSupported=!b.isNothing(d.style.WebkitTransform)||!b.isNothing(d.style.MozTransform)||!b.isNothing(d.style.transformProperty),this.isTouchSupported=this.isEventSupported("touchstart"),this.isGestureSupported=this.isEventSupported("gesturestart")},_eventTagNames:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},isEventSupported:function(a){var d=document.createElement(this._eventTagNames[a]||"div"),e,a="on"+a;return e=b.objectHasProperty(d,a),e||(d.setAttribute(a,"return;"),e=typeof d[a]=="function"),e},isLandscape:function(){return b.DOM.windowWidth()>b.DOM.windowHeight()}},b.Browser._detect()}(window,window.Code.Util),function(a,b){b.extend(b,{Events:{add:function(a,b,c){this._checkHandlersProperty(a),b==="mousewheel"&&(b=this._normaliseMouseWheelType()),typeof a.__eventHandlers[b]=="undefined"&&(a.__eventHandlers[b]=[]),a.__eventHandlers[b].push(c),this._isBrowserObject(a)&&a.addEventListener(b,c,!1)},remove:function(a,d,e){this._checkHandlersProperty(a),d==="mousewheel"&&(d=this._normaliseMouseWheelType());if(a.__eventHandlers[d]instanceof Array){var f,g,h=a.__eventHandlers[d];if(b.isNothing(e)){if(this._isBrowserObject(a)){f=0;for(g=h.length;f<g;f++)a.removeEventListener(d,h[f],!1)}a.__eventHandlers[d]=[]}else{f=0;for(g=h.length;f<g;f++)if(h[f]===e){h.splice(f,1);break}this._isBrowserObject(a)&&a.removeEventListener(d,e,!1)}}},fire:function(d,f){var g,h,i,j,k=Array.prototype.slice.call(arguments).splice(2);f==="mousewheel"&&(f=this._normaliseMouseWheelType());if(this._isBrowserObject(d)){if(typeof f!="string")throw"type must be a string for DOM elements";i=this._NATIVE_EVENTS[f],g=document.createEvent(i?"HTMLEvents":"UIEvents"),g[i?"initEvent":"initUIEvent"](f,!0,!0,a,1);if(k.length<1){d.dispatchEvent(g);return}}this._checkHandlersProperty(d),g=typeof f=="string"?{type:f}:f,g.target||(g.target=d);if(!g.type)throw Error("Event object missing 'type' property.");if(d.__eventHandlers[g.type]instanceof Array){i=d.__eventHandlers[g.type],k.unshift(g),g=0;for(h=i.length;g<h;g++)j=i[g],b.isNothing(j)||j.apply(d,k)}},getMousePosition:function(a){var b={x:0,y:0};return a.pageX?b.x=a.pageX:a.clientX&&(b.x=a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)),a.pageY?b.y=a.pageY:a.clientY&&(b.y=a.clientY+(document.documentElement.scrollTop||document.body.scrollTop)),b},getTouchEvent:function(a){return a},getWheelDelta:function(a){var d=0;return b.isNothing(a.wheelDelta)?b.isNothing(a.detail)||(d=-a.detail/3):d=a.wheelDelta/120,d},domReady:function(a){document.addEventListener("DOMContentLoaded",a,!1)},_checkHandlersProperty:function(a){b.isNothing(a.__eventHandlers)&&b.extend(a,{__eventHandlers:{}})},_isBrowserObject:function(b){return b===a||b===a.document?!0:this._isElement(b)||this._isNode(b)},_isElement:function(b){return typeof a.HTMLElement=="object"?b instanceof a.HTMLElement:typeof b=="object"&&b.nodeType===1&&typeof b.nodeName=="string"},_isNode:function(b){return typeof a.Node=="object"?b instanceof a.Node:typeof b=="object"&&typeof b.nodeType=="number"&&typeof b.nodeName=="string"},_normaliseMouseWheelType:function(){return b.Browser.isEventSupported("mousewheel")?"mousewheel":"DOMMouseScroll"},_NATIVE_EVENTS:{click:1,dblclick:1,mouseup:1,mousedown:1,contextmenu:1,mousewheel:1,DOMMouseScroll:1,mouseover:1,mouseout:1,mousemove:1,selectstart:1,selectend:1,keydown:1,keypress:1,keyup:1,orientationchange:1,touchstart:1,touchmove:1,touchend:1,touchcancel:1,gesturestart:1,gesturechange:1,gestureend:1,focus:1,blur:1,change:1,reset:1,select:1,submit:1,load:1,unload:1,beforeunload:1,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1}}})}(window,window.Code.Util),function(a,b){b.extend(b,{DOM:{setData:function(a,d,e){if(b.isLikeArray(a)){var f,g;f=0;for(g=a.length;f<g;f++)b.DOM._setData(a[f],d,e)}else b.DOM._setData(a,d,e)},_setData:function(a,d,e){b.DOM.setAttribute(a,"data-"+d,e)},getData:function(a,d,e){return b.DOM.getAttribute(a,"data-"+d,e)},removeData:function(a,d){if(b.isLikeArray(a)){var e,f;e=0;for(f=a.length;e<f;e++)b.DOM._removeData(a[e],d)}else b.DOM._removeData(a,d)},_removeData:function(a,d){b.DOM.removeAttribute(a,"data-"+d)},isChildOf:function(a,b){if(b===a)return!1;for(;a&&a!==b;)a=a.parentNode;return a===b},find:function(d,f){b.isNothing(f)&&(f=a.document);var g=f.querySelectorAll(d),h=[],i,j;i=0;for(j=g.length;i<j;i++)h.push(g[i]);return h},createElement:function(a,d,e){var f,a=document.createElement(a);for(f in d)b.objectHasProperty(d,f)&&a.setAttribute(f,d[f]);return a.innerHTML=e||"",a},appendChild:function(a,b){b.appendChild(a)},insertBefore:function(a,b,c){c.insertBefore(a,b)},appendText:function(a,d){b.DOM.appendChild(document.createTextNode(a),d)},appendToBody:function(a){this.appendChild(a,document.body)},removeChild:function(a,b){b.removeChild(a)},removeChildren:function(a){if(a.hasChildNodes())for(;a.childNodes.length>=1;)a.removeChild(a.childNodes[a.childNodes.length-1])},hasAttribute:function(a,d){return!b.isNothing(a.getAttribute(d))},getAttribute:function(a,d,e){return a=a.getAttribute(d),b.isNothing(a)&&!b.isNothing(e)&&(a=e),a},setAttribute:function(a,d,e){if(b.isLikeArray(a)){var f,g;f=0;for(g=a.length;f<g;f++)b.DOM._setAttribute(a[f],d,e)}else b.DOM._setAttribute(a,d,e)},_setAttribute:function(a,b,c){a.setAttribute(b,c)},removeAttribute:function(a,d){if(b.isLikeArray(a)){var e,f;e=0;for(f=a.length;e<f;e++)b.DOM._removeAttribute(a[e],d)}else b.DOM._removeAttribute(a,d)},_removeAttribute:function(a,b){this.hasAttribute(a,b)&&a.removeAttribute(b)},addClass:function(a,d){if(b.isLikeArray(a)){var e,f;e=0;for(f=a.length;e<f;e++)b.DOM._addClass(a[e],d)}else b.DOM._addClass(a,d)},_addClass:function(a,d){var e=b.DOM.getAttribute(a,"class","");RegExp("(?:^|\\s+)"+d+"(?:\\s+|$)").test(e)||(e!==""&&(e+=" "),e+=d,b.DOM.setAttribute(a,"class",e))},removeClass:function(a,d){if(b.isLikeArray(a)){var e,f;e=0;for(f=a.length;e<f;e++)b.DOM._removeClass(a[e],d)}else b.DOM._removeClass(a,d)},_removeClass:function(a,d){var e=b.DOM.getAttribute(a,"class",""),e=b.trim(e).split(" "),f="",g,h;g=0;for(h=e.length;g<h;g++)e[g]!==d&&(f!==""&&(f+=" "),f+=e[g]);f===""?b.DOM.removeAttribute(a,"class"):b.DOM.setAttribute(a,"class",f)},hasClass:function(a,d){return RegExp("(?:^|\\s+)"+d+"(?:\\s+|$)").test(b.DOM.getAttribute(a,"class",""))},setStyle:function(a,d,e){if(b.isLikeArray(a)){var f,g;f=0;for(g=a.length;f<g;f++)b.DOM._setStyle(a[f],d,e)}else b.DOM._setStyle(a,d,e)},_setStyle:function(a,d,e){var f;if(b.isObject(d))for(f in d)b.objectHasProperty(d,f)&&(f==="width"?b.DOM.width(a,d[f]):f==="height"?b.DOM.height(a,d[f]):a.style[f]=d[f]);else a.style[d]=e},getStyle:function(b,c){var d=a.getComputedStyle(b,"").getPropertyValue(c);return d===""&&(d=b.style[c]),d},hide:function(a){if(b.isLikeArray(a)){var d,e;d=0;for(e=a.length;d<e;d++)b.DOM._hide(a[d])}else b.DOM._hide(a)},_hide:function(a){b.DOM.setData(a,"ccl-disp",b.DOM.getStyle(a,"display")),b.DOM.setStyle(a,"display","none")},show:function(a){if(b.isLikeArray(a)){var d,e;d=0;for(e=a.length;d<e;d++)b.DOM._show(a[d])}else b.DOM._show(a)},_show:function(a){if(b.DOM.getStyle(a,"display")==="none"){var d=b.DOM.getData(a,"ccl-disp","block");if(d==="none"||d==="")d="block";b.DOM.setStyle(a,"display",d)}},width:function(a,d){return b.isNothing(d)||(b.isNumber(d)&&(d+="px"),a.style.width=d),this._getDimension(a,"width")},outerWidth:function(a){var d=b.DOM.width(a);return d+=parseInt(b.DOM.getStyle(a,"padding-left"),10)+parseInt(b.DOM.getStyle(a,"padding-right"),10),d+=parseInt(b.DOM.getStyle(a,"margin-left"),10)+parseInt(b.DOM.getStyle(a,"margin-right"),10),d+=parseInt(b.DOM.getStyle(a,"border-left-width"),10)+parseInt(b.DOM.getStyle(a,"border-right-width"),10),d},height:function(a,d){return b.isNothing(d)||(b.isNumber(d)&&(d+="px"),a.style.height=d),this._getDimension(a,"height")},_getDimension:function(b,c){var d=a.parseInt(a.getComputedStyle(b,"").getPropertyValue(c)),f;return isNaN(d)&&(f={display:b.style.display,left:b.style.left},b.style.display="block",b.style.left="-1000000px",d=a.parseInt(a.getComputedStyle(b,"").getPropertyValue(c)),b.style.display=f.display,b.style.left=f.left),d},outerHeight:function(a){var d=b.DOM.height(a);return d+=parseInt(b.DOM.getStyle(a,"padding-top"),10)+parseInt(b.DOM.getStyle(a,"padding-bottom"),10),d+=parseInt(b.DOM.getStyle(a,"margin-top"),10)+parseInt(b.DOM.getStyle(a,"margin-bottom"),10),d+=parseInt(b.DOM.getStyle(a,"border-top-width"),10)+parseInt(b.DOM.getStyle(a,"border-bottom-width"),10),d},documentWidth:function(){return b.DOM.width(document.documentElement)},documentHeight:function(){return b.DOM.height(document.documentElement)},documentOuterWidth:function(){return b.DOM.width(document.documentElement)},documentOuterHeight:function(){return b.DOM.outerHeight(document.documentElement)},bodyWidth:function(){return b.DOM.width(document.body)},bodyHeight:function(){return b.DOM.height(document.body)},bodyOuterWidth:function(){return b.DOM.outerWidth(document.body)},bodyOuterHeight:function(){return b.DOM.outerHeight(document.body)},windowWidth:function(){return a.innerWidth},windowHeight:function(){return a.innerHeight},windowScrollLeft:function(){return a.pageXOffset},windowScrollTop:function(){return a.pageYOffset}}})}(window,window.Code.Util),function(a,b){b.extend(b,{Animation:{_applyTransitionDelay:50,_transitionEndLabel:a.document.documentElement.style.webkitTransition!==void 0?"webkitTransitionEnd":"transitionend",_transitionEndHandler:null,_transitionPrefix:a.document.documentElement.style.webkitTransition!==void 0?"webkitTransition":a.document.documentElement.style.MozTransition!==void 0?"MozTransition":"transition",_transformLabel:a.document.documentElement.style.webkitTransform!==void 0?"webkitTransform":a.document.documentElement.style.MozTransition!==void 0?"MozTransform":"transform",_getTransitionEndHandler:function(){return b.isNothing(this._transitionEndHandler)&&(this._transitionEndHandler=this._onTransitionEnd.bind(this)),this._transitionEndHandler},stop:function(d){if(b.Browser.isCSSTransformSupported){var f={};b.Events.remove(d,this._transitionEndLabel,this._getTransitionEndHandler()),b.isNothing(d.callbackLabel)&&delete d.callbackLabel,f[this._transitionPrefix+"Property"]="",f[this._transitionPrefix+"Duration"]="",f[this._transitionPrefix+"TimingFunction"]="",f[this._transitionPrefix+"Delay"]="",f[this._transformLabel]="",b.DOM.setStyle(d,f)}else b.isNothing(a.jQuery)||a.jQuery(d).stop(!0,!0)},fadeIn:function(d,f,g,h,i){i=b.coalesce(i,1),i<=0&&(i=1);if(f<=0&&(b.DOM.setStyle(d,"opacity",i),!b.isNothing(g))){g(d);return}b.DOM.getStyle(d,"opacity")>=1&&b.DOM.setStyle(d,"opacity",0),b.Browser.isCSSTransformSupported?this._applyTransition(d,"opacity",i,f,g,h):b.isNothing(a.jQuery)||a.jQuery(d).fadeTo(f,i,g)},fadeTo:function(a,b,c,d,e){this.fadeIn(a,c,d,e,b)},fadeOut:function(d,f,g,h){if(f<=0&&(b.DOM.setStyle(d,"opacity",0),!b.isNothing(g))){g(d);return}b.Browser.isCSSTransformSupported?this._applyTransition(d,"opacity",0,f,g,h):a.jQuery(d).fadeTo(f,0,g)},slideBy:function(d,f,g,h,i,j){var k={},f=b.coalesce(f,0),g=b.coalesce(g,0),j=b.coalesce(j,"ease-out");k[this._transitionPrefix+"Property"]="all",k[this._transitionPrefix+"Delay"]="0",h===0?(k[this._transitionPrefix+"Duration"]="",k[this._transitionPrefix+"TimingFunction"]=""):(k[this._transitionPrefix+"Duration"]=h+"ms",k[this._transitionPrefix+"TimingFunction"]=b.coalesce(j,"ease-out"),b.Events.add(d,this._transitionEndLabel,this._getTransitionEndHandler())),k[this._transformLabel]=b.Browser.is3dSupported?"translate3d("+f+"px, "+g+"px, 0px)":"translate("+f+"px, "+g+"px)",b.isNothing(i)||(d.cclallcallback=i),b.DOM.setStyle(d,k),h===0&&a.setTimeout(function(){this._leaveTransforms(d)}.bind(this),this._applyTransitionDelay)},resetTranslate:function(a){var d={};d[this._transformLabel]=d[this._transformLabel]=b.Browser.is3dSupported?"translate3d(0px, 0px, 0px)":"translate(0px, 0px)",b.DOM.setStyle(a,d)},_applyTransition:function(d,f,g,h,i,j){var k={},j=b.coalesce(j,"ease-in");k[this._transitionPrefix+"Property"]=f,k[this._transitionPrefix+"Duration"]=h+"ms",k[this._transitionPrefix+"TimingFunction"]=j,k[this._transitionPrefix+"Delay"]="0",b.Events.add(d,this._transitionEndLabel,this._getTransitionEndHandler()),b.DOM.setStyle(d,k),b.isNothing(i)||(d["ccl"+f+"callback"]=i),a.setTimeout(function(){b.DOM.setStyle(d,f,g)},this._applyTransitionDelay)},_onTransitionEnd:function(a){b.Events.remove(a.currentTarget,this._transitionEndLabel,this._getTransitionEndHandler()),this._leaveTransforms(a.currentTarget)},_leaveTransforms:function(d){var f=d.style[this._transitionPrefix+"Property"],g=f!==""?"ccl"+f+"callback":"cclallcallback",h,f=b.coalesce(d.style.webkitTransform,d.style.MozTransform,d.style.transform),i,j=a.parseInt(b.DOM.getStyle(d,"left"),0),k=a.parseInt(b.DOM.getStyle(d,"top"),0),l,m,n={};f!==""&&(f=b.Browser.is3dSupported?f.match(/translate3d\((.*?)\)/):f.match(/translate\((.*?)\)/),b.isNothing(f)||(i=f[1].split(", "),l=a.parseInt(i[0],0),m=a.parseInt(i[1],0))),n[this._transitionPrefix+"Property"]="",n[this._transitionPrefix+"Duration"]="",n[this._transitionPrefix+"TimingFunction"]="",n[this._transitionPrefix+"Delay"]="",b.DOM.setStyle(d,n),a.setTimeout(function(){b.isNothing(i)||(n={},n[this._transformLabel]="",n.left=j+l+"px",n.top=k+m+"px",b.DOM.setStyle(d,n)),b.isNothing(d[g])||(h=d[g],delete d[g],h(d))}.bind(this),this._applyTransitionDelay)}}})}(window,window.Code.Util),function(a,b,c){c.registerNamespace("Code.Util.TouchElement"),c.TouchElement.EventTypes={onTouch:"CodeUtilTouchElementOnTouch"},c.TouchElement.ActionTypes={touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd",touchMoveEnd:"touchMoveEnd",tap:"tap",doubleTap:"doubleTap",swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeUp:"swipeUp",swipeDown:"swipeDown",gestureStart:"gestureStart",gestureChange:"gestureChange",gestureEnd:"gestureEnd"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.Util.TouchElement"),c.TouchElement.TouchElementClass=b({el:null,captureSettings:null,touchStartPoint:null,touchEndPoint:null,touchStartTime:null,doubleTapTimeout:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,mouseDownHandler:null,mouseMoveHandler:null,mouseUpHandler:null,mouseOutHandler:null,gestureStartHandler:null,gestureChangeHandler:null,gestureEndHandler:null,swipeThreshold:null,swipeTimeThreshold:null,doubleTapSpeed:null,dispose:function(){var a;this.removeEventHandlers();for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(a,b){this.el=a,this.captureSettings={swipe:!1,move:!1,gesture:!1,doubleTap:!1,preventDefaultTouchEvents:!0},c.extend(this.captureSettings,b),this.swipeThreshold=50,this.doubleTapSpeed=this.swipeTimeThreshold=250,this.touchStartPoint={x:0,y:0},this.touchEndPoint={x:0,y:0}},addEventHandlers:function(){c.isNothing(this.touchStartHandler)&&(this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.touchEndHandler=this.onTouchEnd.bind(this),this.mouseDownHandler=this.onMouseDown.bind(this),this.mouseMoveHandler=this.onMouseMove.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this),this.mouseOutHandler=this.onMouseOut.bind(this),this.gestureStartHandler=this.onGestureStart.bind(this),this.gestureChangeHandler=this.onGestureChange.bind(this),this.gestureEndHandler=this.onGestureEnd.bind(this)),c.Events.add(this.el,"touchstart",this.touchStartHandler),this.captureSettings.move&&c.Events.add(this.el,"touchmove",this.touchMoveHandler),c.Events.add(this.el,"touchend",this.touchEndHandler),c.Events.add(this.el,"mousedown",this.mouseDownHandler),c.Browser.isGestureSupported&&this.captureSettings.gesture&&(c.Events.add(this.el,"gesturestart",this.gestureStartHandler),c.Events.add(this.el,"gesturechange",this.gestureChangeHandler),c.Events.add(this.el,"gestureend",this.gestureEndHandler))},removeEventHandlers:function(){c.Events.remove(this.el,"touchstart",this.touchStartHandler),this.captureSettings.move&&c.Events.remove(this.el,"touchmove",this.touchMoveHandler),c.Events.remove(this.el,"touchend",this.touchEndHandler),c.Events.remove(this.el,"mousedown",this.mouseDownHandler),c.Browser.isGestureSupported&&this.captureSettings.gesture&&(c.Events.remove(this.el,"gesturestart",this.gestureStartHandler),c.Events.remove(this.el,"gesturechange",this.gestureChangeHandler),c.Events.remove(this.el,"gestureend",this.gestureEndHandler))},getTouchPoint:function(a){return{x:a[0].pageX,y:a[0].pageY}},fireTouchEvent:function(b){var d=0,f=0,g=0,h,d=this.touchEndPoint.x-this.touchStartPoint.x,f=this.touchEndPoint.y-this.touchStartPoint.y,g=Math.sqrt(d*d+f*f);if(this.captureSettings.swipe&&(h=new Date,h-=this.touchStartTime,h<=this.swipeTimeThreshold)){if(a.Math.abs(d)>=this.swipeThreshold){c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:d<0?c.TouchElement.ActionTypes.swipeLeft:c.TouchElement.ActionTypes.swipeRight,targetEl:b.target,currentTargetEl:b.currentTarget});return}if(a.Math.abs(f)>=this.swipeThreshold){c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:f<0?c.TouchElement.ActionTypes.swipeUp:c.TouchElement.ActionTypes.swipeDown,targetEl:b.target,currentTargetEl:b.currentTarget});return}}g>1?c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchMoveEnd,point:this.touchEndPoint,targetEl:b.target,currentTargetEl:b.currentTarget}):this.captureSettings.doubleTap?c.isNothing(this.doubleTapTimeout)?this.doubleTapTimeout=a.setTimeout(function(){this.doubleTapTimeout=null,c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c.TouchElement.ActionTypes.tap,targetEl:b.target,currentTargetEl:b.currentTarget})}.bind(this),this.doubleTapSpeed):(a.clearTimeout(this.doubleTapTimeout),this.doubleTapTimeout=null,c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c.TouchElement.ActionTypes.doubleTap,targetEl:b.target,currentTargetEl:b.currentTarget})):c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c.TouchElement.ActionTypes.tap,targetEl:b.target,currentTargetEl:b.currentTarget})},onTouchStart:function(a){this.captureSettings.preventDefaultTouchEvents&&a.preventDefault(),c.Events.remove(this.el,"mousedown",this.mouseDownHandler);var b=c.Events.getTouchEvent(a).touches;b.length>1&&this.captureSettings.gesture?this.isGesture=!0:(this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=this.getTouchPoint(b),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:a.target,currentTargetEl:a.currentTarget}))},onTouchMove:function(a){this.captureSettings.preventDefaultTouchEvents&&a.preventDefault();if(!this.isGesture||!this.captureSettings.gesture){var b=c.Events.getTouchEvent(a).touches;c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchMove,point:this.getTouchPoint(b),targetEl:a.target,currentTargetEl:a.currentTarget})}},onTouchEnd:function(a){if(!this.isGesture||!this.captureSettings.gesture){this.captureSettings.preventDefaultTouchEvents&&a.preventDefault();var b=c.Events.getTouchEvent(a);this.touchEndPoint=this.getTouchPoint(c.isNothing(b.changedTouches)?b.touches:b.changedTouches),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:a.target,currentTargetEl:a.currentTarget}),this.fireTouchEvent(a)}},onMouseDown:function(a){a.preventDefault(),c.Events.remove(this.el,"touchstart",this.mouseDownHandler),c.Events.remove(this.el,"touchmove",this.touchMoveHandler),c.Events.remove(this.el,"touchend",this.touchEndHandler),this.captureSettings.move&&c.Events.add(this.el,"mousemove",this.mouseMoveHandler),c.Events.add(this.el,"mouseup",this.mouseUpHandler),c.Events.add(this.el,"mouseout",this.mouseOutHandler),this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=c.Events.getMousePosition(a),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:a.target,currentTargetEl:a.currentTarget})},onMouseMove:function(a){a.preventDefault(),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchMove,point:c.Events.getMousePosition(a),targetEl:a.target,currentTargetEl:a.currentTarget})},onMouseUp:function(a){a.preventDefault(),this.captureSettings.move&&c.Events.remove(this.el,"mousemove",this.mouseMoveHandler),c.Events.remove(this.el,"mouseup",this.mouseUpHandler),c.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=c.Events.getMousePosition(a),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:a.target,currentTargetEl:a.currentTarget}),this.fireTouchEvent(a)},onMouseOut:function(a){var b=a.relatedTarget;this.el!==b&&!c.DOM.isChildOf(b,this.el)&&(a.preventDefault(),this.captureSettings.move&&c.Events.remove(this.el,"mousemove",this.mouseMoveHandler),c.Events.remove(this.el,"mouseup",this.mouseUpHandler),c.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=c.Events.getMousePosition(a),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:a.target,currentTargetEl:a.currentTarget}),this.fireTouchEvent(a))},onGestureStart:function(a){a.preventDefault();var b=c.Events.getTouchEvent(a);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.gestureStart,scale:b.scale,rotation:b.rotation,targetEl:a.target,currentTargetEl:a.currentTarget})},onGestureChange:function(a){a.preventDefault();var b=c.Events.getTouchEvent(a);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.gestureChange,scale:b.scale,rotation:b.rotation,targetEl:a.target,currentTargetEl:a.currentTarget})},onGestureEnd:function(a){a.preventDefault();var b=c.Events.getTouchEvent(a);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.gestureEnd,scale:b.scale,rotation:b.rotation,targetEl:a.target,currentTargetEl:a.currentTarget})}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Image"),a.Code.PhotoSwipe.Image.EventTypes={onLoad:"onLoad",onError:"onError"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Image");var d=a.Code.PhotoSwipe;d.Image.ImageClass=b({refObj:null,imageEl:null,src:null,caption:null,metaData:null,imageLoadHandler:null,imageErrorHandler:null,dispose:function(){var a;this.shrinkImage();for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,c,d,f){this.refObj=b,this.src=this.originalSrc=c,this.caption=d,this.metaData=f,this.imageEl=new a.Image,this.imageLoadHandler=this.onImageLoad.bind(this),this.imageErrorHandler=this.onImageError.bind(this)},load:function(){this.imageEl.originalSrc=c.coalesce(this.imageEl.originalSrc,""),this.imageEl.originalSrc===this.src?this.imageEl.isError?c.Events.fire(this,{type:d.Image.EventTypes.onError,target:this}):c.Events.fire(this,{type:d.Image.EventTypes.onLoad,target:this}):(this.imageEl.isError=!1,this.imageEl.isLoading=!0,this.imageEl.naturalWidth=null,this.imageEl.naturalHeight=null,this.imageEl.isLandscape=!1,this.imageEl.onload=this.imageLoadHandler,this.imageEl.onerror=this.imageErrorHandler,this.imageEl.onabort=this.imageErrorHandler,this.imageEl.originalSrc=this.src,this.imageEl.src=this.src)},shrinkImage:function(){!c.isNothing(this.imageEl)&&this.imageEl.src.indexOf(this.src)>-1&&(this.imageEl.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",c.isNothing(this.imageEl.parentNode)||c.DOM.removeChild(this.imageEl,this.imageEl.parentNode))},onImageLoad:function(){this.imageEl.onload=null,this.imageEl.naturalWidth=c.coalesce(this.imageEl.naturalWidth,this.imageEl.width),this.imageEl.naturalHeight=c.coalesce(this.imageEl.naturalHeight,this.imageEl.height),this.imageEl.isLandscape=this.imageEl.naturalWidth>this.imageEl.naturalHeight,this.imageEl.isLoading=!1,c.Events.fire(this,{type:d.Image.EventTypes.onLoad,target:this})},onImageError:function(){this.imageEl.onload=null,this.imageEl.onerror=null,this.imageEl.onabort=null,this.imageEl.isLoading=!1,this.imageEl.isError=!0,c.Events.fire(this,{type:d.Image.EventTypes.onError,target:this})}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Cache"),a=a.Code.PhotoSwipe,a.Cache.Mode={normal:"normal",aggressive:"aggressive"},a.Cache.Functions={getImageSource:function(a){return a.href},getImageCaption:function(a){if(a.nodeName==="IMG")return c.DOM.getAttribute(a,"alt");var b,d,e;b=0;for(d=a.childNodes.length;b<d;b++)if(e=a.childNodes[b],a.childNodes[b].nodeName==="IMG")return c.DOM.getAttribute(e,"alt")},getImageMetaData:function(){return{}}}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Cache");var d=a.Code.PhotoSwipe;d.Cache.CacheClass=b({images:null,settings:null,dispose:function(){var a,b,d;if(!c.isNothing(this.images)){b=0;for(d=this.images.length;b<d;b++)this.images[b].dispose();this.images.length=0}for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(a,b){var c,e,f,g,h,i;this.settings=b,this.images=[],c=0;for(e=a.length;c<e;c++)f=a[c],g=this.settings.getImageSource(f),h=this.settings.getImageCaption(f),i=this.settings.getImageMetaData(f),this.images.push(new d.Image.ImageClass(f,g,h,i))},getImages:function(a){var b,e,f=[],g;b=0;for(e=a.length;b<e;b++)g=this.images[a[b]],this.settings.cacheMode===d.Cache.Mode.aggressive&&(g.cacheDoNotShrink=!0),f.push(g);if(this.settings.cacheMode===d.Cache.Mode.aggressive){b=0;for(e=this.images.length;b<e;b++)g=this.images[b],c.objectHasProperty(g,"cacheDoNotShrink")?delete g.cacheDoNotShrink:g.shrinkImage()}return f}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Image),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.DocumentOverlay"),a.Code.PhotoSwipe.DocumentOverlay.CssClasses={documentOverlay:"ps-document-overlay"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var d=a.Code.PhotoSwipe;d.DocumentOverlay.DocumentOverlayClass=b({el:null,settings:null,initialBodyHeight:null,dispose:function(){var a;c.Animation.stop(this.el),c.DOM.removeChild(this.el,this.el.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b){this.settings=b,this.el=c.DOM.createElement("div",{"class":d.DocumentOverlay.CssClasses.documentOverlay},""),c.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,zIndex:this.settings.zIndex}),c.DOM.hide(this.el),this.settings.target===a?c.DOM.appendToBody(this.el):c.DOM.appendChild(this.el,this.settings.target),c.Animation.resetTranslate(this.el),this.initialBodyHeight=c.DOM.bodyOuterHeight()},resetPosition:function(){var b,d,f;this.settings.target===a?(b=c.DOM.windowWidth(),d=c.DOM.bodyOuterHeight()*2,f=this.settings.jQueryMobile?c.DOM.windowScrollTop()+"px":"0px",d<1&&(d=this.initialBodyHeight),c.DOM.windowHeight()>d&&(d=c.DOM.windowHeight())):(b=c.DOM.width(this.settings.target),d=c.DOM.height(this.settings.target),f="0px"),c.DOM.setStyle(this.el,{width:b,height:d,top:f})},fadeIn:function(a,b){this.resetPosition(),c.DOM.setStyle(this.el,"opacity",0),c.DOM.show(this.el),c.Animation.fadeIn(this.el,a,b)}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Carousel"),a=a.Code.PhotoSwipe,a.Carousel.EventTypes={onSlideByEnd:"PhotoSwipeCarouselOnSlideByEnd",onSlideshowStart:"PhotoSwipeCarouselOnSlideshowStart",onSlideshowStop:"PhotoSwipeCarouselOnSlideshowStop"},a.Carousel.CssClasses={carousel:"ps-carousel",content:"ps-carousel-content",item:"ps-carousel-item",itemLoading:"ps-carousel-item-loading",itemError:"ps-carousel-item-error"},a.Carousel.SlideByAction={previous:"previous",current:"current",next:"next"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Carousel");var d=a.Code.PhotoSwipe;d.Carousel.CarouselClass=b({el:null,contentEl:null,settings:null,cache:null,slideByEndHandler:null,currentCacheIndex:null,isSliding:null,isSlideshowActive:null,lastSlideByAction:null,touchStartPoint:null,touchStartPosition:null,imageLoadHandler:null,imageErrorHandler:null,slideshowTimeout:null,dispose:function(){var a,b,e;b=0;for(e=this.cache.images.length;b<e;b++)c.Events.remove(this.cache.images[b],d.Image.EventTypes.onLoad,this.imageLoadHandler),c.Events.remove(this.cache.images[b],d.Image.EventTypes.onError,this.imageErrorHandler);this.stopSlideshow(),c.Animation.stop(this.el),c.DOM.removeChild(this.el,this.el.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,f){var g,h,i;this.cache=b,this.settings=f,this.slideByEndHandler=this.onSlideByEnd.bind(this),this.imageLoadHandler=this.onImageLoad.bind(this),this.imageErrorHandler=this.onImageError.bind(this),this.currentCacheIndex=0,this.isSlideshowActive=this.isSliding=!1,this.cache.images.length<3&&(this.settings.loop=!1),this.el=c.DOM.createElement("div",{"class":d.Carousel.CssClasses.carousel},""),c.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex}),c.DOM.hide(this.el),this.contentEl=c.DOM.createElement("div",{"class":d.Carousel.CssClasses.content},""),c.DOM.setStyle(this.contentEl,{display:"block",position:"absolute",left:0,top:0}),c.DOM.appendChild(this.contentEl,this.el),h=b.images.length<3?b.images.length:3;for(g=0;g<h;g++)i=c.DOM.createElement("div",{"class":d.Carousel.CssClasses.item+" "+d.Carousel.CssClasses.item+"-"+g},""),c.DOM.setAttribute(i,"style","float: left;"),c.DOM.setStyle(i,{display:"block",position:"relative",left:0,top:0,overflow:"hidden"}),this.settings.margin>0&&c.DOM.setStyle(i,{marginRight:this.settings.margin+"px"}),c.DOM.appendChild(i,this.contentEl);this.settings.target===a?c.DOM.appendToBody(this.el):c.DOM.appendChild(this.el,this.settings.target)},resetPosition:function(){var b,f,g,h,i,j;this.settings.target===a?(b=c.DOM.windowWidth(),f=c.DOM.windowHeight(),g=c.DOM.windowScrollTop()+"px"):(b=c.DOM.width(this.settings.target),f=c.DOM.height(this.settings.target),g="0px"),h=this.settings.margin>0?b+this.settings.margin:b,i=c.DOM.find("."+d.Carousel.CssClasses.item,this.contentEl),h*=i.length,c.DOM.setStyle(this.el,{top:g,width:b,height:f}),c.DOM.setStyle(this.contentEl,{width:h,height:f}),g=0;for(h=i.length;g<h;g++)j=i[g],c.DOM.setStyle(j,{width:b,height:f}),j=c.DOM.find("img",j)[0],c.isNothing(j)||this.resetImagePosition(j);this.setContentLeftPosition()},resetImagePosition:function(a){if(!c.isNothing(a)){c.DOM.getAttribute(a,"src");var b,d,e,f=c.DOM.width(this.el),g=c.DOM.height(this.el);this.settings.imageScaleMethod==="fitNoUpscale"?(d=a.naturalWidth,e=a.naturalHeight,d>f&&(b=f/d,d=Math.round(d*b),e=Math.round(e*b)),e>g&&(b=g/e,e=Math.round(e*b),d=Math.round(d*b))):(b=a.isLandscape?f/a.naturalWidth:g/a.naturalHeight,d=Math.round(a.naturalWidth*b),e=Math.round(a.naturalHeight*b),this.settings.imageScaleMethod==="zoom"?(b=1,e<g?b=g/e:d<f&&(b=f/d),b!==1&&(d=Math.round(d*b),e=Math.round(e*b))):this.settings.imageScaleMethod==="fit"&&(b=1,d>f?b=f/d:e>g&&(b=g/e),b!==1&&(d=Math.round(d*b),e=Math.round(e*b)))),c.DOM.setStyle(a,{position:"absolute",width:d,height:e,top:Math.round((g-e)/2)+"px",left:Math.round((f-d)/2)+"px",display:"block"})}},setContentLeftPosition:function(){var b,d,f;b=this.settings.target===a?c.DOM.windowWidth():c.DOM.width(this.settings.target),d=this.getItemEls(),f=0,this.settings.loop?f=(b+this.settings.margin)*-1:this.currentCacheIndex===this.cache.images.length-1?f=(d.length-1)*(b+this.settings.margin)*-1:this.currentCacheIndex>0&&(f=(b+this.settings.margin)*-1),c.DOM.setStyle(this.contentEl,{left:f+"px"})},show:function(a){this.currentCacheIndex=a,this.resetPosition(),this.setImages(!1),c.DOM.show(this.el),c.Animation.resetTranslate(this.contentEl);var a=this.getItemEls(),b,e;b=0;for(e=a.length;b<e;b++)c.Animation.resetTranslate(a[b]);c.Events.fire(this,{type:d.Carousel.EventTypes.onSlideByEnd,target:this,action:d.Carousel.SlideByAction.current,cacheIndex:this.currentCacheIndex})},setImages:function(a){var b,c=this.getItemEls();b=this.currentCacheIndex+1;var d=this.currentCacheIndex-1;this.settings.loop?(b>this.cache.images.length-1&&(b=0),d<0&&(d=this.cache.images.length-1),b=this.cache.getImages([d,this.currentCacheIndex,b]),a||this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[2],c[2]),this.addCacheImageToItemEl(b[0],c[0])):c.length===1?a||(b=this.cache.getImages([this.currentCacheIndex]),this.addCacheImageToItemEl(b[0],c[0])):c.length===2?this.currentCacheIndex===0?(b=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1]),a||this.addCacheImageToItemEl(b[0],c[0]),this.addCacheImageToItemEl(b[1],c[1])):(b=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex]),a||this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[0],c[0])):this.currentCacheIndex===0?(b=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1,this.currentCacheIndex+2]),a||this.addCacheImageToItemEl(b[0],c[0]),this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[2],c[2])):(this.currentCacheIndex===this.cache.images.length-1?(b=this.cache.getImages([this.currentCacheIndex-2,this.currentCacheIndex-1,this.currentCacheIndex]),a||this.addCacheImageToItemEl(b[2],c[2]),this.addCacheImageToItemEl(b[1],c[1])):(b=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex,this.currentCacheIndex+1]),a||this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[2],c[2])),this.addCacheImageToItemEl(b[0],c[0]))},addCacheImageToItemEl:function(a,b){c.DOM.removeClass(b,d.Carousel.CssClasses.itemError),c.DOM.addClass(b,d.Carousel.CssClasses.itemLoading),c.DOM.removeChildren(b),c.DOM.setStyle(a.imageEl,{display:"none"}),c.DOM.appendChild(a.imageEl,b),c.Animation.resetTranslate(a.imageEl),c.Events.add(a,d.Image.EventTypes.onLoad,this.imageLoadHandler),c.Events.add(a,d.Image.EventTypes.onError,this.imageErrorHandler),a.load()},slideCarousel:function(b,f,g){if(!this.isSliding){var h,i;h=this.settings.target===a?c.DOM.windowWidth()+this.settings.margin:c.DOM.width(this.settings.target)+this.settings.margin,g=c.coalesce(g,this.settings.slideSpeed);if(!(a.Math.abs(i)<1)){switch(f){case c.TouchElement.ActionTypes.swipeLeft:b=h*-1;break;case c.TouchElement.ActionTypes.swipeRight:b=h;break;default:i=b.x-this.touchStartPoint.x,b=a.Math.abs(i)>h/2?i>0?h:h*-1:0}this.lastSlideByAction=b<0?d.Carousel.SlideByAction.next:b>0?d.Carousel.SlideByAction.previous:d.Carousel.SlideByAction.current,!this.settings.loop&&(this.lastSlideByAction===d.Carousel.SlideByAction.previous&&this.currentCacheIndex===0||this.lastSlideByAction===d.Carousel.SlideByAction.next&&this.currentCacheIndex===this.cache.images.length-1)&&(b=0,this.lastSlideByAction=d.Carousel.SlideByAction.current),this.isSliding=!0,this.doSlideCarousel(b,g)}}},moveCarousel:function(a){this.isSliding||this.settings.enableDrag&&this.doMoveCarousel(a.x-this.touchStartPoint.x)},getItemEls:function(){return c.DOM.find("."+d.Carousel.CssClasses.item,this.contentEl)},previous:function(){this.stopSlideshow(),this.slideCarousel({x:0,y:0},c.TouchElement.ActionTypes.swipeRight,this.settings.nextPreviousSlideSpeed)},next:function(){this.stopSlideshow(),this.slideCarousel({x:0,y:0},c.TouchElement.ActionTypes.swipeLeft,this.settings.nextPreviousSlideSpeed)},slideshowNext:function(){this.slideCarousel({x:0,y:0},c.TouchElement.ActionTypes.swipeLeft)},startSlideshow:function(){this.stopSlideshow(),this.isSlideshowActive=!0,this.slideshowTimeout=a.setTimeout(this.slideshowNext.bind(this),this.settings.slideshowDelay),c.Events.fire(this,{type:d.Carousel.EventTypes.onSlideshowStart,target:this})},stopSlideshow:function(){c.isNothing(this.slideshowTimeout)||(a.clearTimeout(this.slideshowTimeout),this.slideshowTimeout=null,this.isSlideshowActive=!1,c.Events.fire(this,{type:d.Carousel.EventTypes.onSlideshowStop,target:this}))},onSlideByEnd:function(){if(!c.isNothing(this.isSliding)){var a=this.getItemEls();this.isSliding=!1,this.lastSlideByAction===d.Carousel.SlideByAction.next?this.currentCacheIndex+=1:this.lastSlideByAction===d.Carousel.SlideByAction.previous&&(this.currentCacheIndex-=1),this.settings.loop?(this.lastSlideByAction===d.Carousel.SlideByAction.next?c.DOM.appendChild(a[0],this.contentEl):this.lastSlideByAction===d.Carousel.SlideByAction.previous&&c.DOM.insertBefore(a[a.length-1],a[0],this.contentEl),this.currentCacheIndex<0)?this.currentCacheIndex=this.cache.images.length-1:this.currentCacheIndex===this.cache.images.length&&(this.currentCacheIndex=0):this.cache.images.length>3&&(this.currentCacheIndex>1&&this.currentCacheIndex<this.cache.images.length-2?this.lastSlideByAction===d.Carousel.SlideByAction.next?c.DOM.appendChild(a[0],this.contentEl):this.lastSlideByAction===d.Carousel.SlideByAction.previous&&c.DOM.insertBefore(a[a.length-1],a[0],this.contentEl):this.currentCacheIndex===1?this.lastSlideByAction===d.Carousel.SlideByAction.previous&&c.DOM.insertBefore(a[a.length-1],a[0],this.contentEl):this.currentCacheIndex===this.cache.images.length-2&&this.lastSlideByAction===d.Carousel.SlideByAction.next&&c.DOM.appendChild(a[0],this.contentEl)),this.lastSlideByAction!==d.Carousel.SlideByAction.current&&(this.setContentLeftPosition(),this.setImages(!0)),c.Events.fire(this,{type:d.Carousel.EventTypes.onSlideByEnd,target:this,action:this.lastSlideByAction,cacheIndex:this.currentCacheIndex}),this.isSlideshowActive&&(this.lastSlideByAction!==d.Carousel.SlideByAction.current?this.startSlideshow():this.stopSlideshow())}},onTouch:function(b,d){this.stopSlideshow();switch(b){case c.TouchElement.ActionTypes.touchStart:this.touchStartPoint=d,this.touchStartPosition={x:a.parseInt(c.DOM.getStyle(this.contentEl,"left"),0),y:a.parseInt(c.DOM.getStyle(this.contentEl,"top"),0)};break;case c.TouchElement.ActionTypes.touchMove:this.moveCarousel(d);break;case c.TouchElement.ActionTypes.touchMoveEnd:case c.TouchElement.ActionTypes.swipeLeft:case c.TouchElement.ActionTypes.swipeRight:this.slideCarousel(d,b)}},onImageLoad:function(a){a=a.target,c.isNothing(a.imageEl.parentNode)||(c.DOM.removeClass(a.imageEl.parentNode,d.Carousel.CssClasses.itemLoading),this.resetImagePosition(a.imageEl)),c.Events.remove(a,d.Image.EventTypes.onLoad,this.imageLoadHandler),c.Events.remove(a,d.Image.EventTypes.onError,this.imageErrorHandler)},onImageError:function(a){a=a.target,c.isNothing(a.imageEl.parentNode)||(c.DOM.removeClass(a.imageEl.parentNode,d.Carousel.CssClasses.itemLoading),c.DOM.addClass(a.imageEl.parentNode,d.Carousel.CssClasses.itemError)),c.Events.remove(a,d.Image.EventTypes.onLoad,this.imageLoadHandler),c.Events.remove(a,d.Image.EventTypes.onError,this.imageErrorHandler)}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Carousel"),b=a.Code.PhotoSwipe,b.Carousel.CarouselClass=b.Carousel.CarouselClass.extend({getStartingPos:function(){var b=this.touchStartPosition;return c.isNothing(b)&&(b={x:a.parseInt(c.DOM.getStyle(this.contentEl,"left"),0),y:a.parseInt(c.DOM.getStyle(this.contentEl,"top"),0)}),b},doMoveCarousel:function(b){var d;c.Browser.isCSSTransformSupported?(d={},d[c.Animation._transitionPrefix+"Property"]="all",d[c.Animation._transitionPrefix+"Duration"]="",d[c.Animation._transitionPrefix+"TimingFunction"]="",d[c.Animation._transitionPrefix+"Delay"]="0",d[c.Animation._transformLabel]=c.Browser.is3dSupported?"translate3d("+b+"px, 0px, 0px)":"translate("+b+"px, 0px)",c.DOM.setStyle(this.contentEl,d)):c.isNothing(a.jQuery)||a.jQuery(this.contentEl).stop().css("left",this.getStartingPos().x+b+"px")},doSlideCarousel:function(b,d){var f;d<=0?this.slideByEndHandler():c.Browser.isCSSTransformSupported?(f=c.coalesce(this.contentEl.style.webkitTransform,this.contentEl.style.MozTransform,this.contentEl.style.transform,""),f.indexOf("translate3d("+b)===0?this.slideByEndHandler():f.indexOf("translate("+b)===0?this.slideByEndHandler():c.Animation.slideBy(this.contentEl,b,0,d,this.slideByEndHandler,this.settings.slideTimingFunction)):c.isNothing(a.jQuery)||(f={left:this.getStartingPos().x+b+"px"},this.settings.animationTimingFunction==="ease-out"&&(this.settings.animationTimingFunction="easeOutQuad"),c.isNothing(a.jQuery.easing[this.settings.animationTimingFunction])&&(this.settings.animationTimingFunction="linear"),a.jQuery(this.contentEl).animate(f,this.settings.slideSpeed,this.settings.animationTimingFunction,this.slideByEndHandler))}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.TouchElement),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Toolbar");var d=a.Code.PhotoSwipe;d.Toolbar.CssClasses={toolbar:"ps-toolbar",toolbarContent:"ps-toolbar-content",toolbarTop:"ps-toolbar-top",caption:"ps-caption",captionBottom:"ps-caption-bottom",captionContent:"ps-caption-content",close:"ps-toolbar-close",play:"ps-toolbar-play",previous:"ps-toolbar-previous",previousDisabled:"ps-toolbar-previous-disabled",next:"ps-toolbar-next",nextDisabled:"ps-toolbar-next-disabled"},d.Toolbar.ToolbarAction={close:"close",play:"play",next:"next",previous:"previous",none:"none"},d.Toolbar.EventTypes={onTap:"PhotoSwipeToolbarOnClick",onBeforeShow:"PhotoSwipeToolbarOnBeforeShow",onShow:"PhotoSwipeToolbarOnShow",onBeforeHide:"PhotoSwipeToolbarOnBeforeHide",onHide:"PhotoSwipeToolbarOnHide"},d.Toolbar.getToolbar=function(){return'<div class="'+d.Toolbar.CssClasses.close+'"><div class="'+d.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+d.Toolbar.CssClasses.play+'"><div class="'+d.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+d.Toolbar.CssClasses.previous+'"><div class="'+d.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+d.Toolbar.CssClasses.next+'"><div class="'+d.Toolbar.CssClasses.toolbarContent+'"></div></div>'}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Toolbar");var d=a.Code.PhotoSwipe;d.Toolbar.ToolbarClass=b({toolbarEl:null,closeEl:null,playEl:null,previousEl:null,nextEl:null,captionEl:null,captionContentEl:null,currentCaption:null,settings:null,cache:null,timeout:null,isVisible:null,fadeOutHandler:null,touchStartHandler:null,touchMoveHandler:null,clickHandler:null,dispose:function(){var a;this.clearTimeout(),this.removeEventHandlers(),c.Animation.stop(this.toolbarEl),c.Animation.stop(this.captionEl),c.DOM.removeChild(this.toolbarEl,this.toolbarEl.parentNode),c.DOM.removeChild(this.captionEl,this.captionEl.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,f){var g;this.settings=f,this.cache=b,this.isVisible=!1,this.fadeOutHandler=this.onFadeOut.bind(this),this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.clickHandler=this.onClick.bind(this),g=d.Toolbar.CssClasses.toolbar,this.settings.captionAndToolbarFlipPosition&&(g=g+" "+d.Toolbar.CssClasses.toolbarTop),this.toolbarEl=c.DOM.createElement("div",{"class":g},this.settings.getToolbar()),c.DOM.setStyle(this.toolbarEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex}),this.settings.target===a?c.DOM.appendToBody(this.toolbarEl):c.DOM.appendChild(this.toolbarEl,this.settings.target),c.DOM.hide(this.toolbarEl),this.closeEl=c.DOM.find("."+d.Toolbar.CssClasses.close,this.toolbarEl)[0],this.settings.preventHide&&!c.isNothing(this.closeEl)&&c.DOM.hide(this.closeEl),this.playEl=c.DOM.find("."+d.Toolbar.CssClasses.play,this.toolbarEl)[0],this.settings.preventSlideshow&&!c.isNothing(this.playEl)&&c.DOM.hide(this.playEl),this.nextEl=c.DOM.find("."+d.Toolbar.CssClasses.next,this.toolbarEl)[0],this.previousEl=c.DOM.find("."+d.Toolbar.CssClasses.previous,this.toolbarEl)[0],g=d.Toolbar.CssClasses.caption,this.settings.captionAndToolbarFlipPosition&&(g=g+" "+d.Toolbar.CssClasses.captionBottom),this.captionEl=c.DOM.createElement("div",{"class":g},""),c.DOM.setStyle(this.captionEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex}),this.settings.target===a?c.DOM.appendToBody(this.captionEl):c.DOM.appendChild(this.captionEl,this.settings.target),c.DOM.hide(this.captionEl),this.captionContentEl=c.DOM.createElement("div",{"class":d.Toolbar.CssClasses.captionContent},""),c.DOM.appendChild(this.captionContentEl,this.captionEl),this.addEventHandlers()},resetPosition:function(){var b,d,f;this.settings.target===a?(this.settings.captionAndToolbarFlipPosition?(d=c.DOM.windowScrollTop(),f=c.DOM.windowScrollTop()+c.DOM.windowHeight()-c.DOM.height(this.captionEl)):(d=c.DOM.windowScrollTop()+c.DOM.windowHeight()-c.DOM.height(this.toolbarEl),f=c.DOM.windowScrollTop()),b=c.DOM.windowWidth()):(this.settings.captionAndToolbarFlipPosition?(d="0",f=c.DOM.height(this.settings.target)-c.DOM.height(this.captionEl)):(d=c.DOM.height(this.settings.target)-c.DOM.height(this.toolbarEl),f=0),b=c.DOM.width(this.settings.target)),c.DOM.setStyle(this.toolbarEl,{top:d+"px",width:b}),c.DOM.setStyle(this.captionEl,{top:f+"px",width:b})},toggleVisibility:function(a){this.isVisible?this.fadeOut():this.show(a)},show:function(a){c.Animation.stop(this.toolbarEl),c.Animation.stop(this.captionEl),this.resetPosition(),this.setToolbarStatus(a),c.Events.fire(this,{type:d.Toolbar.EventTypes.onBeforeShow,target:this}),this.showToolbar(),this.setCaption(a),this.showCaption(),this.isVisible=!0,this.setTimeout(),c.Events.fire(this,{type:d.Toolbar.EventTypes.onShow,target:this})},setTimeout:function(){this.settings.captionAndToolbarAutoHideDelay>0&&(this.clearTimeout(),this.timeout=a.setTimeout(this.fadeOut.bind(this),this.settings.captionAndToolbarAutoHideDelay))},clearTimeout:function(){c.isNothing(this.timeout)||(a.clearTimeout(this.timeout),this.timeout=null)},fadeOut:function(){this.clearTimeout(),c.Events.fire(this,{type:d.Toolbar.EventTypes.onBeforeHide,target:this}),c.Animation.fadeOut(this.toolbarEl,this.settings.fadeOutSpeed),c.Animation.fadeOut(this.captionEl,this.settings.fadeOutSpeed,this.fadeOutHandler),this.isVisible=!1},addEventHandlers:function(){c.Browser.isTouchSupported&&(c.Browser.blackberry||c.Events.add(this.toolbarEl,"touchstart",this.touchStartHandler),c.Events.add(this.toolbarEl,"touchmove",this.touchMoveHandler),c.Events.add(this.captionEl,"touchmove",this.touchMoveHandler)),c.Events.add(this.toolbarEl,"click",this.clickHandler)},removeEventHandlers:function(){c.Browser.isTouchSupported&&(c.Browser.blackberry||c.Events.remove(this.toolbarEl,"touchstart",this.touchStartHandler),c.Events.remove(this.toolbarEl,"touchmove",this.touchMoveHandler),c.Events.remove(this.captionEl,"touchmove",this.touchMoveHandler)),c.Events.remove(this.toolbarEl,"click",this.clickHandler)},handleTap:function(a){this.clearTimeout();var b;if(a.target===this.nextEl||c.DOM.isChildOf(a.target,this.nextEl))b=d.Toolbar.ToolbarAction.next;else if(a.target===this.previousEl||c.DOM.isChildOf(a.target,this.previousEl))b=d.Toolbar.ToolbarAction.previous;else if(a.target===this.closeEl||c.DOM.isChildOf(a.target,this.closeEl))b=d.Toolbar.ToolbarAction.close;else if(a.target===this.playEl||c.DOM.isChildOf(a.target,this.playEl))b=d.Toolbar.ToolbarAction.play;this.setTimeout(),c.isNothing(b)&&(b=d.Toolbar.ToolbarAction.none),c.Events.fire(this,{type:d.Toolbar.EventTypes.onTap,target:this,action:b,tapTarget:a.target})},setCaption:function(a){c.DOM.removeChildren(this.captionContentEl),this.currentCaption=c.coalesce(this.cache.images[a].caption," "),c.isObject(this.currentCaption)?c.DOM.appendChild(this.currentCaption,this.captionContentEl):(this.currentCaption===""&&(this.currentCaption=" "),c.DOM.appendText(this.currentCaption,this.captionContentEl)),this.currentCaption=this.currentCaption===" "?"":this.currentCaption,this.resetPosition()},showToolbar:function(){c.DOM.setStyle(this.toolbarEl,{opacity:this.settings.captionAndToolbarOpacity}),c.DOM.show(this.toolbarEl)},showCaption:function(){(this.currentCaption===""||this.captionContentEl.childNodes.length<1)&&!this.settings.captionAndToolbarShowEmptyCaptions?c.DOM.hide(this.captionEl):(c.DOM.setStyle(this.captionEl,{opacity:this.settings.captionAndToolbarOpacity}),c.DOM.show(this.captionEl))},setToolbarStatus:function(a){this.settings.loop||(c.DOM.removeClass(this.previousEl,d.Toolbar.CssClasses.previousDisabled),c.DOM.removeClass(this.nextEl,d.Toolbar.CssClasses.nextDisabled),a>0&&a<this.cache.images.length-1||(a===0&&(c.isNothing(this.previousEl)||c.DOM.addClass(this.previousEl,d.Toolbar.CssClasses.previousDisabled)),a===this.cache.images.length-1&&(c.isNothing(this.nextEl)||c.DOM.addClass(this.nextEl,d.Toolbar.CssClasses.nextDisabled))))},onFadeOut:function(){c.DOM.hide(this.toolbarEl),c.DOM.hide(this.captionEl),c.Events.fire(this,{type:d.Toolbar.EventTypes.onHide,target:this})},onTouchStart:function(a){},onTouchMove:function(a){a.preventDefault()},onClick:function(a){a.preventDefault(),this.handleTap(a)}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.UILayer"),a.Code.PhotoSwipe.UILayer.CssClasses={uiLayer:"ps-uilayer"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.UILayer");var d=a.Code.PhotoSwipe;d.UILayer.UILayerClass=c.TouchElement.TouchElementClass.extend({el:null,settings:null,dispose:function(){var a;this.removeEventHandlers(),c.DOM.removeChild(this.el,this.el.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b){this.settings=b,this.el=c.DOM.createElement("div",{"class":d.UILayer.CssClasses.uiLayer},""),c.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex,opacity:0}),c.DOM.hide(this.el),this.settings.target===a?c.DOM.appendToBody(this.el):c.DOM.appendChild(this.el,this.settings.target),this.supr(this.el,{swipe:!0,move:!0,gesture:c.Browser.iOS,doubleTap:!0,preventDefaultTouchEvents:this.settings.preventDefaultTouchEvents})},resetPosition:function(){this.settings.target===a?c.DOM.setStyle(this.el,{top:c.DOM.windowScrollTop()+"px",width:c.DOM.windowWidth(),height:c.DOM.windowHeight()}):c.DOM.setStyle(this.el,{top:"0px",width:c.DOM.width(this.settings.target),height:c.DOM.height(this.settings.target)})},show:function(){this.resetPosition(),c.DOM.show(this.el),this.addEventHandlers()},addEventHandlers:function(){this.supr()},removeEventHandlers:function(){this.supr()}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.ZoomPanRotate"),a=a.Code.PhotoSwipe,a.ZoomPanRotate.CssClasses={zoomPanRotate:"ps-zoom-pan-rotate"},a.ZoomPanRotate.EventTypes={onTransform:"PhotoSwipeZoomPanRotateOnTransform"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var d=a.Code.PhotoSwipe;d.ZoomPanRotate.ZoomPanRotateClass=b({el:null,settings:null,containerEl:null,imageEl:null,transformSettings:null,panStartingPoint:null,transformEl:null,dispose:function(){var a;c.DOM.removeChild(this.el,this.el.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,f,g){var h,i,j;this.settings=b,this.settings.target===a?(b=document.body,h=c.DOM.windowWidth(),i=c.DOM.windowHeight(),j=c.DOM.windowScrollTop()+"px"):(b=this.settings.target,h=c.DOM.width(b),i=c.DOM.height(b),j="0px"),this.imageEl=f.imageEl.cloneNode(!1),c.DOM.setStyle(this.imageEl,{zIndex:1}),this.transformSettings={startingScale:1,scale:1,startingRotation:0,rotation:0,startingTranslateX:0,startingTranslateY:0,translateX:0,translateY:0},this.el=c.DOM.createElement("div",{"class":d.ZoomPanRotate.CssClasses.zoomPanRotate},""),c.DOM.setStyle(this.el,{left:0,top:j,position:"absolute",width:h,height:i,zIndex:this.settings.zIndex,display:"block"}),c.DOM.insertBefore(this.el,g.el,b),c.Browser.iOS?(this.containerEl=c.DOM.createElement("div"),c.DOM.setStyle(this.containerEl,{left:0,top:0,width:h,height:i,position:"absolute",zIndex:1}),c.DOM.appendChild(this.imageEl,this.containerEl),c.DOM.appendChild(this.containerEl,this.el),c.Animation.resetTranslate(this.containerEl),c.Animation.resetTranslate(this.imageEl),this.transformEl=this.containerEl):(c.DOM.appendChild(this.imageEl,this.el),this.transformEl=this.imageEl)},setStartingTranslateFromCurrentTransform:function(){var b=c.coalesce(this.transformEl.style.webkitTransform,this.transformEl.style.MozTransform,this.transformEl.style.transform);!c.isNothing(b)&&(b=b.match(/translate\((.*?)\)/),!c.isNothing(b))&&(b=b[1].split(", "),this.transformSettings.startingTranslateX=a.parseInt(b[0],10),this.transformSettings.startingTranslateY=a.parseInt(b[1],10))},getScale:function(a){return a*=this.transformSettings.startingScale,this.settings.minUserZoom!==0&&a<this.settings.minUserZoom?a=this.settings.minUserZoom:this.settings.maxUserZoom!==0&&a>this.settings.maxUserZoom&&(a=this.settings.maxUserZoom),a},setStartingScaleAndRotation:function(a,b){this.transformSettings.startingScale=this.getScale(a),this.transformSettings.startingRotation=(this.transformSettings.startingRotation+b)%360},zoomRotate:function(a,b){this.transformSettings.scale=this.getScale(a),this.transformSettings.rotation=this.transformSettings.startingRotation+b,this.applyTransform()},panStart:function(a){this.setStartingTranslateFromCurrentTransform(),this.panStartingPoint={x:a.x,y:a.y}},pan:function(a){var b=(a.y-this.panStartingPoint.y)/this.transformSettings.scale;this.transformSettings.translateX=this.transformSettings.startingTranslateX+(a.x-this.panStartingPoint.x)/this.transformSettings.scale,this.transformSettings.translateY=this.transformSettings.startingTranslateY+b,this.applyTransform()},zoomAndPanToPoint:function(b,d){if(this.settings.target===a){this.panStart({x:c.DOM.windowWidth()/2,y:c.DOM.windowHeight()/2});var f=(d.y-this.panStartingPoint.y)/this.transformSettings.scale;this.transformSettings.translateX=(this.transformSettings.startingTranslateX+(d.x-this.panStartingPoint.x)/this.transformSettings.scale)*-1,this.transformSettings.translateY=(this.transformSettings.startingTranslateY+f)*-1}this.setStartingScaleAndRotation(b,0),this.transformSettings.scale=this.transformSettings.startingScale,this.transformSettings.rotation=0,this.applyTransform()},applyTransform:function(){var b=this.transformSettings.rotation%360,f=a.parseInt(this.transformSettings.translateX,10),g=a.parseInt(this.transformSettings.translateY,10),h="scale("+this.transformSettings.scale+") rotate("+b+"deg) translate("+f+"px, "+g+"px)";c.DOM.setStyle(this.transformEl,{webkitTransform:h,MozTransform:h,msTransform:h,transform:h}),c.Events.fire(this,{target:this,type:d.ZoomPanRotate.EventTypes.onTransform,scale:this.transformSettings.scale,rotation:this.transformSettings.rotation,rotationDegs:b,translateX:f,translateY:g})}})}(window,window.klass,window.Code.Util),function(a,b){b.registerNamespace("Code.PhotoSwipe");var c=a.Code.PhotoSwipe;c.CssClasses={buildingBody:"ps-building",activeBody:"ps-active"},c.EventTypes={onBeforeShow:"PhotoSwipeOnBeforeShow",onShow:"PhotoSwipeOnShow",onBeforeHide:"PhotoSwipeOnBeforeHide",onHide:"PhotoSwipeOnHide",onDisplayImage:"PhotoSwipeOnDisplayImage",onResetPosition:"PhotoSwipeOnResetPosition",onSlideshowStart:"PhotoSwipeOnSlideshowStart",onSlideshowStop:"PhotoSwipeOnSlideshowStop",onTouch:"PhotoSwipeOnTouch",onBeforeCaptionAndToolbarShow:"PhotoSwipeOnBeforeCaptionAndToolbarShow",onCaptionAndToolbarShow:"PhotoSwipeOnCaptionAndToolbarShow",onBeforeCaptionAndToolbarHide:"PhotoSwipeOnBeforeCaptionAndToolbarHide",onCaptionAndToolbarHide:"PhotoSwipeOnCaptionAndToolbarHide",onToolbarTap:"PhotoSwipeOnToolbarTap",onBeforeZoomPanRotateShow:"PhotoSwipeOnBeforeZoomPanRotateShow",onZoomPanRotateShow:"PhotoSwipeOnZoomPanRotateShow",onBeforeZoomPanRotateHide:"PhotoSwipeOnBeforeZoomPanRotateHide",onZoomPanRotateHide:"PhotoSwipeOnZoomPanRotateHide",onZoomPanRotateTransform:"PhotoSwipeOnZoomPanRotateTransform"},c.instances=[],c.activeInstances=[],c.setActivateInstance=function(a){if(b.arrayIndexOf(a.settings.target,c.activeInstances,"target")>-1)throw"Code.PhotoSwipe.activateInstance: Unable to active instance as another instance is already active for this target";c.activeInstances.push({target:a.settings.target,instance:a})},c.unsetActivateInstance=function(a){a=b.arrayIndexOf(a,c.activeInstances,"instance"),c.activeInstances.splice(a,1)},c.attach=function(a,d,e){var f,g;f=c.createInstance(a,d,e),d=0;for(e=a.length;d<e;d++)if(g=a[d],!b.isNothing(g.nodeType)&&g.nodeType===1)g.__photoSwipeClickHandler=c.onTriggerElementClick.bind(f),b.Events.remove(g,"click",g.__photoSwipeClickHandler),b.Events.add(g,"click",g.__photoSwipeClickHandler);return f},a.jQuery&&(a.jQuery.fn.photoSwipe=function(a,b){return c.attach(this,a,b)}),c.detatch=function(a){var d,e,f;d=0;for(e=a.originalImages.length;d<e;d++)f=a.originalImages[d],!b.isNothing(f.nodeType)&&f.nodeType===1&&(b.Events.remove(f,"click",f.__photoSwipeClickHandler),delete f.__photoSwipeClickHandler);c.disposeInstance(a)},c.createInstance=function(a,d,e){var f;if(b.isNothing(a))throw"Code.PhotoSwipe.attach: No images passed.";if(!b.isLikeArray(a))throw"Code.PhotoSwipe.createInstance: Images must be an array of elements or image urls.";if(a.length<1)throw"Code.PhotoSwipe.createInstance: No images to passed.";d=b.coalesce(d,{}),f=c.getInstance(e);if(b.isNothing(f))f=new c.PhotoSwipeClass(a,d,e),c.instances.push(f);else throw'Code.PhotoSwipe.createInstance: Instance with id "'+e+' already exists."';return f},c.disposeInstance=function(a){var b=c.getInstanceIndex(a);if(b<0)throw"Code.PhotoSwipe.disposeInstance: Unable to find instance to dispose.";a.dispose(),c.instances.splice(b,1)},c.onTriggerElementClick=function(a){a.preventDefault(),this.show(a.currentTarget)},c.getInstance=function(a){var b,d,e;b=0;for(d=c.instances.length;b<d;b++)if(e=c.instances[b],e.id===a)return e;return null},c.getInstanceIndex=function(a){var b,d,e=-1;b=0;for(d=c.instances.length;b<d;b++)if(c.instances[b]===a){e=b;break}return e}}(window,window.Code.Util),function(a,b,c,d,e,f,g,h,i){c.registerNamespace("Code.PhotoSwipe");var j=a.Code.PhotoSwipe;j.PhotoSwipeClass=b({id:null,settings:null,isBackEventSupported:null,backButtonClicked:null,currentIndex:null,originalImages:null,mouseWheelStartTime:null,windowDimensions:null,cache:null,documentOverlay:null,carousel:null,uiLayer:null,toolbar:null,zoomPanRotate:null,windowOrientationChangeHandler:null,windowScrollHandler:null,windowHashChangeHandler:null,keyDownHandler:null,windowOrientationEventName:null,uiLayerTouchHandler:null,carouselSlideByEndHandler:null,carouselSlideshowStartHandler:null,carouselSlideshowStopHandler:null,toolbarTapHandler:null,toolbarBeforeShowHandler:null,toolbarShowHandler:null,toolbarBeforeHideHandler:null,toolbarHideHandler:null,mouseWheelHandler:null,zoomPanRotateTransformHandler:null,_isResettingPosition:null,_uiWebViewResetPositionTimeout:null,dispose:function(){var a;c.Events.remove(this,j.EventTypes.onBeforeShow),c.Events.remove(this,j.EventTypes.onShow),c.Events.remove(this,j.EventTypes.onBeforeHide),c.Events.remove(this,j.EventTypes.onHide),c.Events.remove(this,j.EventTypes.onDisplayImage),c.Events.remove(this,j.EventTypes.onResetPosition),c.Events.remove(this,j.EventTypes.onSlideshowStart),c.Events.remove(this,j.EventTypes.onSlideshowStop),c.Events.remove(this,j.EventTypes.onTouch),c.Events.remove(this,j.EventTypes.onBeforeCaptionAndToolbarShow),c.Events.remove(this,j.EventTypes.onCaptionAndToolbarShow),c.Events.remove(this,j.EventTypes.onBeforeCaptionAndToolbarHide),c.Events.remove(this,j.EventTypes.onCaptionAndToolbarHide),c.Events.remove(this,j.EventTypes.onZoomPanRotateTransform),this.removeEventHandlers(),c.isNothing(this.documentOverlay)||this.documentOverlay.dispose(),c.isNothing(this.carousel)||this.carousel.dispose(),c.isNothing(this.uiLayer)||this.uiLayer.dispose(),c.isNothing(this.toolbar)||this.toolbar.dispose(),this.destroyZoomPanRotate(),c.isNothing(this.cache)||this.cache.dispose();for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,e,f){this.id=c.isNothing(f)?"PhotoSwipe"+(new Date).getTime().toString():f,this.originalImages=b,c.Browser.android&&a.navigator.userAgent.match(/Android (\d+.\d+)/).toString().replace(/^.*\,/,"")>=2.1&&(this.isBackEventSupported=!0),this.isBackEventSupported||(this.isBackEventSupported=c.objectHasProperty(a,"onhashchange")),this.settings={fadeInSpeed:250,fadeOutSpeed:250,preventHide:!1,preventSlideshow:!1,zIndex:1e3,backButtonHideEnabled:!0,enableKeyboard:!0,enableMouseWheel:!0,mouseWheelSpeed:350,autoStartSlideshow:!1,jQueryMobile:!c.isNothing(a.jQuery)&&!c.isNothing(a.jQuery.mobile),jQueryMobileDialogHash:"&ui-state=dialog",enableUIWebViewRepositionTimeout:!1,uiWebViewResetPositionDelay:500,target:a,preventDefaultTouchEvents:!0,loop:!0,slideSpeed:250,nextPreviousSlideSpeed:0,enableDrag:!0,swipeThreshold:50,swipeTimeThreshold:250,slideTimingFunction:"ease-out",slideshowDelay:3e3,doubleTapSpeed:250,margin:20,imageScaleMethod:"fit",captionAndToolbarHide:!1,captionAndToolbarFlipPosition:!1,captionAndToolbarAutoHideDelay:5e3,captionAndToolbarOpacity:.8,captionAndToolbarShowEmptyCaptions:!0,getToolbar:j.Toolbar.getToolbar,allowUserZoom:!0,allowRotationOnUserZoom:!1,maxUserZoom:5,minUserZoom:.5,doubleTapZoomLevel:2.5,getImageSource:j.Cache.Functions.getImageSource,getImageCaption:j.Cache.Functions.getImageCaption,getImageMetaData:j.Cache.Functions.getImageMetaData,cacheMode:j.Cache.Mode.normal},c.extend(this.settings,e),this.settings.target!==a&&(e=c.DOM.getStyle(this.settings.target,"position"),(e!=="relative"||e!=="absolute")&&c.DOM.setStyle(this.settings.target,"position","relative")),this.settings.target!==a?(this.isBackEventSupported=!1,this.settings.backButtonHideEnabled=!1):this.settings.preventHide&&(this.settings.backButtonHideEnabled=!1),this.cache=new d.CacheClass(b,this.settings)},show:function(b){var d,e;this.backButtonClicked=this._isResettingPosition=!1;if(c.isNumber(b))this.currentIndex=b;else{this.currentIndex=-1,d=0;for(e=this.originalImages.length;d<e;d++)if(this.originalImages[d]===b){this.currentIndex=d;break}}if(this.currentIndex<0||this.currentIndex>this.originalImages.length-1)throw"Code.PhotoSwipe.PhotoSwipeClass.show: Starting index out of range";this.isAlreadyGettingPage=this.getWindowDimensions(),j.setActivateInstance(this),this.windowDimensions=this.getWindowDimensions(),this.settings.target===a?c.DOM.addClass(a.document.body,j.CssClasses.buildingBody):c.DOM.addClass(this.settings.target,j.CssClasses.buildingBody),this.createComponents(),c.Events.fire(this,{type:j.EventTypes.onBeforeShow,target:this}),this.documentOverlay.fadeIn(this.settings.fadeInSpeed,this.onDocumentOverlayFadeIn.bind(this))},getWindowDimensions:function(){return{width:c.DOM.windowWidth(),height:c.DOM.windowHeight()}},createComponents:function(){this.documentOverlay=new e.DocumentOverlayClass(this.settings),this.carousel=new f.CarouselClass(this.cache,this.settings),this.uiLayer=new h.UILayerClass(this.settings),this.settings.captionAndToolbarHide||(this.toolbar=new g.ToolbarClass(this.cache,this.settings))},resetPosition:function(){if(!this._isResettingPosition){var a=this.getWindowDimensions();if(c.isNothing(this.windowDimensions)||a.width!==this.windowDimensions.width||a.height!==this.windowDimensions.height)this._isResettingPosition=!0,this.windowDimensions=a,this.destroyZoomPanRotate(),this.documentOverlay.resetPosition(),this.carousel.resetPosition(),c.isNothing(this.toolbar)||this.toolbar.resetPosition(),this.uiLayer.resetPosition(),this._isResettingPosition=!1,c.Events.fire(this,{type:j.EventTypes.onResetPosition,target:this})}},addEventHandler:function(a,b){c.Events.add(this,a,b)},addEventHandlers:function(){c.isNothing(this.windowOrientationChangeHandler)&&(this.windowOrientationChangeHandler=this.onWindowOrientationChange.bind(this),this.windowScrollHandler=this.onWindowScroll.bind(this),this.keyDownHandler=this.onKeyDown.bind(this),this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.uiLayerTouchHandler=this.onUILayerTouch.bind(this),this.carouselSlideByEndHandler=this.onCarouselSlideByEnd.bind(this),this.carouselSlideshowStartHandler=this.onCarouselSlideshowStart.bind(this),this.carouselSlideshowStopHandler=this.onCarouselSlideshowStop.bind(this),this.toolbarTapHandler=this.onToolbarTap.bind(this),this.toolbarBeforeShowHandler=this.onToolbarBeforeShow.bind(this),this.toolbarShowHandler=this.onToolbarShow.bind(this),this.toolbarBeforeHideHandler=this.onToolbarBeforeHide.bind(this),this.toolbarHideHandler=this.onToolbarHide.bind(this),this.mouseWheelHandler=this.onMouseWheel.bind(this),this.zoomPanRotateTransformHandler=this.onZoomPanRotateTransform.bind(this)),c.Browser.android?this.orientationEventName="resize":c.Browser.iOS&&!c.Browser.safari?c.Events.add(a.document.body,"orientationchange",this.windowOrientationChangeHandler):this.orientationEventName=c.isNothing(a.onorientationchange)?"resize":"orientationchange",c.isNothing(this.orientationEventName)||c.Events.add(a,this.orientationEventName,this.windowOrientationChangeHandler),this.settings.target===a&&c.Events.add(a,"scroll",this.windowScrollHandler),this.settings.enableKeyboard&&c.Events.add(a.document,"keydown",this.keyDownHandler),this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.settings.jQueryMobile?a.location.hash=this.settings.jQueryMobileDialogHash:(this.currentHistoryHashValue="PhotoSwipe"+(new Date).getTime().toString(),a.location.hash=this.currentHistoryHashValue),c.Events.add(a,"hashchange",this.windowHashChangeHandler)),this.settings.enableMouseWheel&&c.Events.add(a,"mousewheel",this.mouseWheelHandler),c.Events.add(this.uiLayer,c.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler),c.Events.add(this.carousel,f.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),c.Events.add(this.carousel,f.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),c.Events.add(this.carousel,f.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler),c.isNothing(this.toolbar)||(c.Events.add(this.toolbar,g.EventTypes.onTap,this.toolbarTapHandler),c.Events.add(this.toolbar,g.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),c.Events.add(this.toolbar,g.EventTypes.onShow,this.toolbarShowHandler),c.Events.add(this.toolbar,g.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),c.Events.add(this.toolbar,g.EventTypes.onHide,this.toolbarHideHandler))},removeEventHandlers:function(){c.Browser.iOS&&!c.Browser.safari&&c.Events.remove(a.document.body,"orientationchange",this.windowOrientationChangeHandler),c.isNothing(this.orientationEventName)||c.Events.remove(a,this.orientationEventName,this.windowOrientationChangeHandler),c.Events.remove(a,"scroll",this.windowScrollHandler),this.settings.enableKeyboard&&c.Events.remove(a.document,"keydown",this.keyDownHandler),this.isBackEventSupported&&this.settings.backButtonHideEnabled&&c.Events.remove(a,"hashchange",this.windowHashChangeHandler),this.settings.enableMouseWheel&&c.Events.remove(a,"mousewheel",this.mouseWheelHandler),c.isNothing(this.uiLayer)||c.Events.remove(this.uiLayer,c.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler),c.isNothing(this.toolbar)||(c.Events.remove(this.carousel,f.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),c.Events.remove(this.carousel,f.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),c.Events.remove(this.carousel,f.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler)),c.isNothing(this.toolbar)||(c.Events.remove(this.toolbar,g.EventTypes.onTap,this.toolbarTapHandler),c.Events.remove(this.toolbar,g.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),c.Events.remove(this.toolbar,g.EventTypes.onShow,this.toolbarShowHandler),c.Events.remove(this.toolbar,g.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),c.Events.remove(this.toolbar,g.EventTypes.onHide,this.toolbarHideHandler))},hide:function(){if(!this.settings.preventHide){if(c.isNothing(this.documentOverlay))throw"Code.PhotoSwipe.PhotoSwipeClass.hide: PhotoSwipe instance is already hidden";c.isNothing(this.hiding)&&(this.clearUIWebViewResetPositionTimeout(),this.destroyZoomPanRotate(),this.removeEventHandlers(),c.Events.fire(this,{type:j.EventTypes.onBeforeHide,target:this}),this.uiLayer.dispose(),this.uiLayer=null,c.isNothing(this.toolbar)||(this.toolbar.dispose(),this.toolbar=null),this.carousel.dispose(),this.carousel=null,c.DOM.removeClass(a.document.body,j.CssClasses.activeBody),this.documentOverlay.dispose(),this.documentOverlay=null,this._isResettingPosition=!1,j.unsetActivateInstance(this),c.Events.fire(this,{type:j.EventTypes.onHide,target:this}),this.goBackInHistory())}},goBackInHistory:function(){this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.backButtonClicked||a.history.back())},play:function(){!this.isZoomActive()&&!this.settings.preventSlideshow&&!c.isNothing(this.carousel)&&(!c.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut(),this.carousel.startSlideshow())},stop:function(){this.isZoomActive()||c.isNothing(this.carousel)||this.carousel.stopSlideshow()},previous:function(){this.isZoomActive()||c.isNothing(this.carousel)||this.carousel.previous()},next:function(){this.isZoomActive()||c.isNothing(this.carousel)||this.carousel.next()},toggleToolbar:function(){this.isZoomActive()||c.isNothing(this.toolbar)||this.toolbar.toggleVisibility(this.currentIndex)},fadeOutToolbarIfVisible:function(){!c.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.settings.captionAndToolbarAutoHideDelay>0&&this.toolbar.fadeOut()},createZoomPanRotate:function(){this.stop(),this.canUserZoom()&&!this.isZoomActive()&&(c.Events.fire(this,j.EventTypes.onBeforeZoomPanRotateShow),this.zoomPanRotate=new i.ZoomPanRotateClass(this.settings,this.cache.images[this.currentIndex],this.uiLayer),this.uiLayer.captureSettings.preventDefaultTouchEvents=!0,c.Events.add(this.zoomPanRotate,j.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),c.Events.fire(this,j.EventTypes.onZoomPanRotateShow),!c.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut())},destroyZoomPanRotate:function(){c.isNothing(this.zoomPanRotate)||(c.Events.fire(this,j.EventTypes.onBeforeZoomPanRotateHide),c.Events.remove(this.zoomPanRotate,j.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),this.zoomPanRotate.dispose(),this.zoomPanRotate=null,this.uiLayer.captureSettings.preventDefaultTouchEvents=this.settings.preventDefaultTouchEvents,c.Events.fire(this,j.EventTypes.onZoomPanRotateHide))},canUserZoom:function(){var a;if(c.Browser.msie){if(a=document.createElement("div"),c.isNothing(a.style.msTransform))return!1}else if(!c.Browser.isCSSTransformSupported)return!1;return this.settings.allowUserZoom?this.carousel.isSliding?!1:(a=this.cache.images[this.currentIndex],c.isNothing(a)?!1:a.isLoading?!1:!0):!1},isZoomActive:function(){return!c.isNothing(this.zoomPanRotate)},getCurrentImage:function(){return this.cache.images[this.currentIndex]},onDocumentOverlayFadeIn:function(){a.setTimeout(function(){var b=this.settings.target===a?a.document.body:this.settings.target;c.DOM.removeClass(b,j.CssClasses.buildingBody),c.DOM.addClass(b,j.CssClasses.activeBody),this.addEventHandlers(),this.carousel.show(this.currentIndex),this.uiLayer.show(),this.settings.autoStartSlideshow?this.play():c.isNothing(this.toolbar)||this.toolbar.show(this.currentIndex),c.Events.fire(this,{type:j.EventTypes.onShow,target:this}),this.setUIWebViewResetPositionTimeout()}.bind(this),250)},setUIWebViewResetPositionTimeout:function(){this.settings.enableUIWebViewRepositionTimeout&&c.Browser.iOS&&!c.Browser.safari&&(c.isNothing(this._uiWebViewResetPositionTimeout)||a.clearTimeout(this._uiWebViewResetPositionTimeout),this._uiWebViewResetPositionTimeout=a.setTimeout(function(){this.resetPosition(),this.setUIWebViewResetPositionTimeout()}.bind(this),this.settings.uiWebViewResetPositionDelay))},clearUIWebViewResetPositionTimeout:function(){c.isNothing(this._uiWebViewResetPositionTimeout)||a.clearTimeout(this._uiWebViewResetPositionTimeout)},onWindowScroll:function(){this.resetPosition()},onWindowOrientationChange:function(){this.resetPosition()},onWindowHashChange:function(){a.location.hash!=="#"+(this.settings.jQueryMobile?this.settings.jQueryMobileDialogHash:this.currentHistoryHashValue)&&(this.backButtonClicked=!0,this.hide())},onKeyDown:function(a){a.keyCode===37?(a.preventDefault(),this.previous()):a.keyCode===39?(a.preventDefault(),this.next()):a.keyCode===38||a.keyCode===40?a.preventDefault():a.keyCode===27?(a.preventDefault(),this.hide()):a.keyCode===32?(this.settings.hideToolbar?this.hide():this.toggleToolbar(),a.preventDefault()):a.keyCode===13&&(a.preventDefault(),this.play())},onUILayerTouch:function(b){if(this.isZoomActive())switch(b.action){case c.TouchElement.ActionTypes.gestureChange:this.zoomPanRotate.zoomRotate(b.scale,this.settings.allowRotationOnUserZoom?b.rotation:0);break;case c.TouchElement.ActionTypes.gestureEnd:this.zoomPanRotate.setStartingScaleAndRotation(b.scale,this.settings.allowRotationOnUserZoom?b.rotation:0);break;case c.TouchElement.ActionTypes.touchStart:this.zoomPanRotate.panStart(b.point);break;case c.TouchElement.ActionTypes.touchMove:this.zoomPanRotate.pan(b.point);break;case c.TouchElement.ActionTypes.doubleTap:this.destroyZoomPanRotate(),this.toggleToolbar();break;case c.TouchElement.ActionTypes.swipeLeft:this.destroyZoomPanRotate(),this.next(),this.toggleToolbar();break;case c.TouchElement.ActionTypes.swipeRight:this.destroyZoomPanRotate(),this.previous(),this.toggleToolbar()}else switch(b.action){case c.TouchElement.ActionTypes.touchMove:case c.TouchElement.ActionTypes.swipeLeft:case c.TouchElement.ActionTypes.swipeRight:this.fadeOutToolbarIfVisible(),this.carousel.onTouch(b.action,b.point);break;case c.TouchElement.ActionTypes.touchStart:case c.TouchElement.ActionTypes.touchMoveEnd:this.carousel.onTouch(b.action,b.point);break;case c.TouchElement.ActionTypes.tap:this.toggleToolbar();break;case c.TouchElement.ActionTypes.doubleTap:this.settings.target===a&&(b.point.x-=c.DOM.windowScrollLeft(),b.point.y-=c.DOM.windowScrollTop());var d=this.cache.images[this.currentIndex].imageEl,e=a.parseInt(c.DOM.getStyle(d,"top"),10),f=a.parseInt(c.DOM.getStyle(d,"left"),10),g=f+c.DOM.width(d),d=e+c.DOM.height(d);b.point.x<f?b.point.x=f:b.point.x>g&&(b.point.x=g),b.point.y<e?b.point.y=e:b.point.y>d&&(b.point.y=d),this.createZoomPanRotate(),this.isZoomActive()&&this.zoomPanRotate.zoomAndPanToPoint(this.settings.doubleTapZoomLevel,b.point);break;case c.TouchElement.ActionTypes.gestureStart:this.createZoomPanRotate()}c.Events.fire(this,{type:j.EventTypes.onTouch,target:this,point:b.point,action:b.action})},onCarouselSlideByEnd:function(a){this.currentIndex=a.cacheIndex,c.isNothing(this.toolbar)||(this.toolbar.setCaption(this.currentIndex),this.toolbar.setToolbarStatus(this.currentIndex)),c.Events.fire(this,{type:j.EventTypes.onDisplayImage,target:this,action:a.action,index:a.cacheIndex})},onToolbarTap:function(a){switch(a.action){case g.ToolbarAction.next:this.next();break;case g.ToolbarAction.previous:this.previous();break;case g.ToolbarAction.close:this.hide();break;case g.ToolbarAction.play:this.play()}c.Events.fire(this,{type:j.EventTypes.onToolbarTap,target:this,toolbarAction:a.action,tapTarget:a.tapTarget})},onMouseWheel:function(a){var b=c.Events.getWheelDelta(a);a.timeStamp-(this.mouseWheelStartTime||0)<this.settings.mouseWheelSpeed||(this.mouseWheelStartTime=a.timeStamp,this.settings.invertMouseWheel&&(b*=-1),b<0?this.next():b>0&&this.previous())},onCarouselSlideshowStart:function(){c.Events.fire(this,{type:j.EventTypes.onSlideshowStart,target:this})},onCarouselSlideshowStop:function(){c.Events.fire(this,{type:j.EventTypes.onSlideshowStop,target:this})},onToolbarBeforeShow:function(){c.Events.fire(this,{type:j.EventTypes.onBeforeCaptionAndToolbarShow,target:this})},onToolbarShow:function(){c.Events.fire(this,{type:j.EventTypes.onCaptionAndToolbarShow,target:this})},onToolbarBeforeHide:function(){c.Events.fire(this,{type:j.EventTypes.onBeforeCaptionAndToolbarHide,target:this})},onToolbarHide:function(){c.Events.fire(this,{type:j.EventTypes.onCaptionAndToolbarHide,target:this})},onZoomPanRotateTransform:function(a){c.Events.fire(this,{target:this,type:j.EventTypes.onZoomPanRotateTransform,scale:a.scale,rotation:a.rotation,rotationDegs:a.rotationDegs,translateX:a.translateX,translateY:a.translateY})}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Cache,window.Code.PhotoSwipe.DocumentOverlay,window.Code.PhotoSwipe.Carousel,window.Code.PhotoSwipe.Toolbar,window.Code.PhotoSwipe.UILayer,window.Code.PhotoSwipe.ZoomPanRotate),define("vendor/photoswipe",function(){}),1,function(){var a;typeof Joshfire=="undefined"&&(Joshfire={}),a={version:[0,9,3],onReady:function(a){a()},adapter:"ios",adapterModules:{android:["app","dependencies.json","inputs/touch","ui/toolbar","uielements/list","uielements/panel","uielements/video.mediaelement","vendor/iscroll"],browser:["app","inputs/http","inputs/keyboard","inputs/mouse","uielement","uielements/list","uielements/mediacontrols","uielements/page","uielements/panel","uielements/panel.manager","uielements/video.mediaelement","uielements/video.popup","uielements/video.youtube.swf","utils/activitymonitor","utils/datasource","utils/dollar","utils/localstorage","utils/navigation","utils/onready","utils/stresstest"],googletv:["dependencies.json","inputs/keyboard","ui/videoplayer","uielement"],ios:["dependencies.json"],lgtv:["dependencies.json","ui/videoplayer","uielement","utils/dollar"],node:["app.factory","app","class","global.exec","inputs/http","uielements/page","uielements/panel","uielements/panel.manager","uielements/video.mediaelement","utils/datasource","utils/dollar","utils/eventsocket","utils/templatecompiler.cli","utils/templatecompiler","vendor/json2","view"],none:[],philips:["dependencies.json","ui/videoplayer","uielement","uielements/list","uielements/video.mediaelement","utils/dollar","utils/stresstest"],phone:["collection","ui/toolbar","uielement","utils/dollar","utils/onready"],qt4:[],samsungtv:["dependencies.json","inputs/remote","ui/cardpanel","ui/grid","ui/horizontallayout","ui/slidepanel","ui/toolbar","ui/verticallist","ui/videoplayer","uielement","utils/dollar","utils/onready","utils/widgetapi","view"],tv:["inputs/remote","ui/cardpanel","ui/grid","ui/horizontallayout","ui/slidepanel","ui/toolbar","ui/verticallist","ui/videoplayer","uielement","utils/dollar","utils/onready"]},adapterDeps:["phone"],debug:!1,path:(Joshfire.framework||{}).path||"joshfire"};if(typeof document!="undefined"){var b=document.getElementsByTagName("script"),c,d=new RegExp("^(.*)/adapters/"+a.adapter+"/bootstrap.js$");for(var e=b.length-1;e>=0;e--)c=d.exec(b[e].getAttribute("src")),c&&(a.path=c[1])}typeof require!="undefined"&&require.config&&require.config({paths:{"joshfire-framework":a.path},urlArgs:Joshfire.debug?"bust="+(new Date).getTime():""}),Joshfire.framework=a,typeof module!="undefined"&&module.exports&&(module.exports.JoshfireFramework=a)}.call(this),function(a){a.onReady=function(b){a.require(["joshfire/vendor/zepto"],function(a){b.call()})}}(Joshfire),define("joshlib",{normalize:function(a,b){var c=[Joshfire.framework.adapter].concat(Joshfire.framework.adapterDeps),d=Joshfire.framework.adapterModules,e="joshfire-framework/";if(a.substring(0,14)=="adapters/none/")return e+a.substring(14);if(a.substring(0,9)=="adapters/")return e+a;for(var f=0;f<c.length;f++)for(var g=0;g<d[c[f]].length;g++)if(a==d[c[f]][g])return e+"adapters/"+c[f]+"/"+a;return e+a},load:function(a,b,c,d){b([a],function(a){c(a)})}}),define("joshfire-framework/adapters/phone/utils/onready",[],function(){return function(a){/complete|loaded|interactive/.test(document.readyState)&&a(),document.addEventListener("DOMContentLoaded",a,!1)}}),define("joshfire-framework/vendor/iscroll",[],function(){return function(){var a=Math,b=function(a){return a>>0},c=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in window?"O":"",d=/android/gi.test(navigator.appVersion),e=/iphone|ipad/gi.test(navigator.appVersion),f=/playbook/gi.test(navigator.appVersion),g=/hp-tablet/gi.test(navigator.appVersion),h="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,i="ontouchstart"in window&&!g,j=c+"Transform"in document.documentElement.style,k=e||f,l=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,1)}}(),m=function(){return window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}(),n="resize",o=i?"touchstart":"mousedown",p=i?"touchmove":"mousemove",q=i?"touchend":"mouseup",r=i?"touchcancel":"mouseup",s=c=="Moz"?"DOMMouseScroll":"mousewheel",t="translate"+(h?"3d(":"("),u=h?",0)":")",v=function(a,b){var f=this,g=document,l;f.wrapper=typeof a=="object"?a:g.getElementById(a),f.wrapper.style.overflow="hidden",f.scroller=f.wrapper.children[0],f.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:d,hideScrollbar:e,fadeScrollbar:e&&h,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(l in b)f.options[l]=b[l];f.x=f.options.x,f.y=f.options.y,f.options.useTransform=j?f.options.useTransform:!1,f.options.hScrollbar=f.options.hScroll&&f.options.hScrollbar,f.options.vScrollbar=f.options.vScroll&&f.options.vScrollbar,f.options.zoom=f.options.useTransform&&f.options.zoom,f.options.useTransition=k&&f.options.useTransition,f.options.zoom&&d&&(t="translate(",u=")"),f.scroller.style[c+"TransitionProperty"]=f.options.useTransform?"-"+c.toLowerCase()+"-transform":"top left",f.scroller.style[c+"TransitionDuration"]="0",f.scroller.style[c+"TransformOrigin"]="0 0",f.options.useTransition&&(f.scroller.style[c+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)"),f.options.useTransform?f.scroller.style[c+"Transform"]=t+f.x+"px,"+f.y+"px"+u:f.scroller.style.cssText+=";position:absolute;top:"+f.y+"px;left:"+f.x+"px",f.options.useTransition&&(f.options.fixedScrollbar=!0),f.refresh(),f._bind(n,window),f._bind(o),i||(f._bind("mouseout",f.wrapper),f.options.wheelAction!="none"&&f._bind(s)),f.options.checkDOMChanges&&(f.checkDOMTime=setInterval(function(){f._checkDOMChanges()},500))};v.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(a){var b=this;switch(a.type){case o:if(!i&&a.button!==0)return;b._start(a);break;case p:b._move(a);break;case q:case r:b._end(a);break;case n:b._resize();break;case s:b._wheel(a);break;case"mouseout":b._mouseout(a);break;case"webkitTransitionEnd":b._transitionEnd(a)}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(d){var e=this,f=document,g;if(!e[d+"Scrollbar"]){e[d+"ScrollbarWrapper"]&&(j&&(e[d+"ScrollbarIndicator"].style[c+"Transform"]=""),e[d+"ScrollbarWrapper"].parentNode&&e[d+"ScrollbarWrapper"].parentNode.removeChild(e[d+"ScrollbarWrapper"]),e[d+"ScrollbarWrapper"]=null,e[d+"ScrollbarIndicator"]=null);return}e[d+"ScrollbarWrapper"]||(g=f.createElement("div"),e.options.scrollbarClass?g.className=e.options.scrollbarClass+d.toUpperCase():g.style.cssText="position:absolute;z-index:100;"+(d=="h"?"height:7px;bottom:1px;left:2px;right:"+(e.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(e.hScrollbar?"7":"2")+"px;top:2px;right:1px"),g.style.cssText+=";pointer-events:none;-"+c+"-transition-property:opacity;-"+c+"-transition-duration:"+(e.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(e.options.hideScrollbar?"0":"1"),e.wrapper.appendChild(g),e[d+"ScrollbarWrapper"]=g,g=f.createElement("div"),e.options.scrollbarClass||(g.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+c+"-background-clip:padding-box;-"+c+"-box-sizing:border-box;"+(d=="h"?"height:100%":"width:100%")+";-"+c+"-border-radius:3px;border-radius:3px"),g.style.cssText+=";pointer-events:none;-"+c+"-transition-property:-"+c+"-transform;-"+c+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+c+"-transition-duration:0;-"+c+"-transform:"+t+"0,0"+u,e.options.useTransition&&(g.style.cssText+=";-"+c+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),e[d+"ScrollbarWrapper"].appendChild(g),e[d+"ScrollbarIndicator"]=g),d=="h"?(e.hScrollbarSize=e.hScrollbarWrapper.clientWidth,e.hScrollbarIndicatorSize=a.max(b(e.hScrollbarSize*e.hScrollbarSize/e.scrollerW),8),e.hScrollbarIndicator.style.width=e.hScrollbarIndicatorSize+"px",e.hScrollbarMaxScroll=e.hScrollbarSize-e.hScrollbarIndicatorSize,e.hScrollbarProp=e.hScrollbarMaxScroll/e.maxScrollX):(e.vScrollbarSize=e.vScrollbarWrapper.clientHeight,e.vScrollbarIndicatorSize=a.max(b(e.vScrollbarSize*e.vScrollbarSize/e.scrollerH),8),e.vScrollbarIndicator.style.height=e.vScrollbarIndicatorSize+"px",e.vScrollbarMaxScroll=e.vScrollbarSize-e.vScrollbarIndicatorSize,e.vScrollbarProp=e.vScrollbarMaxScroll/e.maxScrollY),e._scrollbarPos(d,!0)},_resize:function(){var a=this;setTimeout(function(){a.refresh()},d?200:0)},_pos:function(a,d){a=this.hScroll?a:0,d=this.vScroll?d:0,this.options.useTransform?this.scroller.style[c+"Transform"]=t+a+"px,"+d+"px"+u+" scale("+this.scale+")":(a=b(a),d=b(d),this.scroller.style.left=a+"px",this.scroller.style.top=d+"px"),this.x=a,this.y=d,this._scrollbarPos("h"),this._scrollbarPos("v")},_scrollbarPos:function(a,d){var e=this,f=a=="h"?e.x:e.y,g;if(!e[a+"Scrollbar"])return;f=e[a+"ScrollbarProp"]*f,f<0?(e.options.fixedScrollbar||(g=e[a+"ScrollbarIndicatorSize"]+b(f*3),g<8&&(g=8),e[a+"ScrollbarIndicator"].style[a=="h"?"width":"height"]=g+"px"),f=0):f>e[a+"ScrollbarMaxScroll"]&&(e.options.fixedScrollbar?f=e[a+"ScrollbarMaxScroll"]:(g=e[a+"ScrollbarIndicatorSize"]-b((f-e[a+"ScrollbarMaxScroll"])*3),g<8&&(g=8),e[a+"ScrollbarIndicator"].style[a=="h"?"width":"height"]=g+"px",f=e[a+"ScrollbarMaxScroll"]+(e[a+"ScrollbarIndicatorSize"]-g))),e[a+"ScrollbarWrapper"].style[c+"TransitionDelay"]="0",e[a+"ScrollbarWrapper"].style.opacity=d&&e.options.hideScrollbar?"0":"1",e[a+"ScrollbarIndicator"].style[c+"Transform"]=t+(a=="h"?f+"px,0":"0,"+f+"px")+u},_start:function(b){var d=this,e=i?b.touches[0]:b,f,g,h,j,k;if(!d.enabled)return;d.options.onBeforeScrollStart&&d.options.onBeforeScrollStart.call(d,b),(d.options.useTransition||d.options.zoom)&&d._transitionTime(0),d.moved=!1,d.animating=!1,d.zoomed=!1,d.distX=0,d.distY=0,d.absDistX=0,d.absDistY=0,d.dirX=0,d.dirY=0,d.options.zoom&&i&&b.touches.length>1&&(j=a.abs(b.touches[0].pageX-b.touches[1].pageX),k=a.abs(b.touches[0].pageY-b.touches[1].pageY),d.touchesDistStart=a.sqrt(j*j+k*k),d.originX=a.abs(b.touches[0].pageX+b.touches[1].pageX-d.wrapperOffsetLeft*2)/2-d.x,d.originY=a.abs(b.touches[0].pageY+b.touches[1].pageY-d.wrapperOffsetTop*2)/2-d.y,d.options.onZoomStart&&d.options.onZoomStart.call(d,b));if(d.options.momentum){d.options.useTransform?(f=getComputedStyle(d.scroller,null)[c+"Transform"].replace(/[^0-9-.,]/g,"").split(","),g=f[4]*1,h=f[5]*1):(g=getComputedStyle(d.scroller,null).left.replace(/[^0-9-]/g,"")*1,h=getComputedStyle(d.scroller,null).top.replace(/[^0-9-]/g,"")*1);if(g!=d.x||h!=d.y)d.options.useTransition?d._unbind("webkitTransitionEnd"):m(d.aniTime),d.steps=[],d._pos(g,h)}d.absStartX=d.x,d.absStartY=d.y,d.startX=d.x,d.startY=d.y,d.pointX=e.pageX,d.pointY=e.pageY,d.startTime=b.timeStamp||Date.now(),d.options.onScrollStart&&d.options.onScrollStart.call(d,b),d._bind(p),d._bind(q),d._bind(r)},_move:function(b){var d=this,e=i?b.touches[0]:b,f=e.pageX-d.pointX,g=e.pageY-d.pointY,h=d.x+f,j=d.y+g,k,l,m,n=b.timeStamp||Date.now();d.options.onBeforeScrollMove&&d.options.onBeforeScrollMove.call(d,b);if(d.options.zoom&&i&&b.touches.length>1){k=a.abs(b.touches[0].pageX-b.touches[1].pageX),l=a.abs(b.touches[0].pageY-b.touches[1].pageY),d.touchesDist=a.sqrt(k*k+l*l),d.zoomed=!0,m=1/d.touchesDistStart*d.touchesDist*this.scale,m<d.options.zoomMin?m=.5*d.options.zoomMin*Math.pow(2,m/d.options.zoomMin):m>d.options.zoomMax&&(m=2*d.options.zoomMax*Math.pow(.5,d.options.zoomMax/m)),d.lastScale=m/this.scale,h=this.originX-this.originX*d.lastScale+this.x,j=this.originY-this.originY*d.lastScale+this.y,this.scroller.style[c+"Transform"]=t+h+"px,"+j+"px"+u+" scale("+m+")",d.options.onZoom&&d.options.onZoom.call(d,b);return}d.pointX=e.pageX,d.pointY=e.pageY;if(h>0||h<d.maxScrollX)h=d.options.bounce?d.x+f/2:h>=0||d.maxScrollX>=0?0:d.maxScrollX;if(j>d.minScrollY||j<d.maxScrollY)j=d.options.bounce?d.y+g/2:j>=d.minScrollY||d.maxScrollY>=0?d.minScrollY:d.maxScrollY;if(d.absDistX<6&&d.absDistY<6){d.distX+=f,d.distY+=g,d.absDistX=a.abs(d.distX),d.absDistY=a.abs(d.distY);return}d.options.lockDirection&&(d.absDistX>d.absDistY+5?(j=d.y,g=0):d.absDistY>d.absDistX+5&&(h=d.x,f=0)),d.moved=!0,d._pos(h,j),d.dirX=f>0?-1:f<0?1:0,d.dirY=g>0?-1:g<0?1:0,n-d.startTime>300&&(d.startTime=n,d.startX=d.x,d.startY=d.y),d.options.onScrollMove&&d.options.onScrollMove.call(d,b)},_end:function(d){if(i&&d.touches.length!=0)return;var e=this,f=i?d.changedTouches[0]:d,g,h,j={dist:0,time:0},k={dist:0,time:0},l=(d.timeStamp||Date.now())-e.startTime,m=e.x,n=e.y,o,s,v,w,x;e._unbind(p),e._unbind(q),e._unbind(r),e.options.onBeforeScrollEnd&&e.options.onBeforeScrollEnd.call(e,d);if(e.zoomed){x=e.scale*e.lastScale,x=Math.max(e.options.zoomMin,x),x=Math.min(e.options.zoomMax,x),e.lastScale=x/e.scale,e.scale=x,e.x=e.originX-e.originX*e.lastScale+e.x,e.y=e.originY-e.originY*e.lastScale+e.y,e.scroller.style[c+"TransitionDuration"]="200ms",e.scroller.style[c+"Transform"]=t+e.x+"px,"+e.y+"px"+u+" scale("+e.scale+")",e.zoomed=!1,e.refresh(),e.options.onZoomEnd&&e.options.onZoomEnd.call(e,d);return}if(!e.moved){i&&(e.doubleTapTimer&&e.options.zoom?(clearTimeout(e.doubleTapTimer),e.doubleTapTimer=null,e.options.onZoomStart&&e.options.onZoomStart.call(e,d),e.zoom(e.pointX,e.pointY,e.scale==1?e.options.doubleTapZoom:1),e.options.onZoomEnd&&setTimeout(function(){e.options.onZoomEnd.call(e,d)},200)):e.doubleTapTimer=setTimeout(function(){e.doubleTapTimer=null,g=f.target;while(g.nodeType!=1)g=g.parentNode;g.tagName!="SELECT"&&g.tagName!="INPUT"&&g.tagName!="TEXTAREA"&&(h=document.createEvent("MouseEvents"),h.initMouseEvent("click",!0,!0,d.view,1,f.screenX,f.screenY,f.clientX,f.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,null),h._fake=!0,g.dispatchEvent(h))},e.options.zoom?250:0)),e._resetPos(200),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,d,!1);return}if(l<300&&e.options.momentum){j=m?e._momentum(m-e.startX,l,-e.x,e.scrollerW-e.wrapperW+e.x,e.options.bounce?e.wrapperW:0):j,k=n?e._momentum(n-e.startY,l,-e.y,e.maxScrollY<0?e.scrollerH-e.wrapperH+e.y-e.minScrollY:0,e.options.bounce?e.wrapperH:0):k,m=e.x+j.dist,n=e.y+k.dist;if(e.x>0&&m>0||e.x<e.maxScrollX&&m<e.maxScrollX)j={dist:0,time:0};if(e.y>e.minScrollY&&n>e.minScrollY||e.y<e.maxScrollY&&n<e.maxScrollY)k={dist:0,time:0}}if(j.dist||k.dist){v=a.max(a.max(j.time,k.time),10),e.options.snap&&(o=m-e.absStartX,s=n-e.absStartY,a.abs(o)<e.options.snapThreshold&&a.abs(s)<e.options.snapThreshold?e.scrollTo(e.absStartX,e.absStartY,200):(w=e._snap(m,n),m=w.x,n=w.y,v=a.max(w.time,v))),e.scrollTo(b(m),b(n),v),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,d,!0);return}if(e.options.snap){o=m-e.absStartX,s=n-e.absStartY,a.abs(o)<e.options.snapThreshold&&a.abs(s)<e.options.snapThreshold?e.scrollTo(e.absStartX,e.absStartY,200):(w=e._snap(e.x,e.y),(w.x!=e.x||w.y!=e.y)&&e.scrollTo(w.x,w.y,w.time)),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,d,!0);return}e._resetPos(200),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,d,!0)},_resetPos:function(a){var b=this,d=b.x>=0?0:b.x<b.maxScrollX?b.maxScrollX:b.x,e=b.y>=b.minScrollY||b.maxScrollY>0?b.minScrollY:b.y<b.maxScrollY?b.maxScrollY:b.y;if(d==b.x&&e==b.y){b.moved=!1,b.options.onScrollEnd&&b.options.onScrollEnd.call(b),b.hScrollbar&&b.options.hideScrollbar&&(c=="webkit"&&(b.hScrollbarWrapper.style[c+"TransitionDelay"]="300ms"),b.hScrollbarWrapper.style.opacity="0"),b.vScrollbar&&b.options.hideScrollbar&&(c=="webkit"&&(b.vScrollbarWrapper.style[c+"TransitionDelay"]="300ms"),b.vScrollbarWrapper.style.opacity="0");return}b.scrollTo(d,e,a||0)},_wheel:function(a){var b=this,c,d,e,f,g;"wheelDeltaX"in a?(c=a.wheelDeltaX/12,d=a.wheelDeltaY/12):"detail"in a?c=d=-a.detail*3:c=d=-a.wheelDelta;if(b.options.wheelAction=="zoom"){g=b.scale*Math.pow(2,1/3*(d?d/Math.abs(d):0)),g<b.options.zoomMin&&(g=b.options.zoomMin),g>b.options.zoomMax&&(g=b.options.zoomMax),g!=b.scale&&(!b.wheelZoomCount&&b.options.onZoomStart&&b.options.onZoomStart.call(b,a),b.wheelZoomCount++,b.zoom(a.pageX,a.pageY,g,400),setTimeout(function(){b.wheelZoomCount--,!b.wheelZoomCount&&b.options.onZoomEnd&&b.options.onZoomEnd.call(b,a)},400));return}e=b.x+c,f=b.y+d,e>0?e=0:e<b.maxScrollX&&(e=b.maxScrollX),f>b.minScrollY?f=b.minScrollY:f<b.maxScrollY&&(f=b.maxScrollY),b.scrollTo(e,f,0)},_mouseout:function(a){var b=a.relatedTarget;if(!b){this._end(a);return}while(b=b.parentNode)if(b==this.wrapper)return;this._end(a)},_transitionEnd:function(a){var b=this;if(a.target!=b.scroller)return;b._unbind("webkitTransitionEnd"),b._startAni()},_startAni:function(){var b=this,c=b.x,d=b.y,e=Date.now(),f,g,h;if(b.animating)return;if(!b.steps.length){b._resetPos(400);return}f=b.steps.shift(),f.x==c&&f.y==d&&(f.time=0),b.animating=!0,b.moved=!0;if(b.options.useTransition){b._transitionTime(f.time),b._pos(f.x,f.y),b.animating=!1,f.time?b._bind("webkitTransitionEnd"):b._resetPos(0);return}h=function(){var i=Date.now(),j,k;if(i>=e+f.time){b._pos(f.x,f.y),b.animating=!1,b.options.onAnimationEnd&&b.options.onAnimationEnd.call(b),b._startAni();return}i=(i-e)/f.time-1,g=a.sqrt(1-i*i),j=(f.x-c)*g+c,k=(f.y-d)*g+d,b._pos(j,k),b.animating&&(b.aniTime=l(h))},h()},_transitionTime:function(a){a+="ms",this.scroller.style[c+"TransitionDuration"]=a,this.hScrollbar&&(this.hScrollbarIndicator.style[c+"TransitionDuration"]=a),this.vScrollbar&&(this.vScrollbarIndicator.style[c+"TransitionDuration"]=a)},_momentum:function(c,d,e,f,g){var h=6e-4,i=a.abs(c)/d,j=i*i/(2*h),k=0,l=0;return c>0&&j>e?(l=g/(6/(j/i*h)),e+=l,i=i*e/j,j=e):c<0&&j>f&&(l=g/(6/(j/i*h)),f+=l,i=i*f/j,j=f),j*=c<0?-1:1,k=i/h,{dist:j,time:b(k)}},_offset:function(a){var b=-a.offsetLeft,c=-a.offsetTop;while(a=a.offsetParent)b-=a.offsetLeft,c-=a.offsetTop;return a!=this.wrapper&&(b*=this.scale,c*=this.scale),{left:b,top:c}},_snap:function(c,d){var e=this,f,g,h,i,j,k;h=e.pagesX.length-1;for(f=0,g=e.pagesX.length;f<g;f++)if(c>=e.pagesX[f]){h=f;break}h==e.currPageX&&h>0&&e.dirX<0&&h--,c=e.pagesX[h],j=a.abs(c-e.pagesX[e.currPageX]),j=j?a.abs(e.x-c)/j*500:0,e.currPageX=h,h=e.pagesY.length-1;for(f=0;f<h;f++)if(d>=e.pagesY[f]){h=f;break}return h==e.currPageY&&h>0&&e.dirY<0&&h--,d=e.pagesY[h],k=a.abs(d-e.pagesY[e.currPageY]),k=k?a.abs(e.y-d)/k*500:0,e.currPageY=h,i=b(a.max(j,k))||200,{x:c,y:d,time:i}},_bind:function(a,b,c){(b||this.scroller).addEventListener(a,this,!!c)},_unbind:function(a,b,c){(b||this.scroller).removeEventListener(a,this,!!c)},destroy:function(){var a=this;a.scroller.style[c+"Transform"]="",a.hScrollbar=!1,a.vScrollbar=!1,a._scrollbar("h"),a._scrollbar("v"),a._unbind(n,window),a._unbind(o),a._unbind(p),a._unbind(q),a._unbind(r),a.options.hasTouch||(a._unbind("mouseout",a.wrapper),a._unbind(s)),a.options.useTransition&&a._unbind("webkitTransitionEnd"),a.options.checkDOMChanges&&clearInterval(a.checkDOMTime),a.options.onDestroy&&a.options.onDestroy.call(a)},refresh:function(){var a=this,d,e,f,g,h=0,i=0;a.scale<a.options.zoomMin&&(a.scale=a.options.zoomMin),a.wrapperW=a.wrapper.clientWidth||1,a.wrapperH=a.wrapper.clientHeight||1,a.minScrollY=-a.options.topOffset||0,a.scrollerW=b(a.scroller.offsetWidth*a.scale),a.scrollerH=b((a.scroller.offsetHeight+a.minScrollY)*a.scale),a.maxScrollX=a.wrapperW-a.scrollerW,a.maxScrollY=a.wrapperH-a.scrollerH+a.minScrollY,a.dirX=0,a.dirY=0,a.options.onRefresh&&a.options.onRefresh.call(a),a.hScroll=a.options.hScroll&&a.maxScrollX<0,a.vScroll=a.options.vScroll&&(!a.options.bounceLock&&!a.hScroll||a.scrollerH>a.wrapperH),a.hScrollbar=a.hScroll&&a.options.hScrollbar,a.vScrollbar=a.vScroll&&a.options.vScrollbar&&a.scrollerH>a.wrapperH,d=a._offset(a.wrapper),a.wrapperOffsetLeft=-d.left,a.wrapperOffsetTop=-d.top;if(typeof a.options.snap=="string"){a.pagesX=[],a.pagesY=[],g=a.scroller.querySelectorAll(a.options.snap);for(e=0,f=g.length;e<f;e++)h=a._offset(g[e]),h.left+=a.wrapperOffsetLeft,h.top+=a.wrapperOffsetTop,a.pagesX[e]=h.left<a.maxScrollX?a.maxScrollX:h.left*a.scale,a.pagesY[e]=h.top<a.maxScrollY?a.maxScrollY:h.top*a.scale}else if(a.options.snap){a.pagesX=[];while(h>=a.maxScrollX)a.pagesX[i]=h,h-=a.wrapperW,i++;a.maxScrollX%a.wrapperW&&(a.pagesX[a.pagesX.length]=a.maxScrollX-a.pagesX[a.pagesX.length-1]+a.pagesX[a.pagesX.length-1]),h=0,i=0,a.pagesY=[];while(h>=a.maxScrollY)a.pagesY[i]=h,h-=a.wrapperH,i++;a.maxScrollY%a.wrapperH&&(a.pagesY[a.pagesY.length]=a.maxScrollY-a.pagesY[a.pagesY.length-1]+a.pagesY[a.pagesY.length-1])}a._scrollbar("h"),a._scrollbar("v"),a.zoomed||(a.scroller.style[c+"TransitionDuration"]="0",a._resetPos(200))},scrollTo:function(a,b,c,d){var e=this,f=a,g,h;e.stop(),f.length||(f=[{x:a,y:b,time:c,relative:d}]);for(g=0,h=f.length;g<h;g++)f[g].relative&&(f[g].x=e.x-f[g].x,f[g].y=e.y-f[g].y),e.steps.push({x:f[g].x,y:f[g].y,time:f[g].time||0});e._startAni()},scrollToElement:function(b,c){var d=this,e;b=b.nodeType?b:d.scroller.querySelector(b);if(!b)return;e=d._offset(b),e.left+=d.wrapperOffsetLeft,e.top+=d.wrapperOffsetTop,e.left=e.left>0?0:e.left<d.maxScrollX?d.maxScrollX:e.left,e.top=e.top>d.minScrollY?d.minScrollY:e.top<d.maxScrollY?d.maxScrollY:e.top,c=c===undefined?a.max(a.abs(e.left)*2,a.abs(e.top)*2):c,d.scrollTo(e.left,e.top,c)},scrollToPage:function(a,b,c){var d=this,e,f;c=c===undefined?400:c,d.options.onScrollStart&&d.options.onScrollStart.call(d),d.options.snap?(a=a=="next"?d.currPageX+1:a=="prev"?d.currPageX-1:a,b=b=="next"?d.currPageY+1:b=="prev"?d.currPageY-1:b,a=a<0?0:a>d.pagesX.length-1?d.pagesX.length-1:a,b=b<0?0:b>d.pagesY.length-1?d.pagesY.length-1:b,d.currPageX=a,d.currPageY=b,e=d.pagesX[a],f=d.pagesY[b]):(e=-d.wrapperW*a,f=-d.wrapperH*b,e<d.maxScrollX&&(e=d.maxScrollX),f<d.maxScrollY&&(f=d.maxScrollY)),d.scrollTo(e,f,c)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(p),this._unbind(q),this._unbind(r)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):m(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(a,b,d,e){var f=this,g=d/f.scale;if(!f.options.useTransform)return;f.zoomed=!0,e=e===undefined?200:e,a=a-f.wrapperOffsetLeft-f.x,b=b-f.wrapperOffsetTop-f.y,f.x=a-a*g+f.x,f.y=b-b*g+f.y,f.scale=d,f.refresh(),f.x=f.x>0?0:f.x<f.maxScrollX?f.maxScrollX:f.x,f.y=f.y>f.minScrollY?f.minScrollY:f.y<f.maxScrollY?f.maxScrollY:f.y,f.scroller.style[c+"TransitionDuration"]=e+"ms",f.scroller.style[c+"Transform"]=t+f.x+"px,"+f.y+"px"+u+" scale("+d+")",f.zoomed=!1},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},typeof exports!="undefined"?exports.iScroll=v:window.iScroll=v}(),window.iScroll}),define("joshfire-framework/vendor/zepto",[],function(){(function(a){String.prototype.trim===a&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),Array.prototype.reduce===a&&(Array.prototype.reduce=function(b){if(this===void 0||this===null)throw new TypeError;var c=Object(this),d=c.length>>>0,e=0,f;if(typeof b!="function")throw new TypeError;if(d==0&&arguments.length==1)throw new TypeError;if(arguments.length>=2)f=arguments[1];else do{if(e in c){f=c[e++];break}if(++e>=d)throw new TypeError}while(!0);while(e<d)e in c&&(f=b.call(a,f,c[e],e,c)),e++;return f})})();var a=function(){function o(a){return{}.toString.call(a)=="[object Function]"}function p(a){return a instanceof Object}function q(a){return a instanceof Array}function r(b){return b.filter(function(b){return b!==a&&b!==null})}function s(a){return[].concat.apply([],a)}function t(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})}function u(a){return a.filter(function(a,b,c){return c.indexOf(a)==b})}function v(a){return a in j?j[a]:j[a]=new RegExp("(^|\\s)"+a+"(\\s|$)")}function w(a){var b,c;return i[a]||(b=h.createElement(a),h.body.insertAdjacentElement("beforeEnd",b),c=k(b,"").getPropertyValue("display"),b.parentNode.removeChild(b),c=="none"&&(c="block"),i[a]=c),i[a]}function x(a){return n.innerHTML=(""+a).trim(),g.call(n.childNodes)}function y(a,b){return a=a||f,a.__proto__=y.prototype,a.selector=b||"",a}function z(b,c){if(!b)return y();if(c!==a)return z(c).find(b);if(o(b))return z(h).ready(b);if(b instanceof y)return b;var e;return q(b)?e=r(b):b instanceof Element||b===window||b===h?(e=[b],b=null):l.test(b)?e=x(b):b.nodeType&&b.nodeType==3?e=[b]:e=d(h,b),y(e,b)}function A(b,c){return c===a?z(b):z(b).filter(c)}function B(a,b,c,d){return o(b)?b.call(a,c,d):b}function C(a,b,c){var d=a%2?b:b.parentNode;d&&d.insertBefore(c,a?a==1?d.firstChild:a==2?b:null:b.nextSibling)}function D(a,b){b(a);for(var c in a.childNodes)D(a.childNodes[c],b)}function E(a){var b=a.innerHTML||"",c=a.getAttribute("src"),d=null,e=null;b?window.eval.call(window,b):c&&(d=h.getElementsByTagName("head")[0]||h.documentElement,e=h.createElement("script"),e.type="text/javascript",e.setAttribute("src",c),d.insertBefore(e,d.firstChild)),a.parentNode&&a.parentNode.removeChild(a)}var a,b,c,d,e,f=[],g=f.slice,h=window.document,i={},j={},k=h.defaultView.getComputedStyle,l=/^\s*<[^>]+>/,m=["after","prepend","before","append"],n=h.createElement("div");return z.extend=function(a,c){for(b in c)a[b]=c[b];return a},z.qsa=d=function(a,b){return b?g.call(a.querySelectorAll(b)):y()},z.isFunction=o,z.isObject=p,z.isArray=q,z.fn={forEach:f.forEach,map:f.map,reduce:f.reduce,push:f.push,indexOf:f.indexOf,concat:f.concat,ready:function(a){return(h.readyState=="complete"||h.readyState=="loaded")&&a(),h.addEventListener("DOMContentLoaded",a,!1),this},get:function(b){return b===a?this:this[b]},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode.removeChild(this)})},each:function(a){return this.forEach(function(b,c){a.call(b,c,b)}),this},filter:function(a){return z([].filter.call(this,function(b){return d(b.parentNode,a).indexOf(b)>=0}))},add:function(a,b){return z(u(this.concat(z(a,b))))},is:function(a){return this.length>0&&z(this[0]).filter(a).length>0},not:function(b){var c=[];if(o(b)&&b.call!==a)this.each(function(a){b.call(this,a)||c.push(this)});else{var d=g.call(typeof b=="string"?this.filter(b):b instanceof NodeList?b:z(b));g.call(this).forEach(function(a){d.indexOf(a)<0&&c.push(a)})}return z(c)},eq:function(a){return z(this[a])},first:function(){return z(this[0])},last:function(){return z(this[this.length-1])},find:function(a){var b;return this.length==1?b=d(this[0],a):b=s(this.map(function(b){return d(b,a)})),z(b)},closest:function(b,c){var e=this[0],f=d(c!==a?c:h,b);f.length===0&&(e=null);while(e&&e!==h&&f.indexOf(e)<0)e=e.parentNode;return z(e!==h&&e)},parents:function(a){var b=[],c=this;while(c.length>0)c=r(c.map(function(a){if((a=a.parentNode)&&a!==h&&b.indexOf(a)<0)return b.push(a),a}));return A(b,a)},parent:function(a){return A(u(r(this.pluck("parentNode"))),a)},children:function(a){return A(s(this.map(function(a){return g.call(a.children)})),a)},siblings:function(a){return A(s(this.map(function(a){return g.call(a.parentNode.children).filter(function(b){return b!==a})})),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return this.map(function(b){return b[a]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=null),k(this,"").getPropertyValue("display")=="none"&&(this.style.display=w(this.nodeName))})},replaceWith:function(a){return this.each(function(){var b=z(this),c=b.prev();b.remove(),c.after(a)})},hide:function(){return this.css("display","none")},toggle:function(){return this.css("display")=="none"?this.show():this.hide()},prev:function(){return z(this.pluck("previousElementSibling"))},next:function(){return z(this.pluck("nextElementSibling"))},html:function(b){return b===a?this.length>0?this[0].innerHTML:null:this.each(function(a){this.innerHTML=B(this,b,a,this.innerHTML)})},text:function(b){return b===a?this.length>0?this[0].innerText:null:this.each(function(){this.innerText=b})},attr:function(c,d){return typeof c=="string"&&d===a?this.length>0&&this[0].nodeName=="INPUT"&&this[0].type=="text"&&c=="value"?this.val():this.length>0?this[0].getAttribute(c)||(c in this[0]?this[0][c]:a):a:this.each(function(a){if(p(c))for(b in c)this.setAttribute(b,c[b]);else this.setAttribute(c,B(this,d,a,this.getAttribute(c)))})},removeAttr:function(a){return this.each(function(){this.removeAttribute(a)})},data:function(a,b){return this.attr("data-"+a,b)},val:function(b){return b===a?this.length>0?this[0].value:null:this.each(function(){this.value=b})},offset:function(){if(this.length==0)return null;var a=this[0].getBoundingClientRect();return{left:a.left+h.body.scrollLeft,top:a.top+h.body.scrollTop,width:a.width,height:a.height}},css:function(d,e){if(e===a&&typeof d=="string")return this[0].style[t(d)]||k(this[0],"").getPropertyValue(d);c="";for(b in d)c+=b+":"+d[b]+";";return typeof d=="string"&&(c=d+":"+e),this.each(function(){this.style.cssText+=";"+c})},index:function(a){return this.indexOf(z(a)[0])},hasClass:function(a){return v(a).test(this[0].className)},addClass:function(a){return this.each(function(b){e=[];var c=this.className,d=B(this,a,b,c);d.split(/\s+/g).forEach(function(a){z(this).hasClass(a)||e.push(a)},this),e.length&&(this.className+=(c?" ":"")+e.join(" "))})},removeClass:function(a){return this.each(function(b){e=this.className,B(this,a,b,e).split(/\s+/g).forEach(function(a){e=e.replace(v(a)," ")}),this.className=e.trim()})},toggleClass:function(b,c){return this.each(function(d){var e=this.className,f=B(this,b,d,e);c!==a&&!c||z(this).hasClass(f)?z(this).removeClass(f):z(this).addClass(f)})},submit:function(){return this.each(function(){try{this.submit();return}catch(a){}})}},["width","height"].forEach(function(a){z.fn[a]=function(){var b=this.offset();return b?b[a]:null}}),m.forEach(function(a,b){z.fn[a]=function(a){var c=p(a)?a:x(a);if(!("length"in c)||c.nodeType)c=[c];if(c.length<1)return this;var d=this.length,e=d>1,f=b<2;return this.each(function(a,g){var h=[];for(var i=0;i<c.length;i++){var j=c[f?c.length-i-1:i];D(j,function(a){var b=null;a.nodeName!=null&&a.nodeName.toUpperCase()==="SCRIPT"&&(!a.type||a.type==="text/javascript")&&h.push(a)}),e&&a<d-1&&(j=j.cloneNode(!0)),C(b,g,j)}for(var k in h)E(h[k])})};var c=b%2?a+"To":"insert"+(b?"Before":"After");z.fn[c]=function(b){return z(b)[a](this),this}}),y.prototype=z.fn,z}();return"$"in window||(window.$=a),function(a){function e(a){return a._zid||(a._zid=d++)}function f(a,b,d,f){b=g(b);if(b.ns)var i=h(b.ns);return(c[e(a)]||[]).filter(function(a){return a&&(!b.e||a.e==b.e)&&(!b.ns||i.test(a.ns))&&(!d||a.fn==d)&&(!f||a.sel==f)})}function g(a){var b=(""+a).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function h(a){return new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")}function i(b,d,f,h,i){var j=e(b),k=c[j]||(c[j]=[]);d.split(/\s/).forEach(function(c){var d=i||f,e=function(a){return d(a,a.data)},j=a.extend(g(c),{fn:f,proxy:e,sel:h,del:i,i:k.length});k.push(j),b.addEventListener(j.e,e,!1)})}function j(a,b,d,g){var h=e(a);(b||"").split(/\s/).forEach(function(b){f(a,b,d,g).forEach(function(b){delete c[h][b.i],a.removeEventListener(b.e,b.proxy,!1)})})}function l(b){var c=a.extend({originalEvent:b},b);return k.forEach(function(a){c[a]=function(){return b[a].apply(b,arguments)}}),c}var b=a.qsa,c={},d=1;a.event={add:i,remove:j},a.fn.bind=function(a,b){return this.each(function(){i(this,a,b)})},a.fn.unbind=function(a,b){return this.each(function(){j(this,a,b)})},a.fn.one=function(a,b){return this.each(function(){var c=this;i(this,a,function(){b(),j(c,a,arguments.callee)})})};var k=["preventDefault","stopImmediatePropagation","stopPropagation"];a.fn.delegate=function(c,d,e){return this.each(function(f,g){i(g,d,e,c,function(d,f){var h=d.target,i=b(g,c);h&&h!==g&&h!==document&&e.call(h,a.extend(l(d),{currentTarget:h,liveFired:g}),f)})})},a.fn.undelegate=function(a,b,c){return this.each(function(){j(this,b,c,a)})},a.fn.live=function(b,c){return a(document.body).delegate(this.selector,b,c),this},a.fn.die=function(b,c){return a(document.body).undelegate(this.selector,b,c),this},a.fn.trigger=function(a,b){return this.each(function(){var c=document.createEvent("Events");c.initEvent(a,!0,!0),c.data=b,this.dispatchEvent(c)})}}(a),function(a){function b(a){var a=a,b={},c=a.match(/(Android)\s+([\d.]+)/),d=a.match(/(iPhone\sOS)\s([\d_]+)/),e=a.match(/(iPad).*OS\s([\d_]+)/),f=a.match(/(webOS)\/([\d.]+)/),g=a.match(/(BlackBerry).*Version\/([\d.]+)/);return c&&(b.android=!0,b.version=c[2]),d&&(b.ios=!0,b.version=d[2].replace(/_/g,"."),b.iphone=!0),e&&(b.ios=!0,b.version=e[2].replace(/_/g,"."),b.ipad=!0),f&&(b.webos=!0,b.version=f[2]),g&&(b.blackberry=!0,b.version=g[2]),b}a.os=b(navigator.userAgent),a.__detect=b;var c=navigator.userAgent.match(/WebKit\/([\d.]+)/);a.browser=c?{webkit:!0,version:c[1]}:{webkit:!1}}(a),function(a,b){a.fn.anim=function(c,d,e,f){var g=[],h,i;for(i in c)i==="opacity"?h=c[i]:g.push(i+"("+c[i]+")");return a.isFunction(f)&&this.one("webkitTransitionEnd",f),this.css({"-webkit-transition":"all "+(d!==b?d:.5)+"s "+(e||""),"-webkit-transform":g.join(" "),opacity:h})}}(a),function(a){function e(){}var b=0,c=a.isObject,d;a.ajaxJSONP=function(c){var d="jsonp"+ ++b,e=document.createElement("script");window[d]=function(a){c.success(a),delete window[d]},e.src=c.url.replace(/=\?/,"="+d),a("head").append(e)},a.ajaxSettings={type:"GET",beforeSend:e,success:e,error:e,complete:e,accepts:{script:"text/javascript, application/javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"}},a.ajax=function(b){b=b||{};var e=a.extend({},b);for(d in a.ajaxSettings)e[d]||(e[d]=a.ajaxSettings[d]);if(/=\?/.test(e.url))return a.ajaxJSONP(e);e.url||(e.url=window.location.toString()),e.data&&!e.contentType&&(e.contentType="application/x-www-form-urlencoded"),c(e.data)&&(e.contentType=="application/x-www-form-urlencoded"?e.data=a.param(e.data):e.contentType=="application/json"&&(e.data=JSON.stringify(e.data)));if(e.type.match(/get/i)&&e.data){var f=e.data;e.url.match(/\?.*=/)?f="&"+f:f[0]!="?"&&(f="?"+f),e.url+=f}var g=e.accepts[e.dataType],h=new XMLHttpRequest;e.headers=a.extend({"X-Requested-With":"XMLHttpRequest"},e.headers||{}),g&&(e.headers.Accept=g),h.onreadystatechange=function(){if(h.readyState==4){var a,b=!1;if(h.status>=200&&h.status<300||h.status==0){if(g=="application/json")try{a=JSON.parse(h.responseText)}catch(c){b=c}else g=="application/xml, text/xml"?a=h.responseXML:a=h.responseText;b?e.error(h,"parsererror",b):e.success(a,"success",h)}else b=!0,e.error(h,"error");e.complete(h,b?"error":"success")}},h.open(e.type,e.url,!0);if(e.beforeSend(h,e)===!1)return h.abort(),!1;if(e.xhrFields)for(var i in e.xhrFields)h[i]=e.xhrFields[i];e.contentType&&(e.headers["Content-Type"]=e.contentType);for(name in e.headers)h.setRequestHeader(name,e.headers[name]);return h.send(e.data),h},a.get=function(b,c){a.ajax({url:b,success:c})},a.post=function(b,c,d,e){a.isFunction(c)&&(e=e||d,d=c,c=null),a.ajax({type:"POST",url:b,data:c,success:d,dataType:e})},a.getJSON=function(b,c){a.ajax({url:b,success:c,dataType:"json"})},a.fn.load=function(b,c){if(!this.length)return this;var d=this,e=b.split(/\s/),f;return e.length>1&&(b=e[0],f=e[1]),a.get(b,function(b){d.html(f?a(document.createElement("div")).html(b).find(f).html():b),c&&c()}),this},a.param=function(b,e){var f=[],g=function(a,b){f.push(encodeURIComponent(e?e+"["+a+"]":a)+"="+encodeURIComponent(b))},h=a.isArray(b);for(d in b)c(b[d])?f.push(a.param(b[d],e?e+"["+d+"]":d)):g(h?"":d,b[d]);return f.join("&").replace("%20","+")}}(a),function(a){function d(a){return"tagName"in a?a:a.parentNode}function e(a,b,c,d){var e=Math.abs(a-b),f=Math.abs(c-d);return e>=f?a-b>0?"Left":"Right":c-d>0?"Up":"Down"}var b={},c;a(document).ready(function(){a(document.body).bind("touchstart",function(a){var e=Date.now(),f=e-(b.last||e);b.target=d(a.touches[0].target),c&&clearTimeout(c),b.x1=a.touches[0].pageX,b.y1=a.touches[0].pageY,f>0&&f<=250&&(b.isDoubleTap=!0),b.last=e}).bind("touchmove",function(a){b.x2=a.touches[0].pageX,b.y2=a.touches[0].pageY}).bind("touchend",function(d){b.isDoubleTap?(a(b.target).trigger("doubleTap"),b={}):b.x2>0||b.y2>0?((Math.abs(b.x1-b.x2)>30||Math.abs(b.y1-b.y2)>30)&&a(b.target).trigger("swipe")&&a(b.target).trigger("swipe"+e(b.x1,b.x2,b.y1,b.y2)),b.x1=b.x2=b.y1=b.y2=b.last=0):"last"in b&&(c=setTimeout(function(){c=null,a(b.target).trigger("tap"),b={}},250))}).bind("touchcancel",function(){b={}})}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap"].forEach(function(b){a.fn[b]=function(a){return this.bind(b,a)}})}(a),a}),define("joshfire-framework/adapters/phone/utils/dollar",["joshlib!vendor/zepto"],function(a){return a}),define("joshfire-framework/vendor/underscore",[],function(){function B(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&x.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&x.isFunction(b.isEqual))return b.isEqual(a);var d=j.call(a);if(d!=j.call(b))return!1;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&B(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(k.call(a,h)){f++;if(!(g=k.call(b,h)&&B(a[h],b[h],c)))break}if(g){for(h in b)if(k.call(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.concat,i=d.unshift,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return new D(a)};x.VERSION="1.2.3";var y=x.each=x.forEach=function(a,b,d){if(a==null)return;if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(k.call(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=function(a,b,c){var d=[];return a==null?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=x.toArray(a).reverse();return d&&!e&&(b=x.bind(b,d)),e?x.reduce(f,b,c,d):x.reduce(f,b)},x.find=x.detect=function(a,b,c){var d;return z(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},x.filter=x.select=function(a,b,c){var d=[];return a==null?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){var d=[];return a==null?d:(y(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},x.every=x.all=function(a,b,d){var e=!0;return a==null?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),e)};var z=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return a==null?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};x.include=x.contains=function(a,b){var c=!1;return a==null?c:s&&a.indexOf===s?a.indexOf(b)!=-1:(c=z(a,function(a){return a===b}),c)},x.invoke=function(a,b){var c=g.call(arguments,2);return x.map(a,function(a){return(b.call?b||a:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.max=function(a,b,c){if(!b&&x.isArray(a))return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-Infinity;var d={computed:-Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a))return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return Infinity;var d={computed:Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b=[],c;return y(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},x.sortBy=function(a,b,c){return x.pluck(x.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},x.groupBy=function(a,b){var c={},d=x.isFunction(b)?b:function(a){return a[b]};return y(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},x.sortedIndex=function(a,b,c){c||(c=x.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},x.toArray=function(a){return a?a.toArray?a.toArray():x.isArray(a)?g.call(a):x.isArguments(a)?g.call(a):x.values(a):[]},x.size=function(a){return x.toArray(a).length},x.first=x.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},x.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},x.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},x.rest=x.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},x.compact=function(a){return x.filter(a,function(a){return!!a})},x.flatten=function(a,b){return x.reduce(a,function(a,c){return x.isArray(c)?a.concat(b?c:x.flatten(c)):(a[a.length]=c,a)},[])},x.without=function(a){return x.difference(a,g.call(arguments,1))},x.uniq=x.unique=function(a,b,c){var d=c?x.map(a,c):a,e=[];return x.reduce(d,function(c,d,f){if(0==f||(b===!0?x.last(c)!=d:!x.include(c,d)))c[c.length]=d,e[e.length]=a[f];return c},[]),e},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=x.intersect=function(a){var b=g.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=x.flatten(g.call(arguments,1));return x.filter(a,function(a){return!x.include(b,a)})},x.zip=function(){var a=g.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=x.pluck(a,""+d);return c},x.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;if(s&&a.indexOf===s)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},x.lastIndexOf=function(a,b){if(a==null)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var A=function(){};x.bind=function(b,c){var d,e;if(b.bind===w&&w)return w.apply(b,g.call(arguments,1));if(!x.isFunction(b))throw new TypeError;return e=g.call(arguments,2),d=function(){if(this instanceof d){A.prototype=b.prototype;var a=new A,f=b.apply(a,e.concat(g.call(arguments)));return Object(f)===f?f:a}return b.apply(c,e.concat(g.call(arguments)))}},x.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return k.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(g.call(arguments,1)))},x.throttle=function(a,b){var c,d,e,f,g,h=x.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},x.debounce=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},x.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},x.wrap=function(a,b){return function(){var c=h.apply([a],arguments);return b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)k.call(a,c)&&(b[b.length]=c);return b},x.values=function(a){return x.map(a,x.identity)},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(g.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])}),a},x.defaults=function(a){return y(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a},x.isEqual=function(a,b){return B(a,b,[])},x.isEmpty=function(a){if(x.isArray(a)||x.isString(a))return a.length===0;for(var b in a)if(k.call(a,b))return!1;return!0},x.isElement=function(a){return!!a&&a.nodeType==1},x.isArray=u||function(a){return j.call(a)=="[object Array]"},x.isObject=function(a){return a===Object(a)},x.isArguments=function(a){return j.call(a)=="[object Arguments]"},x.isArguments(arguments)||(x.isArguments=function(a){return!!a&&!!k.call(a,"callee")}),x.isFunction=function(a){return j.call(a)=="[object Function]"},x.isString=function(a){return j.call(a)=="[object String]"},x.isNumber=function(a){return j.call(a)=="[object Number]"},x.isNaN=function(a){return a!==a},x.isBoolean=function(a){return a===!0||a===!1||j.call(a)=="[object Boolean]"},x.isDate=function(a){return j.call(a)=="[object Date]"},x.isRegExp=function(a){return j.call(a)=="[object RegExp]"},x.isNull=function(a){return a===null},x.isUndefined=function(a){return a===void 0},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},x.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},x.mixin=function(a){y(x.functions(a),function(b){F(b,x[b]=a[b])})};var C=0;x.uniqueId=function(a){var b=C++;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},x.template=function(a,b){var c=x.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);if(b)return e(b,x);var f=function(a){return e.call(this,a,x)};return f.func=e,f};var D=function(a){this._wrapped=a};x.prototype=D.prototype;var E=function(a,b){return b?x(a).chain():a},F=function(a,b){D.prototype[a]=function(){var a=g.call(arguments);return i.call(a,this._wrapped),E(b.apply(x,a),this._chain)}};return x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];D.prototype[a]=function(){return b.apply(this._wrapped,arguments),E(this._wrapped,this._chain)}}),y(["concat","join","slice"],function(a){var b=d[a];D.prototype[a]=function(){return E(b.apply(this._wrapped,arguments),this._chain)}}),D.prototype.chain=function(){return this._chain=!0,this},D.prototype.value=function(){return this._wrapped},x}),function(a){var b=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},c=function(a){if(a["@type"]==="VideoObject"||a["@type"]==="AudioObject")return a;var b=null;switch(a["@type"]){case"MusicRecording":b=["audio","associatedMedia","video"];break;default:b=["video","associatedMedia","audio"]}for(var c=0,d=b.length;c<d;c++){var e=b[c];if(typeof a[e]!="undefined")return a[e]}},d=function(a,b){b=b||{},a=a||{};var c={width:b.width||500,height:b.height||281};a["@type"]==="AudioObject"&&(c.height=b.height||40);if(b.adjustSize){var d=4/3;a.width&&a.height?d=a.width/a.height:a["yt:aspectRatio"]==="widescreen"&&(d=16/9);var e={width:Math.round(c.height*d),height:Math.round(c.width/d)};e.width>c.width+1?c.height=e.height:e.width<c.width-1&&(c.width=e.width)}return c},e=function(a){typeof this.initialize=="function"?this.initialize(a):e.prototype.initialize.call(this,a)};e.extend=function(a){var c=function(a){e.call(this,a)};return b(c.prototype,a),c},b(e.prototype,{initialize:function(a){},toHtml:function(a){typeof a=="function"&&a(null,"",{})}});var f=function(a){if(a.match(/soundcloud/g))return"audio/mp3";var b=a.split(".").pop();switch(b){case"webm":return"video/webm";case"ogv":return"video/ogg";case"mp4":return"video/mp4";case"m4v":return"video/mp4";case"ogg":return"audio/ogg";case"mp3":return"audio/mp3";case"m4a":return"audio/mp4";default:return""}},g=e.extend({initialize:function(a){this.sources=a.sources,this.poster=a.poster,this.width=a.width||500,this.height=a.height||281,this.autoPlay=a.autoPlay||!1},toHtml:function(a){var b=this.poster?' poster="'+this.poster+'"':"",c=this.autoPlay?" autoplay":"",d='<video width="'+this.width+'" height="'+this.height+'" '+b+c+" controls "+'class="video-js vjs-default-skin" data-setup="{}">';for(var e=0;e<this.sources.length;e++){var g=this.sources[e];d+='<source src="'+g+'"  type="'+f(g)+'"></source>'}d+="</video>",typeof a=="function"&&a(null,d,{width:this.width,height:this.height})}}),h=e.extend({initialize:function(a){this.sources=a.sources,this.poster=a.poster||"",this.width=a.width||500,this.height=a.height||281,this.autoPlay=a.autoPlay||!1},addPolyFill:function(){var a=document.getElementsByTagName("body")[0],b=document.createElement("link"),c=document.createElement("script");b.setAttribute("href","http://vjs.zencdn.net/c/video-js.css"),b.setAttribute("rel","stylesheet"),c.setAttribute("src","http://vjs.zencdn.net/c/video.js"),a.appendChild(b),a.appendChild(c)},toHtml:function(a){var b=this.poster?' poster="'+this.poster+'"':"",c=this.autoPlay?" autoplay":"",d='<video width="'+this.width+'" height="'+this.height+'" '+b+c+" controls"+' class="video-js vjs-default-skin" data-setup="{}">';for(var e=0;e<this.sources.length;e++){var g=this.sources[e];d+='<source src="'+g+'"  type="'+f(g)+'"></source>'}d+="</video>",typeof window!="undefined"&&typeof window.VideoJS=="undefined"&&this.addPolyFill(),typeof a=="function"&&a(null,d,{width:this.width,height:this.height})}}),i=e.extend({initialize:function(a){this.sources=a.sources,this.width=a.width||500,this.height=a.height||40,this.autoPlay=a.autoPlay||!1},iCanHazAudioTag:function(a){if(!document)return!1;var b=document.createElement("audio");return b.canPlayType},toHtml:function(a){var b="";if(this.sources&&this.sources.length){for(var c=0;c<this.sources.length;c++)if(this.iCanHazAudioTag(this.sources[c])){var d=this.autoPlay?" autoplay":"";b='<audio controls src="'+this.sources[c]+'"'+d+"></audio>";break}b||(b='<a href="'+this.sources[0]+'" target="_blank">Play</a>')}typeof a=="function"&&a(null,b,{})}}),j=e.extend({initialize:function(a){this.sources=a.sources,this.width=a.width||500,this.height=a.height||281,this.autoPlay=a.autoPlay||!1},toHtml:function(a){var b="mediaplayerlib-mediaelement-video-"+j.nextId++,c=this.poster?' poster="'+this.poster+'"':"",d=this.autoPlay?" autoplay":"",e='<video width="'+this.width+'" height="'+this.height+'" '+c+d+" controls"+' id="'+b+'">';for(var f=0;f<this.sources.length;f++){var g=this.sources[f];e+='<source src="'+g+'"></source>'}e+="</video>",e+="<script>",e+='$("#'+b+'").mediaelementplayer({',e+="playerWidth: "+this.width+",",e+="playerHeight: "+this.height,e+="});",e+="</script>",typeof a=="function"&&a(null,e,{width:this.width,height:this.height})}});j.nextId=0;var k=e.extend({initialize:function(a){this.options=a},toHtml:function(b){var c=null;for(var d=0;d<k.endPoints.length;d++)this.options.url.match(k.endPoints[d].regexp)&&(c=k.endPoints[d]);if(!c){typeof b=="function"&&b(null,null);return}if(typeof module!="undefined"){var e=c.url(null,this.options),f=require("http"),g=require("url"),h=g.parse(e),i={host:h.hostname,path:h.pathname+h.search,port:80,method:"GET"},j=f.request(i,function(a){var c="";a.on("data",function(a){c+=a}),a.on("end",function(){typeof b!="undefined"&&b(null,JSON.parse(c).html)}),a.on("close",function(a){typeof b!="undefined"&&b(a)})});j.on("error",function(a){typeof b!="undefined"&&b(a)}),j.end()}else{var l=k.cbName(),g=c.url(l,this.options),m=document.getElementsByTagName("body")[0],n=document.createElement("script");a[l]=function(c){m.removeChild(n),delete a[l],typeof b=="function"&&b(null,c.html)},n.setAttribute("src",g),m.appendChild(n)}}});k.endPoints=[{regexp:/soundcloud\.com/i,url:function(a,b){var c=null;return a?c="http://soundcloud.com/oembed?format=js&callback="+a+"&url="+encodeURIComponent(b.url):c="http://soundcloud.com/oembed?format=json&url="+encodeURIComponent(b.url),b.width&&(c+="&maxwidth="+b.width),b.height&&(c+="&maxheight="+b.height),c}},{regexp:/vimeo\.com/i,url:function(a,b){var c=null;return a?c="http://vimeo.com/api/oembed.json?callback="+a+"&url="+encodeURIComponent(b.url):c="http://vimeo.com/api/oembed.json?url="+encodeURIComponent(b.url),b.width&&(c+="&width="+b.width),b.height&&(c+="&height="+b.height),c}},{regexp:/slideshare\.net/i,url:function(a,b){var c=null;return a?c="http://www.slideshare.net/api/oembed/2?format=jsonp&callback="+a+"&url="+encodeURIComponent(b.url):c="http://www.slideshare.net/api/oembed/2?url="+encodeURIComponent(b.url),b.width&&(c+="&maxwidth="+b.width),b.height&&(c+="&maxheight="+b.height),c}}],k.numCbName=0,k.cbName=function(){return"OEmbedCallBack"+k.numCbName++};var l=e.extend({initialize:function(a){this.url=a.url,this.width=a.width||500,this.height=a.height||281;var b=this.url.match(/youtube/gi),c=this.url.match(/vimeo/gi);a.html5&&b&&(this.url.indexOf("?")===-1?this.url+="?html5=1":this.url+="&html5=1"),a.autoPlay&&(b||c)&&(this.url.indexOf("?")===-1?this.url+="?autoplay=1":this.url+="&autoplay=1")},toHtml:function(a){var b='<iframe src="'+this.url+'" width="'+this.width+'" height="'+this.height+'" frameborder="0"></iframe>';typeof a=="function"&&a(null,b,{width:this.width,height:this.height})}}),m=e.extend({initialize:function(a){this.url=a.url,this.publisher=a.publisher,this.width=a.width||500,this.height=a.height||281},toHtml:function(a){var b=this.url||"",c="",d="",e=function(){var a=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return"mediaplayerlib-"+a()+a()+a()};d=e(),this.publisher==="Ooyala"?(b+=(b.indexOf("?")===-1?"?":"&amp;")+"width="+encodeURIComponent(this.width)+"&amp;height="+encodeURIComponent(this.height),c='<div id="'+d+'"></div>'+'<script type="text/javascript">'+'document.getElementById("'+d+'").appendChild(document.createElement("script"));'+'window.ooyalaActiveScript = document.getElementById("'+d+'").firstChild;'+"</script>"+'<script type="text/javascript" src="'+b+'"></script>'):c='<script type="text/javascript" src="'+b+'"></script>',typeof a=="function"&&a(null,c,{width:this.width,height:this.height})}}),n=e.extend({toHtml:function(a){typeof a=="function"&&a(new Error("Unknown media type."),"Unknown media type.")}}),o=function(){};b(o.prototype,{execute:function(a,b){return new n(b)}}),o.extend=function(a){var c=function(a){o.call(this,a)};return b(c.prototype,a),c};var p=o.extend({execute:function(a,e){var f,g=c(a)||{},i=d(g,e);b(e,i);if(g["@type"]==="VideoObject")if(g.playerType==="iframe")b(e,{url:g.embedURL}),f=new l(e);else if(g.playerType==="script")b(e,{url:g.embedURL,publisher:g.publisher?g.publisher.name:null}),f=new m(e);else if(g.contentURL){var j=null;g.image&&g.image.contentURL&&(j=g.image.contentURL),b(e,{poster:j,sources:[g.contentURL]}),f=new h(e)}return f||new n}}),q=o.extend({execute:function(a,e){var f,h=c(a)||{},j=d(h,e);b(e,j);if(h.playerType==="iframe")b(e,{url:h.embedURL,html5:!0}),f=new l(e);else if(h.playerType==="script")b(e,{url:h.embedURL,html5:!0,publisher:h.publisher?h.publisher.name:null}),f=new m(e);else if(h["@type"]==="VideoObject"){if(h.contentURL){var k=null;h.image&&(k=h.image.contentURL),b(e,{poster:k,sources:[h.contentURL]}),f=new g(e)}}else h["@type"]==="AudioObject"&&h.contentURL&&(b(e,{sources:[h.contentURL]}),f=new i(e));return f}}),r=o.extend({execute:function(a,e){var f=c(a)||{},g=d(f,e);b(e,g);var h;if(a["@type"]==="VideoObject"){if(typeof a.contentURL!="undefined"){var i=null;f.image&&(i=f.image.contentURL),b(e,{poster:i,sources:[a.contentURL]}),h=new j(e)}}else a["@type"]==="AudioObject"&&typeof a.contentURL!="undefined"&&b(e,{sources:[a.contentURL]});return h}}),s=o.extend({execute:function(a,c){var d;return typeof a.url!="undefined"&&(b(c,{url:a.url}),d=new k(c)),d}}),t=function(){this.strategies={def:new p,html5:new q,mediaElement:new r,oembed:new s}};b(t.prototype,{resolve:function(a,b){b=b||{};var c;if(typeof b.strategy!="undefined"&&typeof this.strategies[b.strategy]!="undefined"){var d=this.strategies[b.strategy];c=d.execute(a,b)}return c||this.strategies.def.execute(a,b)},insertFragment:function(a,b){function d(a,b){b(a);for(var c in a.childNodes)d(a.childNodes[c],b)}function e(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()}function f(a){var b=a.text||a.textContent||a.innerHTML||"",c=a.getAttribute("src"),d=document.getElementsByTagName("head")[0]||document.documentElement,e=document.createElement("script");e.type="text/javascript",c&&e.setAttribute("src",c),b&&e.appendChild(document.createTextNode(b)),d.insertBefore(e,d.firstChild),a.parentNode&&a.parentNode.removeChild(a)}var c=null;Object.prototype.toString.call(b)==="[object String]"?c=document.getElementById(b):c=b,c.innerHTML=(""+a).trim();var g=[],h=null;d(c,function(a){a.nodeName&&a.nodeName.toUpperCase()==="SCRIPT"&&(!a.type||a.type==="text/javascript")&&g.push(a)});for(h in g)f(g[h])},insert:function(a,b,c,d){var e=this,f=this.resolve(a,b).toHtml(function(a,b){e.insertFragment(b,c),typeof d=="function"&&d(null)})}}),typeof Joshfire!="undefined"&&typeof Joshfire.define!="undefined"?Joshfire.define([],function(){return new t}):typeof define!="undefined"?define("joshfire-framework/utils/mediaplayerlib",[],function(){return new t}):a.mediaFactory=new t}(typeof module!="undefined"?module.exports:window),define("joshfire-framework/vendor/backbone",["joshlib!vendor/underscore","joshlib!utils/dollar"],function(a,b){var c=this,d=c.Backbone,e;typeof exports!="undefined"?e=exports:e=c.Backbone={},e.VERSION="0.5.3",e.noConflict=function(){return c.Backbone=d,this},e.emulateHTTP=!1,e.emulateJSON=!1,e.Events={bind:function(a,b,c){var d=this._callbacks||(this._callbacks={}),e=d[a]||(d[a]=[]);return e.push([b,c]),this},unbind:function(a,b){var c;if(!a)this._callbacks={};else if(c=this._callbacks)if(!b)c[a]=[];else{var d=c[a];if(!d)return this;for(var e=0,f=d.length;e<f;e++)if(d[e]&&b===d[e][0]){d[e]=null;break}}return this},trigger:function(a){var b,c,d,e,f,g=2;if(!(c=this._callbacks))return this;while(g--){d=g?a:"all";if(b=c[d])for(var h=0,i=b.length;h<i;h++)(e=b[h])?(f=g?Array.prototype.slice.call(arguments,1):arguments,e[0].apply(e[1]||this,f)):(b.splice(h,1),h--,i--)}return this}},e.Model=function(b,c){var d;b||(b={});if(d=this.defaults)a.isFunction(d)&&(d=d.call(this)),b=a.extend({},d,b);this.attributes={},this._escapedAttributes={},this.cid=a.uniqueId("c"),this.set(b,{silent:!0}),this._changed=!1,this._previousAttributes=a.clone(this.attributes),c&&c.collection&&(this.collection=c.collection),this.initialize(b,c)},a.extend(e.Model.prototype,e.Events,{_previousAttributes:null,_changed:!1,idAttribute:"id",initialize:function(){},toJSON:function(){return a.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var c=this.attributes[a];return this._escapedAttributes[a]=w(c==null?"":""+c)},has:function(a){return this.attributes[a]!=null},set:function(b,c){c||(c={});if(!b)return this;b.attributes&&(b=b.attributes);var d=this.attributes,e=this._escapedAttributes;if(!c.silent&&this.validate&&!this._performValidation(b,c))return!1;this.idAttribute in b&&(this.id=b[this.idAttribute]);var f=this._changing;this._changing=!0;for(var g in b){var h=b[g];a.isEqual(d[g],h)||(d[g]=h,delete e[g],this._changed=!0,c.silent||this.trigger("change:"+g,this,h,c))}return!f&&!c.silent&&this._changed&&this.change(c),this._changing=!1,this},unset:function(a,b){if(a in this.attributes){b||(b={});var c=this.attributes[a],d={};return d[a]=void 0,!b.silent&&this.validate&&!this._performValidation(d,b)?!1:(delete this.attributes[a],delete this._escapedAttributes[a],a==this.idAttribute&&delete this.id,this._changed=!0,b.silent||(this.trigger("change:"+a,this,void 0,b),this.change(b)),this)}return this},clear:function(a){a||(a={});var b,c=this.attributes,d={};for(b in c)d[b]=void 0;if(!a.silent&&this.validate&&!this._performValidation(d,a))return!1;this.attributes={},this._escapedAttributes={},this._changed=!0;if(!a.silent){for(b in c)this.trigger("change:"+b,this,void 0,a);this.change(a)}return this},fetch:function(a){a||(a={});var b=this,c=a.success;return a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)},a.error=v(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},save:function(a,b){b||(b={});if(a&&!this.set(a,b))return!1;var c=this,d=b.success;b.success=function(a,e,f){if(!c.set(c.parse(a,f),b))return!1;d&&d(c,a,f)},b.error=v(b.error,c,b);var f=this.isNew()?"create":"update";return(this.sync||e.sync).call(this,f,this,b)},destroy:function(a){a||(a={});if(this.isNew())return this.trigger("destroy",this,this.collection,a);var b=this,c=a.success;return a.success=function(d){b.trigger("destroy",b,b.collection,a),c&&c(b,d)},a.error=v(a.error,b,a),(this.sync||e.sync).call(this,"delete",this,a)},url:function(){var a=t(this.collection)||this.urlRoot||u();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(b){this.trigger("change",this,b),this._previousAttributes=a.clone(this.attributes),this._changed=!1},hasChanged:function(a){return a?this._previousAttributes[a]!=this.attributes[a]:this._changed},changedAttributes:function(b){b||(b=this.attributes);var c=this._previousAttributes,d=!1;for(var e in b)a.isEqual(c[e],b[e])||(d=d||{},d[e]=b[e]);return d},previous:function(a){return!a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return a.clone(this._previousAttributes)},_performValidation:function(a,b){var c=this.validate(a);return c?(b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0}}),e.Collection=function(b,c){c||(c={}),c.comparator&&(this.comparator=c.comparator),a.bindAll(this,"_onModelEvent","_removeReference"),this._reset(),b&&this.reset(b,{silent:!0}),this.initialize.apply(this,arguments)},a.extend(e.Collection.prototype,e.Events,{model:e.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(b,c){if(a.isArray(b))for(var d=0,e=b.length;d<e;d++)this._add(b[d],c);else this._add(b,c);return this},remove:function(b,c){if(a.isArray(b))for(var d=0,e=b.length;d<e;d++)this._remove(b[d],c);else this._remove(b,c);return this},get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return this.models=this.sortBy(this.comparator),a.silent||this.trigger("reset",this,a),this},pluck:function(b){return a.map(this.models,function(a){return a.get(b)})},reset:function(a,b){return a||(a=[]),b||(b={}),this.each(this._removeReference),this._reset(),this.add(a,{silent:!0}),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a||(a={});var b=this,c=a.success;return a.success=function(d,e,f){b[a.add?"add":"reset"](b.parse(d,f),a),c&&c(b,d)},a.error=v(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},create:function(a,b){var c=this;b||(b={}),a=this._prepareModel(a,b);if(!a)return!1;var d=b.success;return b.success=function(a,e,f){c.add(a,b),d&&d(a,e,f)},a.save(null,b),a},parse:function(a,b){return a},chain:function(){return a(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,b){if(a instanceof e.Model)a.collection||(a.collection=this);else{var c=a;a=new this.model(c,{collection:this}),a.validate&&!a._performValidation(c,b)&&(a=!1)}return a},_add:function(a,b){b||(b={}),a=this._prepareModel(a,b);if(!a)return!1;var c=this.getByCid(a);if(c)throw new Error(["Can't add the same model to a set twice",c.id]);this._byId[a.id]=a,this._byCid[a.cid]=a;var d=b.at!=null?b.at:this.comparator?this.sortedIndex(a,this.comparator):this.length;return this.models.splice(d,0,a),a.bind("all",this._onModelEvent),this.length++,b.silent||a.trigger("add",a,this,b),a},_remove:function(a,b){return b||(b={}),a=this.getByCid(a)||this.get(a),a?(delete this._byId[a.id],delete this._byCid[a.cid],this.models.splice(this.indexOf(a),1),this.length--,b.silent||a.trigger("remove",a,this,b),this._removeReference(a),a):null},_removeReference:function(a){this==a.collection&&delete a.collection,a.unbind("all",this._onModelEvent)},_onModelEvent:function(a,b,c,d){if(a!="add"&&a!="remove"||c==this)a=="destroy"&&this._remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments);else return}});var f=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","groupBy"];a.each(f,function(b){e.Collection.prototype[b]=function(){return a[b].apply(a,[this.models].concat(a.toArray(arguments)))}}),e.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var g=/:([\w\d]+)/g,h=/\*([\w\d]+)/g,i=/[-[\]{}()+?.,\\^$|#\s]/g;a.extend(e.Router.prototype,e.Events,{initialize:function(){},route:function(b,c,d){e.history||(e.history=new e.History),a.isRegExp(b)||(b=this._routeToRegExp(b)),e.history.route(b,a.bind(function(a){var e=this._extractParameters(b,a);d.apply(this,e),this.trigger.apply(this,["route:"+c].concat(e))},this))},navigate:function(a,b){e.history.navigate(a,b)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(i,"\\$&").replace(g,"([^/]*)").replace(h,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),e.History=function(){this.handlers=[],a.bindAll(this,"checkUrl")};var j=/^#*/,k=/msie [\w.]+/,l=!1;a.extend(e.History.prototype,{interval:50,getFragment:function(a,b){if(a==null)if(this._hasPushState||b){a=window.location.pathname;var c=window.location.search;c&&(a+=c),a.indexOf(this.options.root)==0&&(a=a.substr(this.options.root.length))}else a=window.location.hash;return decodeURIComponent(a.replace(j,""))},start:function(c){if(l)throw new Error("Backbone.history has already been started");this.options=a.extend({},{root:"/"},this.options,c),this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var d=this.getFragment(),e=document.documentMode,f=k.exec(navigator.userAgent.toLowerCase())&&(!e||e<=7);f&&(this.iframe=b('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(d)),this._hasPushState?b(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!f?b(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval),this.fragment=d,l=!0;var g=window.location,h=g.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&h&&g.hash&&(this.fragment=g.hash.replace(j,""),window.history.replaceState({},document.title,g.protocol+"//"+g.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.iframe.location.hash));if(b==this.fragment||b==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(b),this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(b){var c=this.fragment=this.getFragment(b),d=a.any(this.handlers,function(a){if(a.route.test(c))return a.callback(c),!0});return d},navigate:function(a,b){var c=(a||"").replace(j,"");if(this.fragment==c||this.fragment==decodeURIComponent(c))return;if(this._hasPushState){var d=window.location;c.indexOf(this.options.root)!=0&&(c=this.options.root+c),this.fragment=c,window.history.pushState({},document.title,d.protocol+"//"+d.host+c)}else window.location.hash=this.fragment=c,this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(this.iframe.document.open().close(),this.iframe.location.hash=c);b&&this.loadUrl(a)}}),e.View=function(b){this.cid=a.uniqueId("view"),this._configure(b||{}),this._ensureElement(),this.delegateEvents(),this.initialize.apply(this,arguments)};var m=function(a){return b(a,this.el)},n=/^(\S+)\s*(.*)$/,o=["model","collection","el","id","attributes","className","tagName"];a.extend(e.View.prototype,e.Events,{tagName:"div",$:m,initialize:function(){},render:function(){return this},remove:function(){return b(this.el).remove(),this},make:function(a,c,d){var e=document.createElement(a);return c&&b(e).attr(c),d&&b(e).html(d),e},delegateEvents:function(c){if(!c&&!(c=this.events))return;a.isFunction(c)&&(c=c.call(this)),b(this.el).unbind(".delegateEvents"+this.cid);for(var d in c){var e=this[c[d]];if(!e)throw new Error('Event "'+c[d]+'" does not exist');var f=d.match(n),g=f[1],h=f[2];e=a.bind(e,this),g+=".delegateEvents"+this.cid,h===""?b(this.el).bind(g,e):b(this.el).delegate(h,g,e)}},_configure:function(b){this.options&&(b=a.extend({},this.options,b));for(var c=0,d=o.length;c<d;c++){var e=o[c];b[e]&&(this[e]=b[e])}this.options=b},_ensureElement:function(){if(!this.el){var c=this.attributes||{};this.id&&(c.id=this.id),this.className&&(c["class"]=this.className),this.el=this.make(this.tagName,c)}else a.isString(this.el)&&(this.el=b(this.el).get(0))}});var p=function(a,b){var c=s(this,a,b);return c.extend=this.extend,c};e.Model.extend=e.Collection.extend=e.Router.extend=e.View.extend=p;var q={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};e.sync=function(c,d,f){var g=q[c],h=a.extend({type:g,dataType:"json"},f);return h.url||(h.url=t(d)||u()),!h.data&&d&&(c=="create"||c=="update")&&(h.contentType="application/json",h.data=JSON.stringify(d.toJSON())),e.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.data=h.data?{model:h.data}:{}),e.emulateHTTP&&(g==="PUT"||g==="DELETE")&&(e.emulateJSON&&(h.data._method=g),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",g)}),h.type!=="GET"&&!e.emulateJSON&&(h.processData=!1),b.ajax(h)};var r=function(){},s=function(b,c,d){var e;return c&&c.hasOwnProperty("constructor")?e=c.constructor:e=function(){return b.apply(this,arguments)},a.extend(e,b),r.prototype=b.prototype,e.prototype=new r,c&&a.extend(e.prototype,c),d&&a.extend(e,d),e.prototype.constructor=e,e.__super__=b.prototype,e},t=function(b){return!b||!b.url?null:a.isFunction(b.url)?b.url():b.url},u=function(){throw new Error('A "url" property or function must be specified')},v=function(a,b,c){return function(d){a?a(b,d,c):b.trigger("error",b,d,c)}},w=function(a){return a.replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};return e}),define("joshfire-framework/view",["joshlib!vendor/backbone","joshlib!vendor/underscore","joshlib!utils/dollar"],function(a,b,c){var d=a.View.extend({compileTemplate:b.template,initialize:function(a){a?(this.data=a.data||{},this.loadingClass=a.loadingClass||null,this.loadingClass&&(b.isString(this.loadingClass)||(this.loadingClass="loading"))):this.data={}},render:function(){var a=this;this.generate(function(b,c){c!==!1&&a.setContent(c),a.enhance()})},setContent:function(a){c(this.el).html(""),c(this.el).append(a)},generate:function(a){a(null,"")},wrapContent:function(a){a=a||"";var b=function(a){return a?a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;"):""};if(!this.el)return"<div>"+a+"</div>";var c="<"+this.el.nodeName.toLowerCase();for(var d=0;d<this.el.attributes.length;d++){var e=this.el.attributes[d];e.value?c+=" "+e.name+'="'+b(e.value)+'"':c+=" "+e.name}return c+=">"+a+"</"+this.el.nodeName.toLowerCase()+">",c},hide:function(){c(this.el).hide(),this.trigger("hidden")},show:function(){c(this.el).show(),this.trigger("shown")},enhance:function(){this.customLoadEvent||this.trigger("load"),this.loadingClass&&c(this.el)&&(c(this.el).addClass(this.loadingClass),this.unbind("load",this.removeLoadingClass,this),this.bind("load",this.removeLoadingClass,this))},removeLoadingClass:function(){c(this.el).removeClass(this.loadingClass)},setElement:function(a,b){c(this.el)&&c(this.el).unbind(".delegateEvents"+this.cid);var d=a instanceof c?a:c(a);return this.el=d[0],b!==!1&&this.delegateEvents(),this}});return d}),define("joshfire-framework/uielement",["joshlib!view"],function(a){var b=a.extend({});return b}),define("joshfire-framework/adapters/phone/uielement",["joshlib!adapters/none/uielement","joshlib!vendor/iscroll","joshlib!vendor/underscore","joshlib!utils/dollar"],function(a,b,c,d){var e=a.extend({initialize:function(b){this.options.scroller&&d(this.el).css({overflow:"hidden"}),this.options.scrollerSelector&&(this.scrollerSelector=this.options.scrollerSelector),this.bind("shown",function(){this.hasScroller&&this.iScroller&&this.iScroller.refresh()},this),a.prototype.initialize.call(this,b)},enhance:function(){var b=this;if(this.options.scroller){b.insertScroller(),window.skiped&&b.iScroller.scrollToElement("li:nth-child("+window.skiped+")",200);var c=b.$("img");c.length&&b.$("img").bind("load",function(){setTimeout(function(){b.iScroller.refresh()},10)})}a.prototype.enhance.call(this)},insertScroller:function(){var a=this;this.hasScroller=!0,a.iScroller&&a.iScroller.destroy();var e=a.el;a.scrollerSelector&&(e=d(a.scrollerSelector,a.el).get(0)||a.el),a.iScroller=new b(e,c.extend({useTransition:!0,onScrollMove:function(){a.$("a").bind("click.iscrollprevent",function(a){a.preventDefault()})},onScrollEnd:function(){setTimeout(function(){a.$("a").unbind("click.iscrollprevent")},100)},onBeforeScrollStart:function(a){var b=a.target;while(b.nodeType!=1)b=b.parentNode;b.tagName!="SELECT"&&b.tagName!="INPUT"&&b.tagName!="TEXTAREA"&&a.preventDefault()}},a.options.scrollOptions||{})),a.options.scrollOptions&&a.options.scrollOptions.disabled&&a.iScroller.disable(),document.addEventListener("orientationChanged",function(b){a.iScroller&&a.iScroller.refresh()})}});return e}),define("joshfire-framework/ui/layout",["joshlib!uielement","joshlib!vendor/underscore"],function(a,b){var c=a.extend({initialize:function(c){c.template?this.template=this.compileTemplate(c.template):c.templateEl&&(this.template=this.compileTemplate($(c.templateEl).text())),this.customLoadEvent=!0,this.setChildren(c.children),this.bind("shown",function(){b.each(this.children,function(a){a.trigger("shown")})},this),this.bind("hidden",function(){b.each(this.children,function(a){a.trigger("hidden")})},this),a.prototype.initialize.call(this,c)},setChildren:function(a){this.children=a,this.numChildren=0,this.numChildrenLoaded=0,a&&b.each(a,b.bind(function(a){++this.numChildren,a.bind("load",b.bind(function(){++this.numChildrenLoaded,this.numChildrenLoaded===this.numChildren&&this.trigger("load")},this))},this))},getChild:function(a){if(a)return this.children[a]},generate:function(a){if(!this.children)return a(null,"");this.childrenOffsets={},this.numChildrenLoaded=0;var c=0,d="";b.each(this.children,b.bind(function(e,f){e.generate(b.bind(function(b,g){var h=e.wrapContent(g);this.childrenOffsets[f]=c,d+=h;if(++c===this.numChildren){var i=null;this.template?i=this.template({childrenOuterHTML:d}):i=d,a(null,i)}},this))},this))},setContent:function(b){a.prototype.setContent.call(this,b),this.children&&this.el&&this.setChildrenElements(!0)},setElement:function(b,c){a.prototype.setElement.call(this,b,c),this.setChildrenElements(c)},setChildrenElements:function(a){b.each(this.children,b.bind(function(a,b){var c=this.el.childNodes[this.childrenOffsets[b]];a.setElement(c,!0)},this))},enhance:function(){a.prototype.enhance.call(this),this.children&&this.el&&b.each(this.children,b.bind(function(a,b){a.enhance()},this)),(!this.children||this.children.length===0)&&this.trigger("load")}});return c}),define("joshfire-framework/ui/cardpanel",["joshlib!ui/layout","joshlib!vendor/underscore"],function(a,b){var c=a.extend({initialize:function(b){this.showChild(b.currentChild||b.defaultChildren),a.prototype.initialize.call(this,b)},showChild:function(a){if(this.currentChild===a)return;this.canUseDOM&&this.transition(this.currentChild,a),this.currentChild=a},showChildren:function(a){this.showChild(a)},transition:function(a,c){b.each(this.children,function(a,b){b!=c&&a.hide()}),c&&this.children[c].show()},enhance:function(){a.prototype.enhance.call(this),this.currentChild&&this.transition(null,this.currentChild),this.canUseDOM=!0}});return c}),define("joshfire-framework/ui/fadeinpanel",["joshlib!ui/cardpanel","joshlib!vendor/underscore","joshlib!utils/dollar"],function(a,b,c){var d=a.extend({initialize:function(b){this.cssTransition=b.cssTransition||".4s ease-in-out all",a.prototype.initialize.call(this,b)},transition:function(a,d){var e=this.children[d];e.hide(),c(e.el).css({filter:"alpha(opacity=0)","-khtml-opacity":0,"-moz-opacity":0,"-ms-opacity":0,"-o-opacity":0,opacity:0,"-webkit-transition":"none","-moz-transition":"none","-ms-transition":"none","-o-transition":"none",transition:"none"}),b.each(this.children,b.bind(function(a,b){a.hide()},this)),e.show(),c(e.el).css({filter:"alpha(opacity=100)","-khtml-opacity":1,"-moz-opacity":1,"-ms-opacity":1,"-o-opacity":1,opacity:1,"-webkit-transition":"0.7s ease-in-out all","-moz-transition":"0.7s ease-in-out all","-ms-transition":"0.7s ease-in-out all","-o-transition":"0.7s ease-in-out all",transition:"0.7s ease-in-out all","-webkit-backface-visibility":"hidden"})}});return d}),define("joshfire-framework/ui/item",["joshlib!uielement","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c){var d=a.extend({initialize:function(c){c.template?this.template=this.compileTemplate(c.template):c.templateEl&&(this.template=this.compileTemplate(b(c.templateEl).text())),this.setModel(c.model),a.prototype.initialize.call(this,c)},setModel:function(a,b){this.model=a,a&&a.bind("change",this.render,this),b&&this.render()},generate:function(a){if(!this.template)return a(null,"");if(!this.model)return a(null,"");var b={model:this.model,obj:this.model,item:this.model?this.model.toJSON():{}};c.extend(b,this.data),a(null,this.template(b))}});return d}),define("joshfire-framework/ui/dynamiccontainer",["joshlib!uielement","joshlib!ui/item","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c,d){var e=a.extend({initialize:function(e){this.setModel(e.model),this.setCollection(e.collection),this.viewTemplateEl=e.viewTemplateEl||e.itemTemplateEl,this.viewOptions=e.viewOptions||e.itemOptions||{},this.viewOptions.templateEl=this.viewOptions.templateEl||this.viewTemplateEl,this.viewOptions.template=this.viewOptions.template||e.viewTemplate||e.itemTemplate,e.template?this.template=this.compileTemplate(e.template):e.templateEl&&(this.template=this.compileTemplate(c(e.templateEl).text())),this.viewFactory=function(a,c){var f={model:a,collection:c};return d.extend(f,this.viewOptions),factory=e.viewFactory||e.itemFactory,factory?factory(f):new b(f)},this.customLoadEvent=!0,this.bind("shown",function(){this.view&&this.view.trigger("shown")},this),this.bind("hidden",function(){this.view&&this.view.trigger("hidden")},this),a.prototype.initialize.call(this,e)},setModel:function(a,b){this.model&&this.model.unbind("change",this.render,this),this.model=a,a&&a.bind("change",this.render,this),b&&this.render()},setCollection:function(a,b){this.collection&&(this.collection.unbind("change",this.render,this),this.collection.unbind("add",this.render,this),this.collection.unbind("remove",this.render,this),this.collection.unbind("reset",this.render,this)),this.collection=a,a&&(a.bind("change",this.render,this),a.bind("add",this.render,this),a.bind("remove",this.render,this),a.bind("reset",this.render,this)),b&&this.render()},generate:function(a){var b=this;this.view&&this.view.unbind("load",this.triggerLoad,this),this.view=this.viewFactory(this.model,this.collection);if(!this.view)return a(null,"");this.view.bind("load",this.triggerLoad,this),!this.view.model&&this.view.setModel&&this.view.setModel(this.model),!this.view.collection&&this.view.setCollection&&this.view.setCollection(this.collection),this.view.generate(function(c,d){var e=b.view.wrapContent(d),f=null;return e&&b.template?f=b.template({child:e}):f=e?e:"",a(c,f)})},setContent:function(b){a.prototype.setContent.call(this,b),this.view&&this.el&&this.setViewElement(!0)},setElement:function(b,c){a.prototype.setElement.call(this,b,c),this.setViewElement(c)},setViewElement:function(a){this.view.setElement(this.el.firstChild,a)},enhance:function(){var b=this;this.view.enhance();var c=["navUp","navRight","navDown","navLeft","navAction","navFocus","navBlur"];d.each(c,function(a){b[a]=b.view[a]}),a.prototype.enhance.call(this)},triggerLoad:function(){this.trigger("load")}});return e}),define("joshfire-framework/ui/factorymedia",["joshlib!ui/item","joshlib!utils/mediaplayerlib","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c,d){var e=a.extend({initialize:function(b){this.mediaOptions=b.mediaOptions||{},a.prototype.initialize.call(this,b)},generate:function(e){var f=/^([0-9]{1,3})%$/,g=null,h=0,i=d.clone(this.mediaOptions);if(!this.model)return e(null,"");i.width&&d.isString(i.width)&&(g=i.width.match(f),g&&(h=parseInt(g[1],10),this.options.width?i.width=this.options.width*h/100:i.width=c(this.el).width()*h/100,i.width=Math.floor(i.width))),i.height&&d.isString(i.height)&&(g=i.height.match(f),g&&(h=parseInt(g[1],10),this.options.height?i.height=this.options.height*h/100:i.height=c(this.el).height()*h/100,i.height=Math.floor(i.height)));var j=b.resolve(this.model.toJSON(),i);j.toHtml(d.bind(function(b,c,f){if(this.template)d.extend(this.data,{media:{html:c,metadata:f},width:this.options.width,height:this.options.height}),a.prototype.generate.call(this,e);else return e(null,c)},this))}});return e}),define("joshfire-framework/ui/imagesloader",["joshlib!ui/item","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c){var d=a.extend({initialize:function(c){this.imageClass=c.imageClass,this.processImageEl=c.processImageEl;var d=this;this.getImages=c.getImages||function(){var a=this.$("img").map(function(a){return d.imageClass&&b(a).addClass(d.imageClass),{el:a,url:b(a).attr("src")}});return a},this.customLoadEvent=!0,a.prototype.initialize.call(this,c)},enhance:function(){var d=this;this.getImages||(a.prototype.enhance.call(this),this.trigger("load"));var e=this.getImages();if(!e||e.length===0){this.trigger("load");return}var f=0,g=function(a){a&&b(a).removeClass("loading"),f+=1,f===e.length&&d.trigger("load")};c.each(e,function(a){if(!a.el||!a.url)return g(a.el);var c=a.el;d.processImageEl&&(c=d.processImageEl(a.el)),b(c).addClass("loading");var e=new Image;e.onload=function(){g(c),e=null},e.onerror=function(){g(c),e=null},e.src=a.url}),a.prototype.enhance.call(this)}});return d}),define("joshfire-framework/ui/imageloader",["joshlib!ui/imagesloader","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c){var d=a.extend({initialize:function(c){this.getImageUrl=c.getImageUrl||function(){return this.model?this.model.imageUrl:null};var d=this;c.getImages=function(){var a=null;return c.imageContainer&&(a=d.$(c.imageContainer)),a||(a=b(d.el)),[{el:a.get(0),url:d.getImageUrl()}]},a.prototype.initialize.call(this,c)},generate:function(a){if(!this.model){a(null,"");return}var b={model:this.model,obj:this.model,item:this.model?this.model.toJSON():{},imageUrl:this.getImageUrl.call(this)};c.extend(b,this.data),a(null,this.template(b))}});return d}),define("joshfire-framework/ui/listitem",["joshlib!uielement","joshlib!vendor/underscore"],function(a,b){var c=a.extend({initialize:function(c){this.view=c.view,this.offset=c.offset,this.customLoadEvent=!0,this.view&&this.view.bind("load",b.bind(function(){this.trigger("load")},this)),a.prototype.initialize.call(this,c)},setElement:function(a){this.view.setElement(a)},generate:function(a){this.view.data.offset=this.offset,this.view.generate(a)},render:function(){this.view.render()},setContent:function(a){this.view.setContent(a)},hide:function(){this.view.hide()},show:function(){this.view.show()},enhance:function(){this.view.enhance()}});return c}),define("joshfire-framework/ui/list",["joshlib!uielement","joshlib!ui/listitem","joshlib!ui/item","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c,d,e){var f=a.extend({initialize:function(f){f.templateEl?this.template=this.compileTemplate(d(f.templateEl).text()):this.template=this.compileTemplate("<ul><%= children %></ul>"),this.UIItemClass=f.UIItemClass||b,this.itemOptions=f.itemOptions||{scroller:!1},this.itemTemplateEl=f.itemTemplateEl,this.itemOptions.templateEl=this.itemOptions.templateEl||this.itemTemplateEl,this.itemOptions.template=this.itemOptions.template||f.itemTemplate,this.contentSelector=f.contentSelector,this.items=[],this.itemFactory=f.itemFactory||function(a,b){var d={model:a,offset:b};return e.extend(d,this.itemOptions),new c(d)},this.customLoadEvent=!0,this.dataLoadingClass="loading",typeof f.dataLoadingClass!="undefined"&&(this.dataLoadingClass=f.dataLoadingClass),this.dataLoadingClass===!1&&(this.dataLoadingClass=null),this.bind("shown",function(){e.each(this.items,function(a){a.trigger("shown")})},this),this.bind("hidden",function(){e.each(this.items,function(a){a.trigger("hidden")})},this),a.prototype.initialize.call(this,f),f.collection&&this.setCollection(f.collection)},setCollection:function(a,b){this.collection&&(this.collection.unbind("change",this.update,this),this.collection.unbind("add",this.update,this),this.collection.unbind("remove",this.update,this),this.collection.unbind("reset",this.update,this),this.collection.unbind("syncstarted",this.syncStartedHandler,this),this.collection.unbind("syncsuccess",this.syncSuccessHandler,this),this.collection.unbind("syncerror",this.syncErrorHandler,this)),this.collection=a,a&&(a.bind("change",this.update,this),a.bind("add",this.update,this),a.bind("remove",this.update,this),a.bind("reset",this.update,this),a.bind("syncstarted",this.syncStartedHandler,this),a.bind("syncsuccess",this.syncSuccessHandler,this),a.bind("syncerror",this.syncErrorHandler,this)),this.update(b)},update:function(a){this.items=new Array(this.collection.length),this.itemsLoaded=0;var c=function(){++this.itemsLoaded,this.itemsLoaded===this.items.length&&this.trigger("load")};for(var d=0;d<this.collection.length;d++){var f=this.collection.at(d);this.items[d]=new b({view:this.itemFactory.call(this,f,d),model:f,offset:d}),this.items[d].bind("load",e.bind(c,this))}a&&this.render()},generate:function(a){var b=this.items,c=new Array(b.length),d=0,e=this.template;if(!b.length){var f=e({children:""});a(null,f);return}for(var g=0;g<b.length;g++)((function(f,g){this.generateItem(function(f,h){c[g]=h;if(++d===b.length){var i=e({children:c.join("")});a(null,i)}},f)})).call(this,b[g],g)},generateItem:function(a,b){b.generate(a)},enhance:function(){var b=this.$("li");for(var c=0;c<this.items.length;c++){var e=this.items[c];e.setElement(b[c]),e.enhance()}this.$(".joshfire-link").unbind("click").bind("click",function(a){a.preventDefault();var b=d(a.currentTarget).attr("data-joshfire-link-url");return window.location=b,!1}),a.prototype.enhance.call(this),this.items.length===0&&this.trigger("load")},setContent:function(a){this.contentSelector?this.$(this.contentSelector).html(a):d(this.el).html(a)},syncStartedHandler:function(){this.dataLoadingClass&&d(this.el).addClass(this.dataLoadingClass)},syncSuccessHandler:function(){var a=this;this.dataLoadingClass&&window.setTimeout(function(){d(a.el).removeClass(a.dataLoadingClass)},5e3)},syncErrorHandler:function(){this.dataLoadingClass&&d(this.el).removeClass(this.dataLoadingClass)}});return f}),define("ui/imagegallery",["joshlib!ui/list","vendor/klass","vendor/photoswipe","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c,d,e){var f=a.extend({name:"imagegallery",initialize:function(b){this.photoswipe={getImageCaption:function(a){return a.title},minUserZoom:1},b.photoswipe&&e.extend(this.photoswipe,b.photoswipe),this.linkSelector=b.linkSelector||'a[href$=".jpg"],a[href$=".jpeg"],a[href$=".png"],a[href$=".gif"]',a.prototype.initialize.call(this,b)},enhance:function(){var b=this.$(this.linkSelector);b.length&&Code.PhotoSwipe.attach(b,this.photoswipe),a.prototype.enhance.call(this)}});return f}),define("joshfire-framework/collection",["joshlib!vendor/backbone","joshlib!vendor/underscore"],function(a,b){var c=a.Collection.extend({initialize:function(a,b){this.ds=null,this.dsq={},b=b||{},b.dataSource&&this.setDataSource(b.dataSource),b.dataSourceQuery&&this.setDataSourceQuery(b.dataSourceQuery)},setDataSource:function(a){this.ds=a},setDataSourceQuery:function(a){this.dsq=a},sync:function(a,c,d){d=d||{};var e={};this.dsq&&(e=b.extend(e,this.dsq)),d.dataSourceQuery&&(e=b.extend(e,d.dataSourceQuery)),a==="read"&&(this.trigger("syncstarted",{method:a}),this.ds.find(e,b.bind(function(b,c){if(b){this.trigger("syncerror",{method:a,err:b}),d.error&&d.error(b);return}if(this.ds.children){var e=[];e=Array.prototype.concat.apply(e,c.entries.map(function(a){return a.entries})),d.success&&d.success(e)}else d.success&&d.success(c.entries||[]);this.trigger("syncsuccess",{method:a})},this)))}});return c}),define("joshfire-framework/adapters/phone/collection",["joshlib!adapters/none/collection"],function(a){return a.adapted=!0,a}),define("joshfire-framework/router",["joshlib!vendor/backbone","joshlib!vendor/underscore"],function(a,b){var c=function(c){b.extend(c,{historyStart:function(b){a.history.start(b)}});var d=a.Router.extend(c);return new d};return c}),define("sleek",["joshlib!collection","joshlib!ui/dynamiccontainer","joshlib!ui/item","joshlib!ui/list","joshlib!ui/cardpanel","joshlib!ui/fadeinpanel","joshlib!ui/factorymedia","joshlib!ui/imageloader","joshlib!ui/imagesloader","joshlib!router","joshlib!vendor/backbone","joshlib!vendor/underscore","joshlib!utils/dollar","ui/imagegallery"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=function(){l.bindAll(this,"initialize","setColor","slugify")};return o.extend=k.View.extend,l.extend(o.prototype,{deviceFamily:"all",clientWidth:document.body.clientWidth,convertItemType:function(a){var b=null;switch(a){case"Article/Status":b="status";break;case"NewsArticle":case"BlogPosting":case"Article":case"CreativeWork":b="news";break;case"Event":b="event";break;case"ImageObject":b="photo";break;case"VideoObject":b="video";break;case"MusicRecording":b="sound";break;case"Product":b="product";break;default:b="other"}return b},initialize:function(b){var c=this;this.title=Joshfire.factory.config.app.name,this.tabs=Joshfire.factory.config.template.options.tabs||[],this.tabicons=Joshfire.factory.config.template.options.tabicons||[],this.backgroundURL=Joshfire.factory.config.template.options.backgroundimage?Joshfire.factory.config.template.options.backgroundimage.url:Joshfire.factory.config.template.options.backgroundurl,this.logoURL=Joshfire.factory.config.app.logo?Joshfire.factory.config.app.logo.contentURL:null,document.title=this.title,this.setColor(Joshfire.factory.config.template.options.color||"gray",function(){var d=c.getDatasources(),e=new Array(d.length),f=0;l.forEach(d,l.bind(function(b,d){var f=this.tabs[d]||b.name||"",g=this.tabicons[d],h=d+"--"+this.slugify(f.toLowerCase()),i=new a([],{dataSource:b,dataSourceQuery:{}}),j=b.getOutputType();e[d]={name:f,slug:h,icon:g||c.convertItemType(j),outputType:c.convertItemType(j),collection:i,index:d}},c));var g=c.createViews(e),h=c.createRoutes(e,g),i=j(h);i.historyStart(),b&&b()})},getDatasources:function(){var a=Joshfire.factory.getDataSource("main"),b=[];return a&&a.children&&a.children.length>0&&(b=b.concat(a.children)),b},setColor:function(a,b){m("#color").remove(),window.Sid.css("css/"+this.deviceFamily+"."+a+".css",b)},setTitle:function(a){m("#title").html(a)},getClassName:function(a,b){if(b!=="list")return b==="single"?"single content detail":"content detail";switch(a){case"status":case"event":return"content hashed-list";case"photo":return"content mosaic-list";default:return"content simple-list"}},createToolbar:function(a){var b=new k.Collection,c=null;for(var d=0;d<a.length;d++)c=a[d],b.add({name:c.name,icon:c.icon,linkURL:"#"+c.slug,outputType:c.outputType,slug:c.slug});var e=this.createToolbarElement();return e.setCollection(b),e.render(),e},createViews:function(a){var b={},d=null;return this.createAdditionalViews(b),!a||a.length===0?(d=new c({el:"#cards",model:new k.Model,templateEl:"#template-nodata"}),d.render(),d):(this.toolbarView=this.createToolbar(a),l.forEach(a,l.bind(function(a){var c=this.createSectionView(a);b[a.slug]=c},this)),d=new f({el:"#cards",children:b}),d.render(),d)},createAdditionalViews:function(a){},createToolbarElement:function(){return new d({el:"#toolbar",templateEl:"#template-toolbar",itemTemplateEl:"#toolbar-item"})},createSectionView:function(a){var c=new b({collection:a.collection,viewFactory:this.viewFactory(a)});return a.view=c,c},viewFactory:function(a){return l.bind(function(b){var c=b.collection;if(a.outputType==="photo")return this.createListElement(a);if(c.length===1)return this.createDetailContainer(a,!0);var d=this.createListElement(a),e=this.createDetailContainer(a),f=this.createListAndDetailView(d,e);return f},this)},createListAndDetailView:function(a,b){},refreshList:function(a,b){a.collection.fetch({dataSourceQuery:{nocache:!0},success:l.bind(function(){this.showList(a,b)},this)})},updateList:function(a,b){a.collection.fetch({success:l.bind(function(){this.showList(a,b)},this)})},showList:function(a,b){b.view.children&&b.view.children.list?b.view.showChild("list","left"):a.collection.length&&(b.setModel(a.collection.at(0)),b.render())},moveToList:function(a){a.view.children&&a.view.children.list&&a.view.showChild("list","left")},updateDetail:function(a,b,c){a.collection.fetch({success:l.bind(function(){this.showDetail(a,b,c)},this)})},showDetail:function(a,b,c){if(b.view.children&&b.view.children.detail){var d=b.view.children.detail;a.collection.length>c&&(d.setModel(a.collection.at(c)),d.render()),b.view.showChild("detail","right")}},createListElement:function(a){return a.outputType==="photo"?new n({templateEl:"#template-list-view",scroller:!0,itemFactory:this.itemFactory(a),collection:a.collection,className:a.outputType+" "+this.getClassName(a.outputType,"list"),dataLoadingClass:"dataloading",loadingClass:"loading"}):new d({templateEl:"#template-list-view",scroller:!0,itemFactory:this.itemFactory(a),collection:a.collection,className:a.outputType+" "+this.getClassName(a.outputType,"list")})},createDetailContainer:function(a,c){var d=this;return new b({viewFactory:function(b){return l.extend(b,{slug:a.slug}),d.createDetailElement(b,c)},className:d.getClassName(a,c?"single":"detail")})},createDetailElement:function(a){if(!a.model)return new c({});var b=this.convertItemType(a.model.get("@type")),d=this;switch(b){case"video":return new g({templateEl:"#template-"+b,scroller:!0,scrollerSelector:".wrapper",width:d.getContentWidth(),height:d.getContentHeight(),mediaOptions:{strategy:"html5",width:"100%",height:"80%",adjustSize:!0}});case"sound":return new g({templateEl:"#template-"+b,mediaOptions:{strategy:"html5"}});case"status":return new h({templateEl:"#template-"+b,scroller:!0,getImageUrl:function(){return d.getAuthorThumbnail(a.model.toJSON())}});default:return new i({templateEl:"#template-"+b,scroller:!0,imageClass:"fadein",processImageEl:function(a){var b=document.createElement("div");b.setAttribute("class","loader inv");var c=document.createElement("div");return c.setAttribute("class","figure"),c.appendChild(b),a.getAttribute("width")?c.setAttribute("style","width:"+a.getAttribute("width")+"px;max-width:100%"):c.setAttribute("style","width:"+a.getAttribute("width")+"px;max-width:100%"),a.parentNode.replaceChild(c,a),c.appendChild(a),c}})}},itemFactory:function(a){var b=this;return function(d,e){var f=d.toJSON(),g=a.outputType||b.convertItemType(f["@type"]),i="#template-"+g+"-item",j={data:{section:a},model:d,offset:e,templateEl:i};switch(g){case"photo":case"video":case"product":case"news":return j.getImageUrl=function(){return b.getThumbnail(f,e,.2)},j.imageContainer=".figure",new h(j);case"status":return j.getImageUrl=function(){return b.getAuthorThumbnail(f,e)},j.imageContainer=".figure",new h(j);default:return new c(j)}}},createRoutes:function(a,b){return{routes:{"":"home"},home:function(){a.length?this[a[0].slug]():(m("#title").html("No data"),document.body.id="nodata",m("#refresh").hide())}}},getContentWidth:function(){var a=m(".slide-panel").get(),b=l.max(a,function(a){return m(a).width()});return Math.floor(m(b).width())},getContentHeight:function(){var a=m(".slide-panel").get(),b=l.max(a,function(a){return m(a).height()});return m(b).height()},getThumbnail:function(a,b,c){if(!a)return"";c=c||.2;var d=this.clientWidth*c,e=0,f=0,g=a.thumbnail,h=null,i=null,j=null;if(g&&g.length>0){j=g[0],f=j.width||0;for(var k=0;k<g.length;k++){i=g[k],e=i.width||0;if(e>=d&&(e<f||f<d)||f<d&&e>f)j=g[k]}h=j.contentURL}return h||(a["@type"]==="ImageObject"&&a.contentURL?h=a.contentURL:a.image&&a.image.contentURL&&(h=a.image.contentURL)),h||(h=""),h},getAuthorThumbnail:function(a,b){if(!a)return"";var c="";return a.author&&a.author[0]&&(c=this.getThumbnail(a.author[0],b,.2)),c||(c=this.getThumbnail(a,b,.2)),c},slugify:function(a){return a=a.replace(/[^\-a-zA-Z0-9,&\s]+/ig,""),a=a.replace(/-/gi,"_"),a=a.replace(/\s/gi,"-"),a}}),o}),define("sleek.custom",["sleek"],function(a){return a}),define("sleek.tablet",["sleek.custom","joshlib!ui/layout","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c,d){return a.extend({deviceFamily:"tablet",getClassName:function(a,b){if(b!=="list")return b==="single"?"single detail":"right-panel detail";switch(a){case"status":case"event":return"left-panel hashed-list";case"photo":return"section mosaic-list";default:return"left-panel simple-list"}},createListAndDetailView:function(a,c){var d=new b({children:{list:a,detail:c},className:"split-view"});return d},getContentWidth:function(){var a=c(".right-panel").get(),b=d.max(a,function(a){return c(a).width()});return c(b).width()},getContentHeight:function(){var a=c(".right-panel").get(),b=d.max(a,function(a){return c(a).height()});return c(b).height()},showList:function(a,b){this.showDetail(a,b,0)},moveToList:function(a){},showDetail:function(a,b,d){if(a.collection.length<=d)return;var e=b.view.children||{};e.detail?(e.detail.setModel(a.collection.at(d)),e.detail.render()):a.outputType!=="photo"&&(b.setModel(a.collection.at(d)),b.render()),e.list&&(e.list.$(".active").removeClass("active"),c(e.list.$("li")[d]).addClass("active"))},createRoutes:function(b,e){var f=a.prototype.createRoutes.call(this,b,e),g=c("#toolbar"),h=this;return d.forEach(b,function(a){f.routes[a.slug]=a.slug,f[a.slug]=function(){document.body.id=a.outputType,h.setTitle(a.name),c("iframe, audio, video, object, embed").remove(),g.find(".active").removeClass("active"),g.find(".section-"+a.slug).addClass("active");var b=e.children[a.slug];a.collection.length?(h.moveToList(b),e.showChild(a.slug)):(e.showChild(a.slug),h.updateList(a,b))},a.outputType!=="photo"&&(f.routes[a.slug+"/:offset"]=a.slug+"Detail",f[a.slug+"Detail"]=function(b){b=parseInt(b,10),c("iframe, audio, video, object").remove(),document.body.id=a.outputType,h.setTitle(a.name),g.find(".active").removeClass("active"),g.find(".section-"+a.slug).addClass("active");var d=e.children[a.slug];e.showChild(a.slug),a.collection.length?h.showDetail(a,d,b):h.updateDetail(a,d,b)})}),f}})}),define("app.tablet",["sleek.tablet","joshlib!utils/onready"],function(a,b){var c=new a;b(c.initialize)})